{
  "items": [
    {
      "tags": [
        "java",
        "spring-boot",
        "hibernate"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 206882,
            "user_id": 642706,
            "user_type": "registered",
            "accept_rate": 58,
            "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1",
            "display_name": "Basil Bourque",
            "link": "https://stackoverflow.com/users/642706/basil-bourque"
          },
          "score": 0,
          "creation_date": 1614927126,
          "post_id": 66487852,
          "comment_id": 117539614,
          "body_markdown": "What exactly is your question? Parsing 2021-03-03 gave you March 3 2021. What else did you expect?",
          "body": "What exactly is your question? Parsing 2021-03-03 gave you March 3 2021. What else did you expect?"
        },
        {
          "owner": {
            "reputation": 53,
            "user_id": 15334653,
            "user_type": "registered",
            "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhoggBNsSTwGyYqHnOjqTvHbU9rp4F6a69j4hUb=k-s128",
            "display_name": "Gurucharan Sharma",
            "link": "https://stackoverflow.com/users/15334653/gurucharan-sharma"
          },
          "score": 0,
          "creation_date": 1614927419,
          "post_id": 66487852,
          "comment_id": 117539682,
          "body_markdown": "The question is that there is data for March 3 2021, then why is the Query not able to fetch it?",
          "body": "The question is that there is data for March 3 2021, then why is the Query not able to fetch it?"
        },
        {
          "owner": {
            "reputation": 53,
            "user_id": 15334653,
            "user_type": "registered",
            "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhoggBNsSTwGyYqHnOjqTvHbU9rp4F6a69j4hUb=k-s128",
            "display_name": "Gurucharan Sharma",
            "link": "https://stackoverflow.com/users/15334653/gurucharan-sharma"
          },
          "score": 0,
          "creation_date": 1614927790,
          "post_id": 66487852,
          "comment_id": 117539791,
          "body_markdown": "@BasilBourque I have updated the question and added a few more details. How that helps to clarify the question.",
          "body": "@BasilBourque I have updated the question and added a few more details. How that helps to clarify the question."
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 53,
                "user_id": 15334653,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhoggBNsSTwGyYqHnOjqTvHbU9rp4F6a69j4hUb=k-s128",
                "display_name": "Gurucharan Sharma",
                "link": "https://stackoverflow.com/users/15334653/gurucharan-sharma"
              },
              "score": 0,
              "creation_date": 1615027011,
              "post_id": 66488154,
              "comment_id": 117568080,
              "body_markdown": "Thanks @BasilBorque. I understand what I was getting wrong. Many thanks for a detailed explanation. Appreciate your help.",
              "body": "Thanks @BasilBorque. I understand what I was getting wrong. Many thanks for a detailed explanation. Appreciate your help."
            }
          ],
          "owner": {
            "reputation": 206882,
            "user_id": 642706,
            "user_type": "registered",
            "accept_rate": 58,
            "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1",
            "display_name": "Basil Bourque",
            "link": "https://stackoverflow.com/users/642706/basil-bourque"
          },
          "comment_count": 1,
          "score": 6,
          "creation_date": 1614927911,
          "answer_id": 66488154,
          "body_markdown": "I am not sure exactly what you expected as your question is unclear, so I cannot give a precise answer. But I can discuss some of the problems in your approach and your code.\r\n\r\nFirstly, never use `java.util.Date`. That terrible class is part of the legacy date-time classes that were supplanted years ago by the modern *java.time* classes defined in [JSR 310][1]. Likewise, never use `Calendar`, and never use `SimpleDateFormat`. [Sun][2], [Oracle][3], and the [JCP][4] community gave up on those legacy classes upon the adoption of JSR 310, and so should you. [JPA][5] and [Hibernate][6] have both been updated to support *java.time* classes, as has the [JDBC 4.2][7] specification.\r\n\r\nAnother possible problem, perhaps you are mixing up `java.sql.Date` with `java.util.Date`. Be careful of your `import` statements there. And, again, never use either of the `Date` classes. \r\n\r\nYou mention a string of `2021-03-03`, but don&#39;t really explain where that is. At any rate, that represents a date-only value. But you say you accessing a `DATETIME` column in MySQL. According the [the MySQL 8 documentation][8], that type represents a date with a time-of-day. \r\n\r\n&gt;The DATETIME type is used for values that contain both date and time parts. MySQL retrieves and displays DATETIME values in &#39;YYYY-MM-DD hh:mm:ss&#39; format. The supported range is &#39;1000-01-01 00:00:00&#39; to &#39;9999-12-31 23:59:59&#39;.\r\n\r\nSo querying a date-with-time column by a date-only value makes no sense. The database cannot compare a date-only value to a date-with-time. You need to specify a span of time, a pair of date-with-time values for your start and end. \r\n\r\nAnother problem: You are trying to use `java.util.Date` which represents a moment, a specific date with time as seen in the context of UTC —&#160;but the `DATETIME` type in MySQL is a different animal. The `DATETIME` type in MySQL represents a date with a time-of-day but lacks the context of an offset or time zone. This type is akin to the SQL type `TIMESTAMP WITHOUT TIME ZONE`. \r\n\r\nBeware: If you are **trying to represent moments** in your database, specific points on the timeline, then **you are using the wrong data type** for your column. For moments, you must use a data type akin to the SQL-standard `TIMESTAMP WITH TIME ZONE`. In MySQL 8, that would be the `TIMESTAMP` type. The `TIMESTAMP` type in MySQL tracks moments as seen in UTC, always in UTC. If your column in question is the one named `createdAt`, then you almost certainly are using the wrong data type, as tracking moments that passed as history must be done with SQL-standard `TIMESTAMP WITH TIME ZONE`. But I will ignore this crucial issue, and carry on with regard to the type you specified in your Question as written. \r\n\r\nIf you are *not* tracking moments, such as tracking future appointments alongside time zone saved in an additional column, then your use of `DATETIME` would be correct. If you are sure of this datatype for your purpose, then in Java the appropriate match would be [`LocalDateTime`][9] class. \r\n\r\nDo your query for a day&#39;s worth of data over a `DATETIME` column by using the half-open approach to defining a span of time. The start is *inclusive* while the end is *exclusive*. So a day starts at first moment of the day and runs up to, but does not include, the start of the next day. With half-open, we do *not* use the SQL keyword `BETWEEN`. \r\n\r\nHere is a simple code example to adapt to your situation. I use neither Spring nor Hibernate, so you will have to translate accordingly.\r\n\r\nFor your date-only input string, parse as a [`LocalDate`][10]. \r\n\r\nTip: A short way of asking &quot;Is greater than or equal&quot; is &quot;Is not less than&quot;. We see this on the first case of the predicate in the SELECT statement below. \r\n\r\n```java\r\nLocalDate ld = LocalDate.parse( &quot;2021-03-03&quot; ) ;\r\nLocalDateTime startOfDay = ld.atStartOfDay() ;\r\nLocalDateTime startOfNextDay = ld.plusDays( 1 ).atStartOfDay() ;\r\nString sql = &quot;SELECT * FROM my_table WHERE when !&lt; ? AND when &lt; ? ;&quot; ;  // Performing query over a span-of-time defined as Half-Open. \r\n…\r\nmyPreparedStatement.setObject( 1 , startOfDay ) ;\r\nmyPreparedStatement.setObject( 2 , startOfNextDay ) ;\r\n```\r\n\r\nRetrieving `DATETIME` values.\r\n\r\n```java\r\nLocalDateTime ldt = myResultSet.getObject( … , LocalDateTime.class ) ;\r\n```\r\n\r\nAll this has been discussed many many times already on Stack Overflow. Search to learn more.\r\n\r\n\r\n[![Table of date-time types in Java (both legacy and modern) and in standard SQL][11]][11]\r\n\r\n\r\n  [1]: https://jcp.org/en/jsr/detail?id=310\r\n  [2]: https://en.wikipedia.org/wiki/Sun_Microsystems\r\n  [3]: https://en.wikipedia.org/wiki/Oracle_Corporation\r\n  [4]: https://en.wikipedia.org/wiki/Java_Community_Process\r\n  [5]: https://en.wikipedia.org/wiki/Jakarta_Persistence\r\n  [6]: https://en.wikipedia.org/wiki/Hibernate_(framework)\r\n  [7]: https://www.jcp.org/en/jsr/detail?id=221\r\n  [8]: https://dev.mysql.com/doc/refman/8.0/en/datetime.html\r\n  [9]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/LocalDateTime.html\r\n  [10]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/LocalDate.html\r\n  [11]: https://i.stack.imgur.com/bXtIS.png",
          "body": "<p>I am not sure exactly what you expected as your question is unclear, so I cannot give a precise answer. But I can discuss some of the problems in your approach and your code.</p>\n<p>Firstly, never use <code>java.util.Date</code>. That terrible class is part of the legacy date-time classes that were supplanted years ago by the modern <em>java.time</em> classes defined in <a href=\"https://jcp.org/en/jsr/detail?id=310\" rel=\"noreferrer\">JSR 310</a>. Likewise, never use <code>Calendar</code>, and never use <code>SimpleDateFormat</code>. <a href=\"https://en.wikipedia.org/wiki/Sun_Microsystems\" rel=\"noreferrer\">Sun</a>, <a href=\"https://en.wikipedia.org/wiki/Oracle_Corporation\" rel=\"noreferrer\">Oracle</a>, and the <a href=\"https://en.wikipedia.org/wiki/Java_Community_Process\" rel=\"noreferrer\">JCP</a> community gave up on those legacy classes upon the adoption of JSR 310, and so should you. <a href=\"https://en.wikipedia.org/wiki/Jakarta_Persistence\" rel=\"noreferrer\">JPA</a> and <a href=\"https://en.wikipedia.org/wiki/Hibernate_(framework)\" rel=\"noreferrer\">Hibernate</a> have both been updated to support <em>java.time</em> classes, as has the <a href=\"https://www.jcp.org/en/jsr/detail?id=221\" rel=\"noreferrer\">JDBC 4.2</a> specification.</p>\n<p>Another possible problem, perhaps you are mixing up <code>java.sql.Date</code> with <code>java.util.Date</code>. Be careful of your <code>import</code> statements there. And, again, never use either of the <code>Date</code> classes.</p>\n<p>You mention a string of <code>2021-03-03</code>, but don't really explain where that is. At any rate, that represents a date-only value. But you say you accessing a <code>DATETIME</code> column in MySQL. According the <a href=\"https://dev.mysql.com/doc/refman/8.0/en/datetime.html\" rel=\"noreferrer\">the MySQL 8 documentation</a>, that type represents a date with a time-of-day.</p>\n<blockquote>\n<p>The DATETIME type is used for values that contain both date and time parts. MySQL retrieves and displays DATETIME values in 'YYYY-MM-DD hh:mm:ss' format. The supported range is '1000-01-01 00:00:00' to '9999-12-31 23:59:59'.</p>\n</blockquote>\n<p>So querying a date-with-time column by a date-only value makes no sense. The database cannot compare a date-only value to a date-with-time. You need to specify a span of time, a pair of date-with-time values for your start and end.</p>\n<p>Another problem: You are trying to use <code>java.util.Date</code> which represents a moment, a specific date with time as seen in the context of UTC — but the <code>DATETIME</code> type in MySQL is a different animal. The <code>DATETIME</code> type in MySQL represents a date with a time-of-day but lacks the context of an offset or time zone. This type is akin to the SQL type <code>TIMESTAMP WITHOUT TIME ZONE</code>.</p>\n<p>Beware: If you are <strong>trying to represent moments</strong> in your database, specific points on the timeline, then <strong>you are using the wrong data type</strong> for your column. For moments, you must use a data type akin to the SQL-standard <code>TIMESTAMP WITH TIME ZONE</code>. In MySQL 8, that would be the <code>TIMESTAMP</code> type. The <code>TIMESTAMP</code> type in MySQL tracks moments as seen in UTC, always in UTC. If your column in question is the one named <code>createdAt</code>, then you almost certainly are using the wrong data type, as tracking moments that passed as history must be done with SQL-standard <code>TIMESTAMP WITH TIME ZONE</code>. But I will ignore this crucial issue, and carry on with regard to the type you specified in your Question as written.</p>\n<p>If you are <em>not</em> tracking moments, such as tracking future appointments alongside time zone saved in an additional column, then your use of <code>DATETIME</code> would be correct. If you are sure of this datatype for your purpose, then in Java the appropriate match would be <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/LocalDateTime.html\" rel=\"noreferrer\"><code>LocalDateTime</code></a> class.</p>\n<p>Do your query for a day's worth of data over a <code>DATETIME</code> column by using the half-open approach to defining a span of time. The start is <em>inclusive</em> while the end is <em>exclusive</em>. So a day starts at first moment of the day and runs up to, but does not include, the start of the next day. With half-open, we do <em>not</em> use the SQL keyword <code>BETWEEN</code>.</p>\n<p>Here is a simple code example to adapt to your situation. I use neither Spring nor Hibernate, so you will have to translate accordingly.</p>\n<p>For your date-only input string, parse as a <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/LocalDate.html\" rel=\"noreferrer\"><code>LocalDate</code></a>.</p>\n<p>Tip: A short way of asking &quot;Is greater than or equal&quot; is &quot;Is not less than&quot;. We see this on the first case of the predicate in the SELECT statement below.</p>\n<pre class=\"lang-java prettyprint-override\"><code>LocalDate ld = LocalDate.parse( &quot;2021-03-03&quot; ) ;\nLocalDateTime startOfDay = ld.atStartOfDay() ;\nLocalDateTime startOfNextDay = ld.plusDays( 1 ).atStartOfDay() ;\nString sql = &quot;SELECT * FROM my_table WHERE when !&lt; ? AND when &lt; ? ;&quot; ;  // Performing query over a span-of-time defined as Half-Open. \n…\nmyPreparedStatement.setObject( 1 , startOfDay ) ;\nmyPreparedStatement.setObject( 2 , startOfNextDay ) ;\n</code></pre>\n<p>Retrieving <code>DATETIME</code> values.</p>\n<pre class=\"lang-java prettyprint-override\"><code>LocalDateTime ldt = myResultSet.getObject( … , LocalDateTime.class ) ;\n</code></pre>\n<p>All this has been discussed many many times already on Stack Overflow. Search to learn more.</p>\n<p><a href=\"https://i.stack.imgur.com/bXtIS.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/bXtIS.png\" alt=\"Table of date-time types in Java (both legacy and modern) and in standard SQL\" /></a></p>\n"
        }
      ],
      "owner": {
        "reputation": 53,
        "user_id": 15334653,
        "user_type": "registered",
        "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhoggBNsSTwGyYqHnOjqTvHbU9rp4F6a69j4hUb=k-s128",
        "display_name": "Gurucharan Sharma",
        "link": "https://stackoverflow.com/users/15334653/gurucharan-sharma"
      },
      "comment_count": 3,
      "view_count": 61,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1614925972,
      "question_id": 66487852,
      "body_markdown": "I am trying to fetch the results from the table for a specific date. I am passing the Date in String format using the URL, then parsing the String date to java.util.Date and then using that to fetch the values from the table. Within the table, the values are stored in a column that has a data type of Datetime.\r\n\r\n```\r\n@Query(value = &quot;&quot; +\r\n        &quot;FROM &quot; +\r\n        &quot;   MarketingForm mf &quot; +\r\n        &quot;WHERE &quot; +\r\n        &quot;   (:createdAt is null OR mf.createdAt = :createdAt)&quot; +\r\n        &quot;   AND (:verticalId is null OR mf.verticalId = :verticalId)&quot; +\r\n        &quot;   AND (:tag is null OR mf.tag = :tag)&quot;\r\n)\r\nList&lt;MarketingForm&gt; findAllByCreatedAtAndVerticalIdAndTag(@Param(&quot;createdAt&quot;) Date createdAt, @Param(&quot;verticalId&quot;) Long verticalId, @Param(&quot;tag&quot;) String tag);\r\n```\r\n\r\nBelow is the String Date and the corresponding java.util.Date\r\n - String Date = &#39;2021-03-03&#39;\r\n - java.util.Date converted Date = &#39;Wed Mar\r\n   03 00:00:00 IST 2021&#39;\r\n\r\nMethod that I am using to parse the String Date to java.util.Date -\r\n```\r\nSimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);\r\nreturn formatter.parse(formCreatedDate);\r\n```\r\n\r\nNow I am not sure what is happening here. The java.util.Date is not getting parsed correctly or whether I am doing comparison incorrectly, but the query is not able to fetch the results even though the records are there in the table.\r\n\r\nWhy is the above SQL not able to fetch the records for the specified Date, even though there are records present in the table?\r\n\r\n[![enter image description here][1]][1]\r\n\r\nNOTE: The data in the table is timeformat, and I only need to compare the date component for the date.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/EkG7z.png",
      "title": "Unable to compare java.util.Date value with MySQL datetime column values",
      "body": "<p>I am trying to fetch the results from the table for a specific date. I am passing the Date in String format using the URL, then parsing the String date to java.util.Date and then using that to fetch the values from the table. Within the table, the values are stored in a column that has a data type of Datetime.</p>\n<pre><code>@Query(value = &quot;&quot; +\n        &quot;FROM &quot; +\n        &quot;   MarketingForm mf &quot; +\n        &quot;WHERE &quot; +\n        &quot;   (:createdAt is null OR mf.createdAt = :createdAt)&quot; +\n        &quot;   AND (:verticalId is null OR mf.verticalId = :verticalId)&quot; +\n        &quot;   AND (:tag is null OR mf.tag = :tag)&quot;\n)\nList&lt;MarketingForm&gt; findAllByCreatedAtAndVerticalIdAndTag(@Param(&quot;createdAt&quot;) Date createdAt, @Param(&quot;verticalId&quot;) Long verticalId, @Param(&quot;tag&quot;) String tag);\n</code></pre>\n<p>Below is the String Date and the corresponding java.util.Date</p>\n<ul>\n<li>String Date = '2021-03-03'</li>\n<li>java.util.Date converted Date = 'Wed Mar\n03 00:00:00 IST 2021'</li>\n</ul>\n<p>Method that I am using to parse the String Date to java.util.Date -</p>\n<pre><code>SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);\nreturn formatter.parse(formCreatedDate);\n</code></pre>\n<p>Now I am not sure what is happening here. The java.util.Date is not getting parsed correctly or whether I am doing comparison incorrectly, but the query is not able to fetch the results even though the records are there in the table.</p>\n<p>Why is the above SQL not able to fetch the records for the specified Date, even though there are records present in the table?</p>\n<p><a href=\"https://i.stack.imgur.com/EkG7z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EkG7z.png\" alt=\"enter image description here\" /></a></p>\n<p>NOTE: The data in the table is timeformat, and I only need to compare the date component for the date.</p>\n"
    },
    {
      "tags": [
        "java",
        "exception",
        "checked-exceptions",
        "unchecked-exception"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 38361,
            "user_id": 5761558,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/b3cf04bfac11ef3ee693852eccde3b3c?s=128&d=identicon&r=PG&f=1",
            "display_name": "ernest_k",
            "link": "https://stackoverflow.com/users/5761558/ernest-k"
          },
          "score": 0,
          "creation_date": 1614836589,
          "post_id": 66469208,
          "comment_id": 117507660,
          "body_markdown": "This may be opinion-based, just as the whole checked/unchecked exception design is. And my opinion is that this distinction itself is one big thing too many for Java developers to worry about. Coding wouldn&#39;t be worse without checked exceptions in Java... on the contrary...",
          "body": "This may be opinion-based, just as the whole checked/unchecked exception design is. And my opinion is that this distinction itself is one big thing too many for Java developers to worry about. Coding wouldn&#39;t be worse without checked exceptions in Java... on the contrary..."
        },
        {
          "owner": {
            "reputation": 66658,
            "user_id": 1189885,
            "user_type": "registered",
            "accept_rate": 43,
            "profile_image": "https://i.stack.imgur.com/DLHqU.png?s=128&g=1",
            "display_name": "chrylis -cautiouslyoptimistic-",
            "link": "https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic"
          },
          "score": 0,
          "creation_date": 1614839261,
          "post_id": 66469208,
          "comment_id": 117508297,
          "body_markdown": "The original idea was that checked exceptions are for failure modes that the caller is expected to have some idea how to handle (e.g., network failed; retry) and that unchecked exceptions indicate actual software bugs (failure to validate input).",
          "body": "The original idea was that checked exceptions are for failure modes that the caller is expected to have some idea how to handle (e.g., network failed; retry) and that unchecked exceptions indicate actual software bugs (failure to validate input)."
        },
        {
          "owner": {
            "reputation": 6414,
            "user_id": 376527,
            "user_type": "registered",
            "accept_rate": 72,
            "profile_image": "https://www.gravatar.com/avatar/2014672faa0530abc886adf5725c5127?s=128&d=identicon&r=PG",
            "display_name": "Sam Goldberg",
            "link": "https://stackoverflow.com/users/376527/sam-goldberg"
          },
          "score": 0,
          "creation_date": 1614875468,
          "post_id": 66469208,
          "comment_id": 117525068,
          "body_markdown": "This is a good question, but it is a design question/philosophical issue.  .NET, for example, decided not to use checked exceptions -- because in most cases you need to generally catch Exceptions in a meaningful spot so that the app can keep running.  See  [Why are Exceptions not Checked in .NET](https://stackoverflow.com/questions/124143/why-are-exceptions-not-checked-in-net).",
          "body": "This is a good question, but it is a design question/philosophical issue.  .NET, for example, decided not to use checked exceptions -- because in most cases you need to generally catch Exceptions in a meaningful spot so that the app can keep running.  See  <a href=\"https://stackoverflow.com/questions/124143/why-are-exceptions-not-checked-in-net\">Why are Exceptions not Checked in .NET</a>."
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 21777,
                "user_id": 8976,
                "user_type": "registered",
                "accept_rate": 100,
                "profile_image": "https://www.gravatar.com/avatar/9dc432b57f4370eaf4b91baa1e6b8147?s=128&d=identicon&r=PG",
                "display_name": "EricSchaefer",
                "link": "https://stackoverflow.com/users/8976/ericschaefer"
              },
              "score": 0,
              "creation_date": 1614840726,
              "post_id": 66469323,
              "comment_id": 117508728,
              "body_markdown": "That&#39;s not what the quote is talking about.",
              "body": "That&#39;s not what the quote is talking about."
            }
          ],
          "owner": {
            "reputation": 164,
            "user_id": 10401397,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/4f6464339a29ed638389d784bbb74f1d?s=128&d=identicon&r=PG&f=1",
            "display_name": "Onkar",
            "link": "https://stackoverflow.com/users/10401397/onkar"
          },
          "comment_count": 1,
          "score": 0,
          "creation_date": 1614836999,
          "answer_id": 66469323,
          "body_markdown": "When an exception is checked and the exception occurs, its easy to troubleshoot the reason for exception. If we don&#39;t use checked exceptions, it would be very difficult to figure out the reason of exception. Checked exception gives an idea of the expected exception.\r\n",
          "body": "<p>When an exception is checked and the exception occurs, its easy to troubleshoot the reason for exception. If we don't use checked exceptions, it would be very difficult to figure out the reason of exception. Checked exception gives an idea of the expected exception.</p>\n"
        },
        {
          "owner": {
            "reputation": 21777,
            "user_id": 8976,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/9dc432b57f4370eaf4b91baa1e6b8147?s=128&d=identicon&r=PG",
            "display_name": "EricSchaefer",
            "link": "https://stackoverflow.com/users/8976/ericschaefer"
          },
          "comment_count": 0,
          "score": 0,
          "creation_date": 1614840665,
          "answer_id": 66469961,
          "body_markdown": "The meaning of the quote is this: If the client code can not recover from the problem, it needs to let the exception propagate to higher layers. If you use checked exceptions for that, you need to declare the checked exception through all call layers without benefit.\r\n\r\nTo rephrase the quote: If the exception is expected to propagate through the layers, make it unchecked. Only make it checked if the caller can actually do something about it.",
          "body": "<p>The meaning of the quote is this: If the client code can not recover from the problem, it needs to let the exception propagate to higher layers. If you use checked exceptions for that, you need to declare the checked exception through all call layers without benefit.</p>\n<p>To rephrase the quote: If the exception is expected to propagate through the layers, make it unchecked. Only make it checked if the caller can actually do something about it.</p>\n"
        }
      ],
      "owner": {
        "reputation": 30121,
        "user_id": 1029146,
        "user_type": "registered",
        "accept_rate": 90,
        "profile_image": "https://www.gravatar.com/avatar/a659be962c006e43e110b5a9dfda538e?s=128&d=identicon&r=PG",
        "display_name": "temporary_user_name",
        "link": "https://stackoverflow.com/users/1029146/temporary-user-name"
      },
      "comment_count": 3,
      "view_count": 65,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1614836330,
      "question_id": 66469208,
      "body_markdown": "I was reading about checked vs unchecked exceptions in Java and when to use each:\r\n\r\n&gt; Here&#39;s the bottom line: If a client can reasonably be expected to recover from an exception, make it a checked exception. If a client cannot do anything to recover from the exception, make it an unchecked exception.\r\n\r\nAn example of something a client can&#39;t be expected to recover from is divide by zero, where something they can recover from is a FileNotFound exception. I don&#39;t see the difference yet though. Why can  you catch one and log an error but not catch the other and log the error? What makes something reasonably recoverable? Can&#39;t you catch an error (thus recovering) in *all* circumstances?",
      "title": "How do you judge whether to make an exception checked or unchecked?",
      "body": "<p>I was reading about checked vs unchecked exceptions in Java and when to use each:</p>\n<blockquote>\n<p>Here's the bottom line: If a client can reasonably be expected to recover from an exception, make it a checked exception. If a client cannot do anything to recover from the exception, make it an unchecked exception.</p>\n</blockquote>\n<p>An example of something a client can't be expected to recover from is divide by zero, where something they can recover from is a FileNotFound exception. I don't see the difference yet though. Why can  you catch one and log an error but not catch the other and log the error? What makes something reasonably recoverable? Can't you catch an error (thus recovering) in <em>all</em> circumstances?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "prometheus"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 1170,
            "user_id": 7303998,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/77870618fc618071154cf7692d55fbc8?s=128&d=identicon&r=PG&f=1",
            "display_name": "MateuszW90",
            "link": "https://stackoverflow.com/users/7303998/mateuszw90"
          },
          "comment_count": 0,
          "score": 0,
          "creation_date": 1615454406,
          "answer_id": 66579579,
          "body_markdown": "Solution: we need to add properties to the test annotation or to `application-test.yml`:\r\n\r\n    @ExtendWith(SpringExtension.class)\r\n    @SpringBootTest(\r\n      webEnvironment = RANDOM_PORT,\r\n      properties = &quot;management.metrics.export.prometheus.enabled&quot;)\r\n    @ActiveProfiles({&quot;test&quot;})\r\n    @AutoConfigureMockMvc",
          "body": "<p>Solution: we need to add properties to the test annotation or to <code>application-test.yml</code>:</p>\n<pre><code>@ExtendWith(SpringExtension.class)\n@SpringBootTest(\n  webEnvironment = RANDOM_PORT,\n  properties = &quot;management.metrics.export.prometheus.enabled&quot;)\n@ActiveProfiles({&quot;test&quot;})\n@AutoConfigureMockMvc\n</code></pre>\n"
        }
      ],
      "owner": {
        "reputation": 1170,
        "user_id": 7303998,
        "user_type": "registered",
        "accept_rate": 100,
        "profile_image": "https://www.gravatar.com/avatar/77870618fc618071154cf7692d55fbc8?s=128&d=identicon&r=PG&f=1",
        "display_name": "MateuszW90",
        "link": "https://stackoverflow.com/users/7303998/mateuszw90"
      },
      "comment_count": 0,
      "view_count": 29,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1615446904,
      "question_id": 66577939,
      "body_markdown": "I want to test Prometheus metrics endpoint using `MockMvc` class. \r\n\r\nEverything works fine but yesterday I migrate my project to `Java 15`, `SpringBoot 2.4.3` and `SpringCloud 2020.0.1`. Now, only prometheus test not works and I receive **404** not **200** as expected. I have all the necessary dependency on `build.gradle` e.q.: `runtime(&quot;io.micrometer:micrometer-registry-prometheus&quot;)`. On `application-test.yml` I have a configuration for disabled security, contract tests pact broker endpoints etc.\r\n\r\nmy test:\r\n\r\n    @ExtendWith({SpringExtension.class, PostgresSpringDataSourceExtension.class})\r\n    @ActiveProfiles({&quot;test&quot;})\r\n    @SpringBootTest\r\n    @AutoConfigureMockMvc\r\n    public class PrometheusEndpointTest {\r\n\r\n     @Autowired private MockMvc mockMvc;\r\n\r\n     @Test\r\n     public void metricsThroughPrometheusEndpoint() throws Exception {\r\n      MvcResult result = \r\n      this.mockMvc.perform(get(&quot;/metrics&quot;)).andExpect(status().isOk()).andReturn();\r\n     }\r\n    }\r\n\r\nPart of `application.yaml` configuration:\r\n\r\n    management:\r\n      endpoint:\r\n        prometheus:\r\n          enabled: true\r\n      endpoints:\r\n        enabled-by-default: false\r\n        web:\r\n          exposure:\r\n            include: &#39;prometheus&#39;\r\n          base-path: &#39;/&#39;\r\n          path-mapping:\r\n            prometheus: &#39;metrics&#39;",
      "title": "MockMvc receive 404 when prometheus endpoint is calling",
      "body": "<p>I want to test Prometheus metrics endpoint using <code>MockMvc</code> class.</p>\n<p>Everything works fine but yesterday I migrate my project to <code>Java 15</code>, <code>SpringBoot 2.4.3</code> and <code>SpringCloud 2020.0.1</code>. Now, only prometheus test not works and I receive <strong>404</strong> not <strong>200</strong> as expected. I have all the necessary dependency on <code>build.gradle</code> e.q.: <code>runtime(&quot;io.micrometer:micrometer-registry-prometheus&quot;)</code>. On <code>application-test.yml</code> I have a configuration for disabled security, contract tests pact broker endpoints etc.</p>\n<p>my test:</p>\n<pre><code>@ExtendWith({SpringExtension.class, PostgresSpringDataSourceExtension.class})\n@ActiveProfiles({&quot;test&quot;})\n@SpringBootTest\n@AutoConfigureMockMvc\npublic class PrometheusEndpointTest {\n\n @Autowired private MockMvc mockMvc;\n\n @Test\n public void metricsThroughPrometheusEndpoint() throws Exception {\n  MvcResult result = \n  this.mockMvc.perform(get(&quot;/metrics&quot;)).andExpect(status().isOk()).andReturn();\n }\n}\n</code></pre>\n<p>Part of <code>application.yaml</code> configuration:</p>\n<pre><code>management:\n  endpoint:\n    prometheus:\n      enabled: true\n  endpoints:\n    enabled-by-default: false\n    web:\n      exposure:\n        include: 'prometheus'\n      base-path: '/'\n      path-mapping:\n        prometheus: 'metrics'\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "arrays",
        "string"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 506,
            "user_id": 15177026,
            "user_type": "registered",
            "profile_image": "https://lh4.googleusercontent.com/-p-5Vjs5I8eU/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclNPtAX5YYXpOb-5UbzmOWIQd3v6A/s96-c/photo.jpg?sz=128",
            "display_name": "Sorin",
            "link": "https://stackoverflow.com/users/15177026/sorin"
          },
          "score": 0,
          "creation_date": 1615273997,
          "post_id": 66539502,
          "comment_id": 117633375,
          "body_markdown": "Can you post your Unit Test?",
          "body": "Can you post your Unit Test?"
        },
        {
          "owner": {
            "reputation": 55,
            "user_id": 14806829,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/1d702f4c49b73631a1a4a68e66685b00?s=128&d=identicon&r=PG&f=1",
            "display_name": "user14806829",
            "link": "https://stackoverflow.com/users/14806829/user14806829"
          },
          "score": 0,
          "creation_date": 1615302138,
          "post_id": 66539502,
          "comment_id": 117645363,
          "body_markdown": "It was online compiler question, I could not see exactly which test case failed",
          "body": "It was online compiler question, I could not see exactly which test case failed"
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 506,
                "user_id": 15177026,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-p-5Vjs5I8eU/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclNPtAX5YYXpOb-5UbzmOWIQd3v6A/s96-c/photo.jpg?sz=128",
                "display_name": "Sorin",
                "link": "https://stackoverflow.com/users/15177026/sorin"
              },
              "score": 0,
              "creation_date": 1615273689,
              "post_id": 66540514,
              "comment_id": 117633280,
              "body_markdown": "`[^]` is the RegEx negation, so the RegEx means &quot;replace all except&quot;",
              "body": "<code>[^]</code> is the RegEx negation, so the RegEx means &quot;replace all except&quot;"
            },
            {
              "owner": {
                "reputation": 508,
                "user_id": 12785994,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/9731fedcfbf86574d81a6f116b39ad53?s=128&d=identicon&r=PG&f=1",
                "display_name": "javadev",
                "link": "https://stackoverflow.com/users/12785994/javadev"
              },
              "score": 0,
              "creation_date": 1615274070,
              "post_id": 66540514,
              "comment_id": 117633410,
              "body_markdown": "I know what a regex notation is :) You may Look at the definition of the author &quot;remove all special characters&quot;. so I asked whether a &quot;-&quot; count as special charater or not? he used it as exception (i.e - it&#39;s not a special charater and the value in this case is 10), so I wanted to verify.",
              "body": "I know what a regex notation is :) You may Look at the definition of the author &quot;remove all special characters&quot;. so I asked whether a &quot;-&quot; count as special charater or not? he used it as exception (i.e - it&#39;s not a special charater and the value in this case is 10), so I wanted to verify."
            },
            {
              "owner": {
                "reputation": 506,
                "user_id": 15177026,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-p-5Vjs5I8eU/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclNPtAX5YYXpOb-5UbzmOWIQd3v6A/s96-c/photo.jpg?sz=128",
                "display_name": "Sorin",
                "link": "https://stackoverflow.com/users/15177026/sorin"
              },
              "score": 0,
              "creation_date": 1615274327,
              "post_id": 66540514,
              "comment_id": 117633503,
              "body_markdown": "Oh, &quot;hyphen&quot; is missing from the question body but is in headline. Sorry.",
              "body": "Oh, &quot;hyphen&quot; is missing from the question body but is in headline. Sorry."
            }
          ],
          "owner": {
            "reputation": 508,
            "user_id": 12785994,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/9731fedcfbf86574d81a6f116b39ad53?s=128&d=identicon&r=PG&f=1",
            "display_name": "javadev",
            "link": "https://stackoverflow.com/users/12785994/javadev"
          },
          "comment_count": 3,
          "score": 0,
          "creation_date": 1615261615,
          "answer_id": 66540514,
          "body_markdown": "First, the null / empty condition should be in the opposite order:\r\n\r\n        if(str==null || str.isEmpty())\r\n\r\nDo you understand why? (Hint: Java evaluation is lazy)\r\n\r\n\r\nAdditionally, does a &quot;-&quot; (minus) should be removed or not?\r\n\r\n",
          "body": "<p>First, the null / empty condition should be in the opposite order:</p>\n<pre><code>    if(str==null || str.isEmpty())\n</code></pre>\n<p>Do you understand why? (Hint: Java evaluation is lazy)</p>\n<p>Additionally, does a &quot;-&quot; (minus) should be removed or not?</p>\n"
        },
        {
          "owner": {
            "reputation": 18965,
            "user_id": 1140748,
            "user_type": "registered",
            "accept_rate": 93,
            "profile_image": "https://www.gravatar.com/avatar/bc97b9d2fe6e0197b6fff186af8133d4?s=128&d=identicon&r=PG",
            "display_name": "alain.janinm",
            "link": "https://stackoverflow.com/users/1140748/alain-janinm"
          },
          "comment_count": 0,
          "score": 0,
          "creation_date": 1615303948,
          "answer_id": 66549926,
          "body_markdown": "You can do this to count 10 words from your code.\r\nYou replace your string if it&#39;s a non-word (`\\W`) and you make an exception for hyphen.\r\n\r\n\tpublic class Test {\r\n\t\r\n\t\tpublic static void main(String[] args) {\r\n\t\t\tString myString = &quot;this is high-tech job market in which? we make. careers&quot;;\r\n\t\t\tmyString = myString.replaceAll(&quot;[\\\\W&amp;&amp;[^\\\\-]]&quot;, &quot; &quot;);\r\n\t\t\tString[] arrWords = myString.split(&quot;\\\\s+&quot;);\r\n\t\t    System.out.println(arrWords.length);\r\n\t\t}\r\n\t\r\n\t}\r\n\r\nThe advantage of using `\\W` is that it includes all unicode punctuation.\r\n\r\nFor exemple if you have these characters `‘ „`, `\\p{Punct}` won&#39;t work.\r\n\r\nHere is an alternative using `Pattern.UNICODE_CHARACTER_CLASS` if you need it :\r\n\r\n\timport java.util.ArrayList;\r\n\timport java.util.Arrays;\r\n\timport java.util.List;\r\n\timport java.util.regex.Pattern;\r\n\r\n\tpublic class Test {\r\n\t\r\n\t\tpublic static void main(String[] args) {\r\n\t\t    String myString = &quot;this is high-tech job market ‘ „ in which? we make. careers&quot;;\r\n\t\t    String[] arrWords2 = Pattern.compile(&quot;[\\\\p{Punct}&amp;&amp;[^-]]|\\\\s&quot;, Pattern.UNICODE_CHARACTER_CLASS).split(myString);\r\n\t\t    List&lt;String&gt; arrayList = new ArrayList&lt;String&gt;(Arrays.asList(arrWords2));\r\n\t\t    arrayList.removeAll(Arrays.asList(&quot;&quot;,null));\r\n\t\t    System.out.println(arrayList);\r\n\t\t    System.out.println(arrayList.size());\r\n\t\t}\r\n\t\r\n\t}",
          "body": "<p>You can do this to count 10 words from your code.\nYou replace your string if it's a non-word (<code>\\W</code>) and you make an exception for hyphen.</p>\n<pre><code>public class Test {\n\n    public static void main(String[] args) {\n        String myString = &quot;this is high-tech job market in which? we make. careers&quot;;\n        myString = myString.replaceAll(&quot;[\\\\W&amp;&amp;[^\\\\-]]&quot;, &quot; &quot;);\n        String[] arrWords = myString.split(&quot;\\\\s+&quot;);\n        System.out.println(arrWords.length);\n    }\n\n}\n</code></pre>\n<p>The advantage of using <code>\\W</code> is that it includes all unicode punctuation.</p>\n<p>For exemple if you have these characters <code>‘ „</code>, <code>\\p{Punct}</code> won't work.</p>\n<p>Here is an alternative using <code>Pattern.UNICODE_CHARACTER_CLASS</code> if you need it :</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.regex.Pattern;\n\npublic class Test {\n\n    public static void main(String[] args) {\n        String myString = &quot;this is high-tech job market ‘ „ in which? we make. careers&quot;;\n        String[] arrWords2 = Pattern.compile(&quot;[\\\\p{Punct}&amp;&amp;[^-]]|\\\\s&quot;, Pattern.UNICODE_CHARACTER_CLASS).split(myString);\n        List&lt;String&gt; arrayList = new ArrayList&lt;String&gt;(Arrays.asList(arrWords2));\n        arrayList.removeAll(Arrays.asList(&quot;&quot;,null));\n        System.out.println(arrayList);\n        System.out.println(arrayList.size());\n    }\n\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 42367,
            "user_id": 10819573,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/MWKel.jpg?s=128&g=1",
            "display_name": "Arvind Kumar Avinash",
            "link": "https://stackoverflow.com/users/10819573/arvind-kumar-avinash"
          },
          "comment_count": 0,
          "score": 2,
          "creation_date": 1615304621,
          "answer_id": 66550100,
          "body_markdown": "You can use the regex, `[\\p{Punct}&amp;&amp;[^-]]` where `\\p{Punct}` stands for a punctuation. If you want to replace everything other than alphabets, digits, hyphen and space, you can use the regex, `[^\\p{Alnum}\\s-]` where `\\p{Alnum}` stands for an [alphanumeric character][1].\r\n\r\n**Demo:**\r\n\r\n    import java.util.Arrays;\r\n    \r\n    public class Main {\r\n    \tpublic static void main(String[] args) {\r\n    \t\tString str = &quot;this is high-tech job market in which? we make. careers&quot;;\r\n    \r\n    \t\tString[] arr = str.replaceAll(&quot;[\\\\p{Punct}&amp;&amp;[^-]]&quot;, &quot;&quot;).split(&quot;\\\\s+&quot;);\r\n    \r\n    \t\tSystem.out.println(Arrays.toString(arr));\r\n    \r\n    \t\tint count = arr.length;\r\n    \r\n    \t\tSystem.out.println(count);\r\n    \t}\r\n    }\r\n\r\n**Output:**\r\n\r\n    [this, is, high-tech, job, market, in, which, we, make, careers]\r\n    10\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html\r\n",
          "body": "<p>You can use the regex, <code>[\\p{Punct}&amp;&amp;[^-]]</code> where <code>\\p{Punct}</code> stands for a punctuation. If you want to replace everything other than alphabets, digits, hyphen and space, you can use the regex, <code>[^\\p{Alnum}\\s-]</code> where <code>\\p{Alnum}</code> stands for an <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html\" rel=\"nofollow noreferrer\">alphanumeric character</a>.</p>\n<p><strong>Demo:</strong></p>\n<pre><code>import java.util.Arrays;\n\npublic class Main {\n    public static void main(String[] args) {\n        String str = &quot;this is high-tech job market in which? we make. careers&quot;;\n\n        String[] arr = str.replaceAll(&quot;[\\\\p{Punct}&amp;&amp;[^-]]&quot;, &quot;&quot;).split(&quot;\\\\s+&quot;);\n\n        System.out.println(Arrays.toString(arr));\n\n        int count = arr.length;\n\n        System.out.println(count);\n    }\n}\n</code></pre>\n<p><strong>Output:</strong></p>\n<pre><code>[this, is, high-tech, job, market, in, which, we, make, careers]\n10\n</code></pre>\n"
        }
      ],
      "owner": {
        "reputation": 55,
        "user_id": 14806829,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/1d702f4c49b73631a1a4a68e66685b00?s=128&d=identicon&r=PG&f=1",
        "display_name": "user14806829",
        "link": "https://stackoverflow.com/users/14806829/user14806829"
      },
      "comment_count": 2,
      "view_count": 64,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1615253167,
      "question_id": 66539502,
      "body_markdown": "Given a string &quot;this is high-tech job market in which? we make. careers&quot;\r\nI have to remove all special characters except hyphen and count number of words in a string so output should be 10 in this case.\r\nI have written below program but it did not pass the test cases.\r\n\r\n    public int countWords(String str) {\r\n        if(str.isEmpty() || str==null)\r\n           return 0;\r\n        String replacedString = str.replaceAll([&quot;^a-zA-Z0-9- ]&quot;,&quot;&quot;);\r\n        String[] arrWords = replacedString.split(&quot;\\\\s+&quot;);\r\n        return arrWords.length;\r\n    }",
      "title": "Given a string remove all the special characters except hyphen and count number of words",
      "body": "<p>Given a string &quot;this is high-tech job market in which? we make. careers&quot;\nI have to remove all special characters except hyphen and count number of words in a string so output should be 10 in this case.\nI have written below program but it did not pass the test cases.</p>\n<pre><code>public int countWords(String str) {\n    if(str.isEmpty() || str==null)\n       return 0;\n    String replacedString = str.replaceAll([&quot;^a-zA-Z0-9- ]&quot;,&quot;&quot;);\n    String[] arrWords = replacedString.split(&quot;\\\\s+&quot;);\n    return arrWords.length;\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "swing",
        "jar",
        "executable-jar",
        "embedded-resource"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 44447,
            "user_id": 300257,
            "user_type": "registered",
            "accept_rate": 89,
            "profile_image": "https://i.stack.imgur.com/gWeJr.jpg?s=128&g=1",
            "display_name": "Gilbert Le Blanc",
            "link": "https://stackoverflow.com/users/300257/gilbert-le-blanc"
          },
          "score": 2,
          "creation_date": 1615235830,
          "post_id": 66535959,
          "comment_id": 117624079,
          "body_markdown": "Yes, your entire application fits in a single JAR file.  You create a resource folder at the same level as your src folder, add the resource folder to the classpath and the resource is &quot;/background.jpg&quot;.",
          "body": "Yes, your entire application fits in a single JAR file.  You create a resource folder at the same level as your src folder, add the resource folder to the classpath and the resource is &quot;/background.jpg&quot;."
        },
        {
          "owner": {
            "reputation": 15331,
            "user_id": 3992939,
            "user_type": "registered",
            "accept_rate": 73,
            "profile_image": "https://i.stack.imgur.com/JNHZt.jpg?s=128&g=1",
            "display_name": "c0der",
            "link": "https://stackoverflow.com/users/3992939/c0der"
          },
          "score": 1,
          "creation_date": 1615265185,
          "post_id": 66535959,
          "comment_id": 117631122,
          "body_markdown": "_**like deleting this image**_ the application can delete the image from the screen but you can not delete it from the jar.",
          "body": "<i><b>like deleting this image</b></i> the application can delete the image from the screen but you can not delete it from the jar."
        }
      ],
      "answers": [
        {
          "owner": {
            "reputation": 144,
            "user_id": 11299770,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/IxD7x.png?s=128&g=1",
            "display_name": "J Banana",
            "link": "https://stackoverflow.com/users/11299770/j-banana"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615249252,
          "answer_id": 66539092,
          "body_markdown": "You can certainly put the image and the code in a single jar file. The image is not loading either because it&#39;s not in the jar file, or because it&#39;s not at the path `/images/backGround.jpg` inside the jar.\r\n\r\nOne helpful thing about jar files that you may not know: they are in .zip format, so you can use any zip tool to see what is inside the jar (temporarily renaming the jar file to .zip might make this easier). IF the image is not there, fix your jar build (you didn&#39;t say how you are making it, so not sure what you need to change). If the image is there but under a different path, then fix the jar build to put it in the right place, or change the path you are reading it from.",
          "body": "<p>You can certainly put the image and the code in a single jar file. The image is not loading either because it's not in the jar file, or because it's not at the path <code>/images/backGround.jpg</code> inside the jar.</p>\n<p>One helpful thing about jar files that you may not know: they are in .zip format, so you can use any zip tool to see what is inside the jar (temporarily renaming the jar file to .zip might make this easier). IF the image is not there, fix your jar build (you didn't say how you are making it, so not sure what you need to change). If the image is there but under a different path, then fix the jar build to put it in the right place, or change the path you are reading it from.</p>\n"
        },
        {
          "owner": {
            "reputation": 11,
            "user_id": 15365835,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/6fbae3b8d159cd52fd050f778afc736d?s=128&d=identicon&r=PG&f=1",
            "display_name": "Shubham Ashtaputre",
            "link": "https://stackoverflow.com/users/15365835/shubham-ashtaputre"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615377231,
          "answer_id": 66564252,
          "body_markdown": "Yes definitely you can include your entire application into single jar file i.e. Runnable jar file. But i would suggest you not to include your image inside the jar file, instead pass that image path to an Property file and use that property file in your code for image path. So that even if next time you need to change the image you just change the path in your property file and you dont have to export your entire project again.",
          "body": "<p>Yes definitely you can include your entire application into single jar file i.e. Runnable jar file. But i would suggest you not to include your image inside the jar file, instead pass that image path to an Property file and use that property file in your code for image path. So that even if next time you need to change the image you just change the path in your property file and you dont have to export your entire project again.</p>\n"
        }
      ],
      "owner": {
        "reputation": 37,
        "user_id": 15356083,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/79dded669928abd32b9937e56a211727?s=128&d=identicon&r=PG&f=1",
        "display_name": "Erwin Engel",
        "link": "https://stackoverflow.com/users/15356083/erwin-engel"
      },
      "comment_count": 2,
      "view_count": 70,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1615231763,
      "question_id": 66535959,
      "body_markdown": "I don&#39;t quite understand how creation of a Swing application really works.\r\nI have created a simple application that gets a background image from a path.\r\n\r\n    ImageIcon imageIcon = new ImageIcon(&quot;C:\\\\Java\\\\ApplicationName\\\\out\\\\Resourses\\\\backGround.jpg&quot;);\r\n    Image image = imageIcon.getImage(); // Создание картинки из него\r\n    Image temp = image.getScaledInstance(500,500,Image.SCALE_SMOOTH); \r\n    imageIcon = new ImageIcon(temp);\r\n    g2d.drawImage(temp,0,0,null);\r\n\r\nIt works, so I decided to make a JAR file independent from changes in the Java folder (like deleting this image) and put images in src - images ( package ). I don&#39;t know if it is possible though.\r\n\r\nI started to get background image like this.\r\n\r\n    ImageIcon imageIcon = new  ImageIcon(this.getClass().getResource(&quot;/images/backGround.jpg&quot;)); \r\n\r\nThe program works perfectly in IntelliJ IDEA but if I extract it to JAR file I get a blank background screen. Why is that?\r\n\r\nAnd can I have my entire application including images in a single JAR file? One that is not dependent on other folders?",
      "title": "Can I have my entire application in a single JAR file?",
      "body": "<p>I don't quite understand how creation of a Swing application really works.\nI have created a simple application that gets a background image from a path.</p>\n<pre><code>ImageIcon imageIcon = new ImageIcon(&quot;C:\\\\Java\\\\ApplicationName\\\\out\\\\Resourses\\\\backGround.jpg&quot;);\nImage image = imageIcon.getImage(); // Создание картинки из него\nImage temp = image.getScaledInstance(500,500,Image.SCALE_SMOOTH); \nimageIcon = new ImageIcon(temp);\ng2d.drawImage(temp,0,0,null);\n</code></pre>\n<p>It works, so I decided to make a JAR file independent from changes in the Java folder (like deleting this image) and put images in src - images ( package ). I don't know if it is possible though.</p>\n<p>I started to get background image like this.</p>\n<pre><code>ImageIcon imageIcon = new  ImageIcon(this.getClass().getResource(&quot;/images/backGround.jpg&quot;)); \n</code></pre>\n<p>The program works perfectly in IntelliJ IDEA but if I extract it to JAR file I get a blank background screen. Why is that?</p>\n<p>And can I have my entire application including images in a single JAR file? One that is not dependent on other folders?</p>\n"
    },
    {
      "tags": [
        "java",
        "java-text-blocks"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 34826,
            "user_id": 1273080,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=128&d=identicon&r=PG",
            "display_name": "Petr Janeček",
            "link": "https://stackoverflow.com/users/1273080/petr-jane%c4%8dek"
          },
          "score": 1,
          "creation_date": 1615195836,
          "post_id": 66527073,
          "comment_id": 117606714,
          "body_markdown": "I don&#39;t think that answers the question, does it? The OP is apparently aware of the &quot;&quot;&quot; syntax and of text blocks, he&#39;s using it. The question is about escaping the quotes and/or the newline. You have to have a newline after `&quot;&quot;&quot;` (see https://openjdk.java.net/jeps/378), I don&#39;t think you should need to escape single quotes, though.",
          "body": "I don&#39;t think that answers the question, does it? The OP is apparently aware of the &quot;&quot;&quot; syntax and of text blocks, he&#39;s using it. The question is about escaping the quotes and/or the newline. You have to have a newline after <code>&quot;&quot;&quot;</code> (see <a href=\"https://openjdk.java.net/jeps/378\" rel=\"nofollow noreferrer\">openjdk.java.net/jeps/378</a>), I don&#39;t think you should need to escape single quotes, though."
        },
        {
          "owner": {
            "reputation": 22270,
            "user_id": 133203,
            "user_type": "registered",
            "accept_rate": 97,
            "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1",
            "display_name": "Federico klez Culloca",
            "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"
          },
          "score": 0,
          "creation_date": 1615196092,
          "post_id": 66527073,
          "comment_id": 117606828,
          "body_markdown": "@PetrJaneček agreed, was going to vote to reopen but I see that&#39;s already been taken care of.",
          "body": "@PetrJaneček agreed, was going to vote to reopen but I see that&#39;s already been taken care of."
        },
        {
          "owner": {
            "reputation": 20191,
            "user_id": 2411243,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/jC999.png?s=128&g=1",
            "display_name": "Zabuzard",
            "link": "https://stackoverflow.com/users/2411243/zabuzard"
          },
          "score": 2,
          "creation_date": 1615196093,
          "post_id": 66527073,
          "comment_id": 117606829,
          "body_markdown": "I reopened the question because it is **not** a duplicate. The question is not about how to create multi-line strings in Java, but about a detail of the text-blocks feature that came with Java-15.",
          "body": "I reopened the question because it is <b>not</b> a duplicate. The question is not about how to create multi-line strings in Java, but about a detail of the text-blocks feature that came with Java-15."
        },
        {
          "owner": {
            "reputation": 20191,
            "user_id": 2411243,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/jC999.png?s=128&g=1",
            "display_name": "Zabuzard",
            "link": "https://stackoverflow.com/users/2411243/zabuzard"
          },
          "score": 2,
          "creation_date": 1615196271,
          "post_id": 66527073,
          "comment_id": 117606899,
          "body_markdown": "What you truly want are **raw strings**, not **text blocks**. Java doesnt have them (you can read the JEPs about text blocks and their history to see why).",
          "body": "What you truly want are <b>raw strings</b>, not <b>text blocks</b>. Java doesnt have them (you can read the JEPs about text blocks and their history to see why)."
        }
      ],
      "answers": [
        {
          "owner": {
            "reputation": 62653,
            "user_id": 1064245,
            "user_type": "registered",
            "accept_rate": 82,
            "profile_image": "https://www.gravatar.com/avatar/9e1ed9c48a989a39ff2a14b1d36c177a?s=128&d=identicon&r=PG&f=1",
            "display_name": "M A",
            "link": "https://stackoverflow.com/users/1064245/m-a"
          },
          "comment_count": 0,
          "score": 7,
          "creation_date": 1615195848,
          "answer_id": 66527301,
          "body_markdown": "No it&#39;s not possible as text blocks [require a newline as part of the opening delimiter](https://docs.oracle.com/javase/specs/jls/se15/html/jls-3.html#jls-3.10.6):\r\n\r\n&gt;The *opening delimiter* is a sequence that starts with three double quote characters (&quot;&quot;&quot;), continues with zero or more space, tab, and form feed characters, and concludes with a line terminator.\r\n\r\nSo you can&#39;t have a text block with only a single line.",
          "body": "<p>No it's not possible as text blocks <a href=\"https://docs.oracle.com/javase/specs/jls/se15/html/jls-3.html#jls-3.10.6\" rel=\"noreferrer\">require a newline as part of the opening delimiter</a>:</p>\n<blockquote>\n<p>The <em>opening delimiter</em> is a sequence that starts with three double quote characters (&quot;&quot;&quot;), continues with zero or more space, tab, and form feed characters, and concludes with a line terminator.</p>\n</blockquote>\n<p>So you can't have a text block with only a single line.</p>\n"
        },
        {
          "owner": {
            "reputation": 11446,
            "user_id": 4153426,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/c31a74eb097f59d849583fb59ed3616a?s=128&d=identicon&r=PG&f=1",
            "display_name": "m.antkowicz",
            "link": "https://stackoverflow.com/users/4153426/m-antkowicz"
          },
          "comment_count": 0,
          "score": 6,
          "creation_date": 1615195860,
          "answer_id": 66527306,
          "body_markdown": "No - it is not possible because there is **mandatory** new line after `&quot;&quot;&quot;` operator\r\n\r\nDue to the [documentation][1]\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/15/text-blocks/index.html#using-text-blocks\r\n\r\n&gt; A text block begins with three double-quote characters followed by a line terminator. You can&#39;t put a text block on a single line, nor can the contents of the text block follow the three opening double-quotes without an intervening line terminator. The reason for this is that text blocks are primarily designed to support multi-line strings, and requiring the initial line terminator simplifies the indentation handling rules (see the section below, Incidental White Space).",
          "body": "<p>No - it is not possible because there is <strong>mandatory</strong> new line after <code>&quot;&quot;&quot;</code> operator</p>\n<p>Due to the <a href=\"https://docs.oracle.com/en/java/javase/15/text-blocks/index.html#using-text-blocks\" rel=\"noreferrer\">documentation</a></p>\n<blockquote>\n<p>A text block begins with three double-quote characters followed by a line terminator. You can't put a text block on a single line, nor can the contents of the text block follow the three opening double-quotes without an intervening line terminator. The reason for this is that text blocks are primarily designed to support multi-line strings, and requiring the initial line terminator simplifies the indentation handling rules (see the section below, Incidental White Space).</p>\n</blockquote>\n"
        }
      ],
      "owner": {
        "reputation": 1316,
        "user_id": 2891692,
        "user_type": "registered",
        "accept_rate": 29,
        "profile_image": "https://i.stack.imgur.com/2Lf2V.jpg?s=128&g=1",
        "display_name": "SL5net",
        "link": "https://stackoverflow.com/users/2891692/sl5net"
      },
      "comment_count": 4,
      "view_count": 58,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1615194968,
      "question_id": 66527073,
      "body_markdown": "Is it possibly to use Javas **text blocks** feature (Java 15) but only write **a single line**?\r\n\r\nIt seems that I am forced to write multiple lines.\r\n\r\n----------\r\n\r\nFor example, I want write this in one line to avoid escaping the `&quot;` in it\r\n\r\n    String text = &quot;&quot;&quot;&lt;a href=&quot;https://sparkjava.com&quot;&gt;https://sparkjava.com/&lt;/a&gt;&quot;&quot;&quot;;\r\n\r\nbut it does not compile and I have to write\r\n\r\n    String text = &quot;&quot;&quot;\r\n        &lt;a href=&quot;https://sparkjava.com&quot;&gt;https://sparkjava.com/&lt;/a&gt;&quot;&quot;&quot;;\r\n\r\ninstead.\r\n\r\nAm I overlooking something?",
      "title": "Text blocks in a single line",
      "body": "<p>Is it possibly to use Javas <strong>text blocks</strong> feature (Java 15) but only write <strong>a single line</strong>?</p>\n<p>It seems that I am forced to write multiple lines.</p>\n<hr />\n<p>For example, I want write this in one line to avoid escaping the <code>&quot;</code> in it</p>\n<pre><code>String text = &quot;&quot;&quot;&lt;a href=&quot;https://sparkjava.com&quot;&gt;https://sparkjava.com/&lt;/a&gt;&quot;&quot;&quot;;\n</code></pre>\n<p>but it does not compile and I have to write</p>\n<pre><code>String text = &quot;&quot;&quot;\n    &lt;a href=&quot;https://sparkjava.com&quot;&gt;https://sparkjava.com/&lt;/a&gt;&quot;&quot;&quot;;\n</code></pre>\n<p>instead.</p>\n<p>Am I overlooking something?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "spring-cloud-config",
        "spring-boot-maven-plugin",
        "spring-cloud-config-server"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 918,
            "user_id": 5339661,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/MuuJL.jpg?s=128&g=1",
            "display_name": "Marcos Barbero",
            "link": "https://stackoverflow.com/users/5339661/marcos-barbero"
          },
          "score": 0,
          "creation_date": 1615191904,
          "post_id": 66525418,
          "comment_id": 117605085,
          "body_markdown": "I don&#39;t know if this is related, but the `groupId` for the `spring-boot-maven-plugin` is `org.springframework.boot` and now `org.springframework.cloud`",
          "body": "I don&#39;t know if this is related, but the <code>groupId</code> for the <code>spring-boot-maven-plugin</code> is <code>org.springframework.boot</code> and now <code>org.springframework.cloud</code>"
        }
      ],
      "owner": {
        "reputation": 41,
        "user_id": 15351649,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/953e8cc7e0dfcf52b40b81a0dd8d6ec3?s=128&d=identicon&r=PG&f=1",
        "display_name": "Chinna",
        "link": "https://stackoverflow.com/users/15351649/chinna"
      },
      "comment_count": 1,
      "view_count": 32,
      "answer_count": 0,
      "score": 4,
      "creation_date": 1615186281,
      "question_id": 66525418,
      "body_markdown": "I have some problem with spring cloud config client application. When I use spring-boot-starter-parent as parent in pom.xml(shown below), my application is working fine and able to fetch properties from spring cloud config server.\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    \txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    \t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \t**&lt;parent&gt;\r\n    \t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n    \t\t&lt;version&gt;2.4.3&lt;/version&gt;\r\n    \t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n    \t&lt;/parent&gt;**\r\n    \t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;demo&lt;/artifactId&gt;\r\n    \t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n    \t&lt;packaging&gt;war&lt;/packaging&gt;\r\n    \t&lt;name&gt;demo&lt;/name&gt;\r\n    \t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n    \t&lt;properties&gt;\r\n    \t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\r\n    \t\t&lt;spring-cloud.version&gt;2020.0.1&lt;/spring-cloud.version&gt;\r\n    \t&lt;/properties&gt;\r\n    \t&lt;dependencies&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\r\n    \t\t\t&lt;scope&gt;provided&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n    \t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t&lt;/dependencies&gt;\r\n    \t&lt;dependencyManagement&gt;\r\n    \t\t&lt;dependencies&gt;\r\n    \t\t\t&lt;dependency&gt;\r\n    \t\t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t\t&lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\r\n    \t\t\t\t&lt;version&gt;${spring-cloud.version}&lt;/version&gt;\r\n    \t\t\t\t&lt;type&gt;pom&lt;/type&gt;\r\n    \t\t\t\t&lt;scope&gt;import&lt;/scope&gt;\r\n    \t\t\t&lt;/dependency&gt;\r\n    \t\t&lt;/dependencies&gt;\r\n    \t&lt;/dependencyManagement&gt;\r\n    \r\n    \t&lt;build&gt;\r\n    \t\t&lt;plugins&gt;\r\n    \t\t\t&lt;plugin&gt;\r\n    \t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n    \t\t\t&lt;/plugin&gt;\r\n    \t\t&lt;/plugins&gt;\r\n    \t&lt;/build&gt;\r\n    &lt;/project&gt;\r\n\r\nBut I want make my existing application (which already have a parent dependency) as spring cloud config client, so I modified the pom.xml as below,\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    \txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    \t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \t**&lt;parent&gt;\r\n    \t\t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n    \t\t&lt;artifactId&gt;example_parent&lt;/artifactId&gt;\r\n    \t\t&lt;version&gt;1.1.1&lt;/version&gt;\r\n    \t&lt;/parent&gt;**\r\n    \t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;demo&lt;/artifactId&gt;\r\n    \t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n    \t&lt;packaging&gt;war&lt;/packaging&gt;\r\n    \t&lt;name&gt;demo&lt;/name&gt;\r\n    \t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n    \t&lt;properties&gt;\r\n    \t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\r\n    \t\t&lt;spring-cloud.version&gt;2020.0.1&lt;/spring-cloud.version&gt;\r\n    \t&lt;/properties&gt;\r\n    \t&lt;dependencies&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\r\n    \t\t\t&lt;scope&gt;provided&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n    \t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t&lt;/dependencies&gt;\r\n    \t&lt;dependencyManagement&gt;\r\n    \t\t&lt;dependencies&gt;\r\n    \t\t\t**&lt;dependency&gt;\r\n    \t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t\t&lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;\r\n    \t\t\t\t&lt;version&gt;2.4.3&lt;/version&gt;\r\n    \t\t\t\t&lt;type&gt;pom&lt;/type&gt;\r\n    \t\t\t\t&lt;scope&gt;import&lt;/scope&gt;\r\n    \t\t\t&lt;/dependency&gt;**\r\n    \t\t\t&lt;dependency&gt;\r\n    \t\t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t\t&lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\r\n    \t\t\t\t&lt;version&gt;${spring-cloud.version}&lt;/version&gt;\r\n    \t\t\t\t&lt;type&gt;pom&lt;/type&gt;\r\n    \t\t\t\t&lt;scope&gt;import&lt;/scope&gt;\r\n    \t\t\t&lt;/dependency&gt;\r\n    \t\t&lt;/dependencies&gt;\r\n    \t&lt;/dependencyManagement&gt;\r\n    \r\n    \t&lt;build&gt;\r\n    \t\t&lt;plugins&gt;\r\n    \t\t\t&lt;plugin&gt;\r\n    \t\t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n    \t\t\t&lt;/plugin&gt;\r\n    \t\t&lt;/plugins&gt;\r\n    \t&lt;/build&gt;\r\n    &lt;/project&gt;\r\n\r\nAfter the above modifications I got this error,\r\n\r\n    java.lang.NoClassDefFoundError: org/springframework/boot/Bootstrapper\r\n\r\nI fixed this error by adding the below dependency,\r\n\r\n    &lt;dependency&gt;\r\n    \t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n\r\nAfter adding the above dependency, I am getting the below error now,\r\n\r\n    org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;bootstrapImportSelectorConfiguration&#39;: Initialization of bean failed; nested exception is **java.lang.NoClassDefFoundError: org/springframework/boot/context/properties/ConfigurationPropertiesBean**\r\n\r\nI tried with updating the pring-boot-dependencies and spring-cloud-dependencies, but no luck. Can anyone help me to fix this error?",
      "title": "Spring cloud config client application is failing to start with java.lang.NoClassDefFoundError",
      "body": "<p>I have some problem with spring cloud config client application. When I use spring-boot-starter-parent as parent in pom.xml(shown below), my application is working fine and able to fetch properties from spring cloud config server.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    **&lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.4.3&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;**\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;name&gt;demo&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n        &lt;spring-cloud.version&gt;2020.0.1&lt;/spring-cloud.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n                &lt;version&gt;${spring-cloud.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>But I want make my existing application (which already have a parent dependency) as spring cloud config client, so I modified the pom.xml as below,</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    **&lt;parent&gt;\n        &lt;groupId&gt;com.example&lt;/groupId&gt;\n        &lt;artifactId&gt;example_parent&lt;/artifactId&gt;\n        &lt;version&gt;1.1.1&lt;/version&gt;\n    &lt;/parent&gt;**\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;name&gt;demo&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n        &lt;spring-cloud.version&gt;2020.0.1&lt;/spring-cloud.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            **&lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;\n                &lt;version&gt;2.4.3&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;**\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n                &lt;version&gt;${spring-cloud.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>After the above modifications I got this error,</p>\n<pre><code>java.lang.NoClassDefFoundError: org/springframework/boot/Bootstrapper\n</code></pre>\n<p>I fixed this error by adding the below dependency,</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>After adding the above dependency, I am getting the below error now,</p>\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'bootstrapImportSelectorConfiguration': Initialization of bean failed; nested exception is **java.lang.NoClassDefFoundError: org/springframework/boot/context/properties/ConfigurationPropertiesBean**\n</code></pre>\n<p>I tried with updating the pring-boot-dependencies and spring-cloud-dependencies, but no luck. Can anyone help me to fix this error?</p>\n"
    },
    {
      "tags": [
        "java",
        "oop",
        "memory-management",
        "interface",
        "jvm"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 4283,
            "user_id": 6304094,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/ca5952420104811d556385f320dd6f09?s=128&d=identicon&r=PG&f=1",
            "display_name": "Kevin Anderson",
            "link": "https://stackoverflow.com/users/6304094/kevin-anderson"
          },
          "score": 0,
          "creation_date": 1615093989,
          "post_id": 66513389,
          "comment_id": 117582808,
          "body_markdown": "They both consume exactly the same amount of memory: namely, the amount of memory occupied by an object reference, plus the amount of memory is consumed by an object of class `B`.",
          "body": "They both consume exactly the same amount of memory: namely, the amount of memory occupied by an object reference, plus the amount of memory is consumed by an object of class <code>B</code>."
        },
        {
          "owner": {
            "reputation": 384,
            "user_id": 15273968,
            "user_type": "registered",
            "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiPTSTvSLwxCoNGXb4iaZKgfD3GjGsb_99_CMC4Gw=k-s128",
            "display_name": "onkar ruikar",
            "link": "https://stackoverflow.com/users/15273968/onkar-ruikar"
          },
          "score": 0,
          "creation_date": 1615094109,
          "post_id": 66513389,
          "comment_id": 117582829,
          "body_markdown": "`typeInterface` and `typeClass` are just variables. They point to objects in memory. Both are pointing to objects of class B. so same memory is being consumed.",
          "body": "<code>typeInterface</code> and <code>typeClass</code> are just variables. They point to objects in memory. Both are pointing to objects of class B. so same memory is being consumed."
        }
      ],
      "answers": [
        {
          "owner": {
            "reputation": 652,
            "user_id": 6748042,
            "user_type": "registered",
            "profile_image": "https://graph.facebook.com/10208253094778639/picture?type=large",
            "display_name": "Victor Polo De Gyves Montero",
            "link": "https://stackoverflow.com/users/6748042/victor-polo-de-gyves-montero"
          },
          "comment_count": 0,
          "score": 5,
          "creation_date": 1615093953,
          "answer_id": 66513422,
          "body_markdown": "No, you have two objects of type B, one stored on a reference of type A, the other one stored on a reference of type B. \r\n\r\nBoth objects share the same memory usage size, but you cannot access the methods of B from the reference of type A (the reference named `typeInterface`), even if the method exists at the referenced object, unless you cast it. If you cast the reference, then the restriction is removed and you can access `anotherMethod`.\r\n\r\nYou must differentiate between references and objects. That&#39;s all you need.",
          "body": "<p>No, you have two objects of type B, one stored on a reference of type A, the other one stored on a reference of type B.</p>\n<p>Both objects share the same memory usage size, but you cannot access the methods of B from the reference of type A (the reference named <code>typeInterface</code>), even if the method exists at the referenced object, unless you cast it. If you cast the reference, then the restriction is removed and you can access <code>anotherMethod</code>.</p>\n<p>You must differentiate between references and objects. That's all you need.</p>\n"
        },
        {
          "owner": {
            "reputation": 239079,
            "user_id": 14955,
            "user_type": "registered",
            "accept_rate": 55,
            "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1",
            "display_name": "Thilo",
            "link": "https://stackoverflow.com/users/14955/thilo"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615094123,
          "answer_id": 66513438,
          "body_markdown": "What consumes memory are object instances. Both of your instances are created by `new B()` so they will take up the same amount of heap memory.\r\n\r\nIn addition to your two object instances, you also have two variables pointing to them. These are stored on the stack of the method that uses them. How much memory a variable takes depends on it being a primitive or an object reference, but that&#39;s it. All object references (regardless of their type) take up the same amount of space there. ",
          "body": "<p>What consumes memory are object instances. Both of your instances are created by <code>new B()</code> so they will take up the same amount of heap memory.</p>\n<p>In addition to your two object instances, you also have two variables pointing to them. These are stored on the stack of the method that uses them. How much memory a variable takes depends on it being a primitive or an object reference, but that's it. All object references (regardless of their type) take up the same amount of space there.</p>\n"
        },
        {
          "owner": {
            "reputation": 159,
            "user_id": 13452875,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/e75b6ef09b9ae0b289dbb18ce3f483bd?s=128&d=identicon&r=PG&f=1",
            "display_name": "Track_suit",
            "link": "https://stackoverflow.com/users/13452875/track-suit"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615094712,
          "answer_id": 66513489,
          "body_markdown": "\r\nClass:\r\n\r\nA class is a user-defined blueprint or prototype from which objects are created.  It represents the set of properties or methods that are common to all objects of one type. In general, class declarations can include these components, in order:\r\n\r\n    Modifiers: A class can be public or has default access (Refer to this for details).\r\n    Class name: The name should begin with an initial letter (capitalized by convention).\r\n    Superclass(if any): The name of the class’s parent (superclass), if any, preceded by the keyword extends. A class can only extend (subclass) one parent.\r\n    Interfaces(if any): A comma-separated list of interfaces implemented by the class, if any, preceded by the keyword implements. A class can implement more than one interface.\r\n    Body: The class body surrounded by braces, { }.\r\n\r\nConstructors are used for initializing new objects. Fields are variables that provide the state of the class and its objects, and methods are used to implement the behavior of the class and its objects.\r\n**********************************************************************************************************************************************************************************\r\nInterface:\r\nLike a class, an interface can have methods and variables, but the methods declared in the interface are by default abstract (only method signature, nobody).  \r\n\r\n    Interfaces specify what a class must do and not how. It is the blueprint of the class.\r\n    An Interface is about capabilities like a Player may be an interface and any class implementing Player must be able to (or must implement) move(). So it specifies a set of methods that the class has to implement.\r\n    If a class implements an interface and does not provide method bodies for all functions specified in the interface, then the class must be declared abstract.\r\n    A Java library example is Comparator Interface. If a class implements this interface, then it can be used to sort a collection.\r\n",
          "body": "<p>Class:</p>\n<p>A class is a user-defined blueprint or prototype from which objects are created.  It represents the set of properties or methods that are common to all objects of one type. In general, class declarations can include these components, in order:</p>\n<pre><code>Modifiers: A class can be public or has default access (Refer to this for details).\nClass name: The name should begin with an initial letter (capitalized by convention).\nSuperclass(if any): The name of the class’s parent (superclass), if any, preceded by the keyword extends. A class can only extend (subclass) one parent.\nInterfaces(if any): A comma-separated list of interfaces implemented by the class, if any, preceded by the keyword implements. A class can implement more than one interface.\nBody: The class body surrounded by braces, { }.\n</code></pre>\n<p>Constructors are used for initializing new objects. Fields are variables that provide the state of the class and its objects, and methods are used to implement the behavior of the class and its objects.</p>\n<hr />\n<p>Interface:\nLike a class, an interface can have methods and variables, but the methods declared in the interface are by default abstract (only method signature, nobody).</p>\n<pre><code>Interfaces specify what a class must do and not how. It is the blueprint of the class.\nAn Interface is about capabilities like a Player may be an interface and any class implementing Player must be able to (or must implement) move(). So it specifies a set of methods that the class has to implement.\nIf a class implements an interface and does not provide method bodies for all functions specified in the interface, then the class must be declared abstract.\nA Java library example is Comparator Interface. If a class implements this interface, then it can be used to sort a collection.\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 181,
            "user_id": 14312771,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/7a9a38638c8611ce1351ae80cf6df656?s=128&d=identicon&r=PG&f=1",
            "display_name": "Neha Jha",
            "link": "https://stackoverflow.com/users/14312771/neha-jha"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615094743,
          "answer_id": 66513493,
          "body_markdown": "**Interface** simply makes sure that objects meet a certain criteria both technically and logically at compile time. When executing the code and using an interface, memory will be allocated as if you would just instantiate the object using the class.\r\n\r\nSo there&#39;s no difference (in terms of memory allocation) between:\r\n\r\n    A typeInterface = new B();\r\nand\r\n\r\n    B typeClass = new B();\r\n\r\nFirst is the new B() statement which allocates sizeof(B) on the heap.&lt;br /&gt; \r\nSecond, the assignment of the address of the heap allocation is stored in the variable test, which is allocated on the stack as sizeof(object *) (i.e. IntPtr.Size, or 32/64 bits based on the hardware+OS+software running).&lt;br /&gt;&lt;br /&gt;\r\nThe following statement is EXACTLY the same in &#39;allocations&#39;:\r\n\r\n     B typeClass = new B();\r\nThe only difference between the two is the methods available to be called on the variable &#39;typeInterface&#39;.\r\n\r\n",
          "body": "<p><strong>Interface</strong> simply makes sure that objects meet a certain criteria both technically and logically at compile time. When executing the code and using an interface, memory will be allocated as if you would just instantiate the object using the class.</p>\n<p>So there's no difference (in terms of memory allocation) between:</p>\n<pre><code>A typeInterface = new B();\n</code></pre>\n<p>and</p>\n<pre><code>B typeClass = new B();\n</code></pre>\n<p>First is the new B() statement which allocates sizeof(B) on the heap.<br />\nSecond, the assignment of the address of the heap allocation is stored in the variable test, which is allocated on the stack as sizeof(object *) (i.e. IntPtr.Size, or 32/64 bits based on the hardware+OS+software running).<br /><br />\nThe following statement is EXACTLY the same in 'allocations':</p>\n<pre><code> B typeClass = new B();\n</code></pre>\n<p>The only difference between the two is the methods available to be called on the variable 'typeInterface'.</p>\n"
        },
        {
          "owner": {
            "reputation": 623256,
            "user_id": 139985,
            "user_type": "registered",
            "accept_rate": 69,
            "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG",
            "display_name": "Stephen C",
            "link": "https://stackoverflow.com/users/139985/stephen-c"
          },
          "comment_count": 0,
          "score": 3,
          "creation_date": 1615095715,
          "answer_id": 66513580,
          "body_markdown": "&gt; My question is, when compiler compiles the code and when the memory allocation begins, we&#39;ve got two objects right? \r\n\r\nYes.\r\n\r\n&gt; But one is type `A`, one is type `B`, ...\r\n\r\nNo!!  \r\n\r\nBoth are type `B`.  The expression `new B(...)` creates a `B`. What happens after that doesn&#39;t change that.\r\n\r\nIn the first example, you are then assigning the reference for a `B` instance to a variable whose type is `A`.  That means that you will only be able to use `A` features (methods, fields) when you access the object *via that variable*.\r\n\r\nHowever, the object itself is *still* an instance of `B`, and will remain that way for the lifetime of the object.  And we can *prove* it&lt;sup&gt;1&lt;/sup&gt;.\r\n\r\n      System.out.println(typeInterface.getClass().getName());\r\n\r\nwill print &quot;B&quot;, not &quot;A&quot;.\r\n\r\nAnd we can go a step further by casting `typeInterface` to a `B` and using the `B` methods and fields ... to show that it is really a `B`.\r\n\r\nIt is a `B`.  Unequivocally.\r\n\r\n&gt; ... that means &#39;typeInterface&#39; will have only one method, but &#39;typeClass&#39; will contain one more field and one more method.\r\n\r\nNo.  Not true.  This logic is based on a false assumption.  See above.\r\n\r\n&gt; Does these two objects allocate the same amount of memory or &#39;typeInterface&#39; basically consume much less memory?\r\n\r\nYes they user the same amount of memory.  They are both `B` instances.  See above.\r\n\r\n--------------\r\n\r\nOne way to understand this is that when you do the assignment in this:\r\n\r\n    A typeInterface = new B();\r\n\r\nthe compiler &quot;forgets&quot; about the `B`-ness of the object that `typeInterface` (now) refers to.  It only &quot;remembers&quot; that it refers to an `A` *of some kind*.  However, at runtime, the runtime system *always* knows what an object&#39;s real type is, so that it can correctly implement `instanceof`, type-casts, `getClass()`, method dispatching and so on.\r\n\r\n\r\n---------------\r\n\r\n&lt;sup&gt;1 - The javadoc for `Object::getClass()` states: *&quot;Returns the runtime class of this `Object`&quot;*.&lt;/sup&gt;\r\n\r\n    ",
          "body": "<blockquote>\n<p>My question is, when compiler compiles the code and when the memory allocation begins, we've got two objects right?</p>\n</blockquote>\n<p>Yes.</p>\n<blockquote>\n<p>But one is type <code>A</code>, one is type <code>B</code>, ...</p>\n</blockquote>\n<p>No!!</p>\n<p>Both are type <code>B</code>.  The expression <code>new B(...)</code> creates a <code>B</code>. What happens after that doesn't change that.</p>\n<p>In the first example, you are then assigning the reference for a <code>B</code> instance to a variable whose type is <code>A</code>.  That means that you will only be able to use <code>A</code> features (methods, fields) when you access the object <em>via that variable</em>.</p>\n<p>However, the object itself is <em>still</em> an instance of <code>B</code>, and will remain that way for the lifetime of the object.  And we can <em>prove</em> it<sup>1</sup>.</p>\n<pre><code>  System.out.println(typeInterface.getClass().getName());\n</code></pre>\n<p>will print &quot;B&quot;, not &quot;A&quot;.</p>\n<p>And we can go a step further by casting <code>typeInterface</code> to a <code>B</code> and using the <code>B</code> methods and fields ... to show that it is really a <code>B</code>.</p>\n<p>It is a <code>B</code>.  Unequivocally.</p>\n<blockquote>\n<p>... that means 'typeInterface' will have only one method, but 'typeClass' will contain one more field and one more method.</p>\n</blockquote>\n<p>No.  Not true.  This logic is based on a false assumption.  See above.</p>\n<blockquote>\n<p>Does these two objects allocate the same amount of memory or 'typeInterface' basically consume much less memory?</p>\n</blockquote>\n<p>Yes they user the same amount of memory.  They are both <code>B</code> instances.  See above.</p>\n<hr />\n<p>One way to understand this is that when you do the assignment in this:</p>\n<pre><code>A typeInterface = new B();\n</code></pre>\n<p>the compiler &quot;forgets&quot; about the <code>B</code>-ness of the object that <code>typeInterface</code> (now) refers to.  It only &quot;remembers&quot; that it refers to an <code>A</code> <em>of some kind</em>.  However, at runtime, the runtime system <em>always</em> knows what an object's real type is, so that it can correctly implement <code>instanceof</code>, type-casts, <code>getClass()</code>, method dispatching and so on.</p>\n<hr />\n<p><sup>1 - The javadoc for <code>Object::getClass()</code> states: <em>&quot;Returns the runtime class of this <code>Object</code>&quot;</em>.</sup></p>\n"
        }
      ],
      "owner": {
        "reputation": 43,
        "user_id": 15248284,
        "user_type": "registered",
        "profile_image": "https://lh4.googleusercontent.com/-YNkwsKF5pNw/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucngUmoE1DIp_HJUrLMyQ0kUlH0R8Q/s96-c/photo.jpg?sz=128",
        "display_name": "ilkerrilker",
        "link": "https://stackoverflow.com/users/15248284/ilkerrilker"
      },
      "comment_count": 2,
      "view_count": 75,
      "answer_count": 5,
      "score": 4,
      "creation_date": 1615093646,
      "question_id": 66513389,
      "body_markdown": "Suppose there are Interface A and class B, and class B implements the interface;\r\n\r\n    interface A {\r\n      void hello();\r\n    }\r\n    \r\n    class B implements A {\r\n      public int justAField;\r\n\r\n      @Override\r\n      public void hello() {\r\n        System.out.println(&quot;Hi.&quot;);\r\n      }\r\n\r\n      public void anotherMethod() {\r\n        System.out.println(&quot;Another one.&quot;);\r\n      }\r\n    }\r\n\r\nAnd let&#39;s say, we have these two objects;\r\n\r\n    A typeInterface = new B();\r\n    B typeClass = new B();\r\n\r\nMy question is, when compiler compiles the code and when the memory allocation begins, we&#39;ve got two objects right? But one is type A, one is type B, that means &#39;typeInterface&#39; will have only one method, but &#39;typeClass&#39; will contain one more field and one more method.\r\n\r\nDoes these two objects allocate the same amount of memory or &#39;typeInterface&#39; basically consume much less memory?",
      "title": "Difference between Interface and Class object memory allocation",
      "body": "<p>Suppose there are Interface A and class B, and class B implements the interface;</p>\n<pre><code>interface A {\n  void hello();\n}\n\nclass B implements A {\n  public int justAField;\n\n  @Override\n  public void hello() {\n    System.out.println(&quot;Hi.&quot;);\n  }\n\n  public void anotherMethod() {\n    System.out.println(&quot;Another one.&quot;);\n  }\n}\n</code></pre>\n<p>And let's say, we have these two objects;</p>\n<pre><code>A typeInterface = new B();\nB typeClass = new B();\n</code></pre>\n<p>My question is, when compiler compiles the code and when the memory allocation begins, we've got two objects right? But one is type A, one is type B, that means 'typeInterface' will have only one method, but 'typeClass' will contain one more field and one more method.</p>\n<p>Does these two objects allocate the same amount of memory or 'typeInterface' basically consume much less memory?</p>\n"
    },
    {
      "tags": [
        "java",
        "multithreading",
        "swing",
        "java-threads"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 34826,
            "user_id": 1273080,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=128&d=identicon&r=PG",
            "display_name": "Petr Janeček",
            "link": "https://stackoverflow.com/users/1273080/petr-jane%c4%8dek"
          },
          "comment_count": 0,
          "score": 9,
          "creation_date": 1615075561,
          "answer_id": 66511961,
          "body_markdown": "Thread cancellation is a cooperative task in Java - the threads need to be programmed to respond to some kind of a cancellation signal. The two most common ways to do this are:\r\n\r\n1. *Interruption*. There is a [`Thread#interrupt()`](https://docs.oracle.com/en/java/javase/15/docs/api/java.base/java/lang/Thread.html#interrupt()) method which is what most JDK methods sensitive to cancellation use. E.g. most blocking methods will detect interruption. Ever seen an `InterruptedException`, e.g. from `Thread.sleep()`? That&#39;s it! The `sleep()` method is blocking, potentially long-running, and cancellable. If the thread is interrupted while sleeping, it will wake up and throw an `InterruptedException`.\r\n\r\n    Upon receiving an interrupt signal, a task should stop what it&#39;s doing and throw an `InterruptedException` which you can catch in the upper layers, log something along the lines of *&quot;Shutting down, bye!&quot;*, ideally reinterrupt the thread and let it die. If you&#39;ve programmed some blocking tasks into your threads, checking `Thread.interrupted()` is one way to handle cancellation.\r\n\r\n2. A flag. If your thread is doing some repetitive work all over again in a loop, that loop can be changed to:\r\n\r\n    ```java\r\n    private volatile boolean shouldContinue = true;\r\n    \r\n    @Override\r\n    public void run() {\r\n        while (shouldContinue) {\r\n            // ...do work.\r\n        }\r\n    }\r\n    \r\n    public void cancelPlease() {\r\n        shouldContinue = false;\r\n    }\r\n    ```\r\n\r\n    ...or something along those lines.\r\n\r\nThe general message is - your runnables need to know they&#39;re cancellable, and they need to cooperate. Whatever you do, do NOT call the [`Thread#stop()`](https://docs.oracle.com/en/java/javase/15/docs/api/java.base/java/lang/Thread.html#stop()) method.",
          "body": "<p>Thread cancellation is a cooperative task in Java - the threads need to be programmed to respond to some kind of a cancellation signal. The two most common ways to do this are:</p>\n<ol>\n<li><p><em>Interruption</em>. There is a <a href=\"https://docs.oracle.com/en/java/javase/15/docs/api/java.base/java/lang/Thread.html#interrupt()\" rel=\"noreferrer\"><code>Thread#interrupt()</code></a> method which is what most JDK methods sensitive to cancellation use. E.g. most blocking methods will detect interruption. Ever seen an <code>InterruptedException</code>, e.g. from <code>Thread.sleep()</code>? That's it! The <code>sleep()</code> method is blocking, potentially long-running, and cancellable. If the thread is interrupted while sleeping, it will wake up and throw an <code>InterruptedException</code>.</p>\n<p>Upon receiving an interrupt signal, a task should stop what it's doing and throw an <code>InterruptedException</code> which you can catch in the upper layers, log something along the lines of <em>&quot;Shutting down, bye!&quot;</em>, ideally reinterrupt the thread and let it die. If you've programmed some blocking tasks into your threads, checking <code>Thread.interrupted()</code> is one way to handle cancellation.</p>\n</li>\n<li><p>A flag. If your thread is doing some repetitive work all over again in a loop, that loop can be changed to:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private volatile boolean shouldContinue = true;\n\n@Override\npublic void run() {\n    while (shouldContinue) {\n        // ...do work.\n    }\n}\n\npublic void cancelPlease() {\n    shouldContinue = false;\n}\n</code></pre>\n<p>...or something along those lines.</p>\n</li>\n</ol>\n<p>The general message is - your runnables need to know they're cancellable, and they need to cooperate. Whatever you do, do NOT call the <a href=\"https://docs.oracle.com/en/java/javase/15/docs/api/java.base/java/lang/Thread.html#stop()\" rel=\"noreferrer\"><code>Thread#stop()</code></a> method.</p>\n"
        }
      ],
      "owner": {
        "reputation": 214,
        "user_id": 9184784,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/317922ece8f6a05b4c4e99aa047781a7?s=128&d=identicon&r=PG&f=1",
        "display_name": "tyb9900",
        "link": "https://stackoverflow.com/users/9184784/tyb9900"
      },
      "comment_count": 0,
      "view_count": 57,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1615074647,
      "question_id": 66511855,
      "body_markdown": "I have an array list of Threads and I want to stop all threads in the list if the cancel button pressed from GUI. Is there any way to stop all these threads?\r\n\r\n    List&lt;Thread&gt; threads = new ArrayList&lt;&gt;();\r\n    EncryptThread encryptThread = null;\r\n    for(int j=0;j&lt;fileEncrytionList.size();j++){\r\n        encryptThread = new EncryptThread();\r\n        encryptThread.setFilePath(fileEncrytionList.get(j));\r\n        encryptThread.setOutPutFile(fileName);\r\n        Thread t = new Thread(encryptThread);\r\n        t.start();\r\n        threads.add(t);\t\r\n    }\r\n\r\n    if(cancel button pressed) // stop all threads from arraylist",
      "title": "Stop List of Threads",
      "body": "<p>I have an array list of Threads and I want to stop all threads in the list if the cancel button pressed from GUI. Is there any way to stop all these threads?</p>\n<pre><code>List&lt;Thread&gt; threads = new ArrayList&lt;&gt;();\nEncryptThread encryptThread = null;\nfor(int j=0;j&lt;fileEncrytionList.size();j++){\n    encryptThread = new EncryptThread();\n    encryptThread.setFilePath(fileEncrytionList.get(j));\n    encryptThread.setOutPutFile(fileName);\n    Thread t = new Thread(encryptThread);\n    t.start();\n    threads.add(t); \n}\n\nif(cancel button pressed) // stop all threads from arraylist\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "apache-spark",
        "kubernetes",
        "sdk",
        "apache-beam"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 189,
            "user_id": 4400443,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/9ShHQ.jpg?s=128&g=1",
            "display_name": "ibzib",
            "link": "https://stackoverflow.com/users/4400443/ibzib"
          },
          "comment_count": 0,
          "score": 0,
          "creation_date": 1615427353,
          "answer_id": 66575381,
          "body_markdown": "1. Using &quot;External&quot; - this definitely seems like a bug in Beam. The worker endpoints are supposed to be set up to use localhost; I don&#39;t think it is possible to configure them. I&#39;m not sure why they would be missing; one educated guess is that the servers silently fail to start, leaving the endpoints empty. I filed a bug report ([BEAM-11957](https://issues.apache.org/jira/browse/BEAM-11957)) for this issue.\r\n2. Using &quot;Process&quot; - The scheme `classpath` corresponds to [ClassLoaderFileSystem](https://github.com/apache/beam/blob/master/sdks/java/core/src/main/java/org/apache/beam/sdk/io/ClassLoaderFileSystem.java). This file system is usually loaded using AutoService, which depends on [ClassLoaderFileSystemRegistrar](https://github.com/apache/beam/blob/1ad764b33d91bc78af54a53babf73b59aede04ad/sdks/java/core/src/main/java/org/apache/beam/sdk/io/ClassLoaderFileSystem.java#L157) being present on the classpath (no relation to the name of the file system itself). The classpath of the job jar is based on `spark_job_server_jar`. Where are you getting your `beam-runners-spark-job-server-2.28.0.jar` from?",
          "body": "<ol>\n<li>Using &quot;External&quot; - this definitely seems like a bug in Beam. The worker endpoints are supposed to be set up to use localhost; I don't think it is possible to configure them. I'm not sure why they would be missing; one educated guess is that the servers silently fail to start, leaving the endpoints empty. I filed a bug report (<a href=\"https://issues.apache.org/jira/browse/BEAM-11957\" rel=\"nofollow noreferrer\">BEAM-11957</a>) for this issue.</li>\n<li>Using &quot;Process&quot; - The scheme <code>classpath</code> corresponds to <a href=\"https://github.com/apache/beam/blob/master/sdks/java/core/src/main/java/org/apache/beam/sdk/io/ClassLoaderFileSystem.java\" rel=\"nofollow noreferrer\">ClassLoaderFileSystem</a>. This file system is usually loaded using AutoService, which depends on <a href=\"https://github.com/apache/beam/blob/1ad764b33d91bc78af54a53babf73b59aede04ad/sdks/java/core/src/main/java/org/apache/beam/sdk/io/ClassLoaderFileSystem.java#L157\" rel=\"nofollow noreferrer\">ClassLoaderFileSystemRegistrar</a> being present on the classpath (no relation to the name of the file system itself). The classpath of the job jar is based on <code>spark_job_server_jar</code>. Where are you getting your <code>beam-runners-spark-job-server-2.28.0.jar</code> from?</li>\n</ol>\n"
        }
      ],
      "owner": {
        "reputation": 85,
        "user_id": 13454548,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/12090c49201880a0d9e6a597db2d44ba?s=128&d=identicon&r=PG&f=1",
        "display_name": "Giovani Merlin",
        "link": "https://stackoverflow.com/users/13454548/giovani-merlin"
      },
      "comment_count": 0,
      "view_count": 42,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1614971091,
      "question_id": 66498209,
      "body_markdown": "# TLDR;\r\nHow to configure Apache Beam pipelines options with &quot;environment_type&quot; = EXTERNAL or PROCESS?\r\n\r\n# Description\r\nCurrently, we have a standalone spark cluster inside Kubernetes, following [this][1] solution (and the setup) we launch a beam pipeline creating an embedded spark job server on the spark worker who needs to run a python SDK jointly.\r\nApache Beam allows running python SDK in [4 different ways][2]:\r\n- &quot;DOCKER&quot; - Default and not possible inside a Kubernetes cluster (would use &quot;container inside container&quot;)\r\n- &quot;LOOPBACK&quot; - Only for testing, not possible with more than 1 worker pod\r\n- &quot;EXTERNAL&quot; - Ideal setup, &quot;just&quot; create a sidecar container to run in the same pod as the spark workers\r\n- &quot;PROCESS&quot; - Execute a process in the spark worker, not ideal but could be too.\r\n\r\n# Development\r\n\r\n1) Using &quot;External&quot; - Implementing the spark worker with the python sdk on the same pod:\r\n```yml\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: spark-worker\r\n  labels:\r\n    app: spark-worker\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: spark-worker\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: spark-worker\r\n    spec:\r\n      containers:\r\n      - name: spark-worker\r\n        image: spark-py-custom:latest\r\n        imagePullPolicy: Never\r\n        ports:\r\n        - containerPort: 8081\r\n          protocol: TCP\r\n        command: [&#39;/bin/bash&#39;,&quot;-c&quot;,&quot;--&quot;]\r\n        args: [&quot;/start-worker.sh&quot; ]\r\n        resources :\r\n          requests :\r\n            cpu : 4\r\n            memory : &quot;5Gi&quot;\r\n          limits :\r\n             cpu : 4\r\n             memory : &quot;5Gi&quot;\r\n        volumeMounts:\r\n          - name: spark-jars\r\n            mountPath: &quot;/tmp&quot;\r\n      - name: python-beam-sdk\r\n        image: apachebeam/python3.7_sdk:latest\r\n        command: [&quot;/opt/apache/beam/boot&quot;, &quot;--worker_pool&quot;]\r\n        ports:\r\n        - containerPort: 50000\r\n        resources:\r\n          limits:\r\n            cpu: &quot;1&quot;\r\n            memory: &quot;1Gi&quot;\r\n      volumes:\r\n        - name: spark-jars\r\n          persistentVolumeClaim:\r\n            claimName: spark-jars\r\n```\r\n\r\nAnd them, if we execute the command \r\n```python\r\npython3 wordcount.py \\\r\n--output ./data_test/counts \\\r\n--runner=SparkRunner \\\r\n--spark_submit_uber_jar \\\r\n--spark_job_server_jar=beam-runners-spark-job-server-2.28.0.jar \\\r\n--spark_master_url=spark://spark-master:7077 \\\r\n--spark_rest_url=http://spark-master:6066 \\\r\n--environment_type=EXTERNAL \\\r\n--environment_config=localhost:50000\r\n``` \r\nWe get a stuck terminal in the state of &quot;RUNNING&quot;:\r\n```\r\nINFO:apache_beam.internal.gcp.auth:Setting socket default timeout to 60 seconds.\r\nINFO:apache_beam.internal.gcp.auth:socket default timeout is 60.0 seconds.\r\nINFO:oauth2client.client:Timeout attempting to reach GCE metadata service.\r\nWARNING:apache_beam.internal.gcp.auth:Unable to find default credentials to use: The Application Default Credentials are not available. They are available if running in Google Compute Engine. Otherwise, the environment variable GOOGLE_APPLICATION_CREDENTIALS must be defined pointing to a file defining the credentials. See https://developers.google.com/accounts/docs/application-default-credentials for more information.\r\nConnecting anonymously.\r\nWARNING:root:Make sure that locally built Python SDK docker image has Python 3.7 interpreter.\r\nINFO:root:Default Python SDK image for environment is apache/beam_python3.7_sdk:2.28.0\r\nINFO:apache_beam.runners.portability.fn_api_runner.translations:==================== &lt;function lift_combiners at 0x7fc360c0b8c8&gt; ====================\r\nINFO:apache_beam.runners.portability.fn_api_runner.translations:==================== &lt;function sort_stages at 0x7fc360c0f048&gt; ====================\r\nINFO:apache_beam.runners.portability.abstract_job_service:Artifact server started on port 36369\r\nINFO:apache_beam.runners.portability.abstract_job_service:Running job &#39;job-2448721e-e686-41d4-b924-5f8c5ae73ac2&#39;\r\nINFO:apache_beam.runners.portability.spark_uber_jar_job_server:Submitted Spark job with ID driver-20210305172421-0000\r\nINFO:apache_beam.runners.portability.portable_runner:Job state changed to STOPPED\r\nINFO:apache_beam.runners.portability.portable_runner:Job state changed to RUNNING\r\n```\r\nAnd in the spark worker log:\r\n```\r\n21/03/05 17:24:25 INFO ExecutorRunner: Launch command: &quot;/usr/local/openjdk-8/bin/java&quot; &quot;-cp&quot; &quot;/opt/spark/conf/:/opt/spark/jars/*&quot; &quot;-Xmx1024M&quot; &quot;-Dspark.driver.port=45203&quot; &quot;org.apache.spark.executor.CoarseGrainedExecutorBackend&quot; &quot;--driver-url&quot; &quot;spark://CoarseGrainedScheduler@spark-worker-64fd4ddd6-tqdrs:45203&quot; &quot;--executor-id&quot; &quot;0&quot; &quot;--hostname&quot; &quot;172.18.0.20&quot; &quot;--cores&quot; &quot;3&quot; &quot;--app-id&quot; &quot;app-20210305172425-0000&quot; &quot;--worker-url&quot; &quot;spark://Worker@172.18.0.20:44365&quot;\r\n```\r\nAnd on the python sdk:\r\n```\r\n2021/03/05 17:19:52 Starting worker pool 1: python -m apache_beam.runners.worker.worker_pool_main --service_port=50000 --container_executable=/opt/apache/beam/boot\r\nStarting worker with command [&#39;/opt/apache/beam/boot&#39;, &#39;--id=1-1&#39;, &#39;--logging_endpoint=&#39;, &#39;--artifact_endpoint=&#39;, &#39;--provision_endpoint=&#39;, &#39;--control_endpoint=&#39;]\r\n2021/03/05 17:24:32 No logging endpoint provided.\r\n```\r\nChecking the spark worker stderr (on localhost 8081):\r\n```\r\nSpark Executor Command: &quot;/usr/local/openjdk-8/bin/java&quot; &quot;-cp&quot; &quot;/opt/spark/conf/:/opt/spark/jars/*&quot; &quot;-Xmx1024M&quot; &quot;-Dspark.driver.port=45203&quot; &quot;org.apache.spark.executor.CoarseGrainedExecutorBackend&quot; &quot;--driver-url&quot; &quot;spark://CoarseGrainedScheduler@spark-worker-64fd4ddd6-tqdrs:45203&quot; &quot;--executor-id&quot; &quot;0&quot; &quot;--hostname&quot; &quot;172.18.0.20&quot; &quot;--cores&quot; &quot;3&quot; &quot;--app-id&quot; &quot;app-20210305172425-0000&quot; &quot;--worker-url&quot; &quot;spark://Worker@172.18.0.20:44365&quot;\r\n========================================\r\n\r\nUsing Spark&#39;s default log4j profile: org/apache/spark/log4j-defaults.properties\r\n21/03/05 17:24:26 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 230@spark-worker-64fd4ddd6-tqdrs\r\n21/03/05 17:24:26 INFO SignalUtils: Registered signal handler for TERM\r\n21/03/05 17:24:26 INFO SignalUtils: Registered signal handler for HUP\r\n21/03/05 17:24:26 INFO SignalUtils: Registered signal handler for INT\r\n21/03/05 17:24:27 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls to: root\r\n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls to: root\r\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls groups to: \r\n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls groups to: \r\n21/03/05 17:24:27 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()\r\n21/03/05 17:24:27 INFO TransportClientFactory: Successfully created connection to spark-worker-64fd4ddd6-tqdrs/172.18.0.20:45203 after 50 ms (0 ms spent in bootstraps)\r\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls to: root\r\n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls to: root\r\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls groups to: \r\n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls groups to: \r\n21/03/05 17:24:27 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()\r\n21/03/05 17:24:28 INFO TransportClientFactory: Successfully created connection to spark-worker-64fd4ddd6-tqdrs/172.18.0.20:45203 after 1 ms (0 ms spent in bootstraps)\r\n21/03/05 17:24:28 INFO DiskBlockManager: Created local directory at /tmp/spark-bdffc2b3-f57a-42fa-a720-e22274b86b67/executor-f1eff7ca-d2cd-4ff4-b18b-c8d6a520f590/blockmgr-c61fb65f-ea97-4bd5-bf15-e0025845a251\r\n21/03/05 17:24:28 INFO MemoryStore: MemoryStore started with capacity 366.3 MB\r\n21/03/05 17:24:28 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@spark-worker-64fd4ddd6-tqdrs:45203\r\n21/03/05 17:24:28 INFO WorkerWatcher: Connecting to worker spark://Worker@172.18.0.20:44365\r\n21/03/05 17:24:28 INFO TransportClientFactory: Successfully created connection to /172.18.0.20:44365 after 1 ms (0 ms spent in bootstraps)\r\n21/03/05 17:24:28 INFO WorkerWatcher: Successfully connected to spark://Worker@172.18.0.20:44365\r\n21/03/05 17:24:28 INFO CoarseGrainedExecutorBackend: Successfully registered with driver\r\n21/03/05 17:24:28 INFO Executor: Starting executor ID 0 on host 172.18.0.20\r\n21/03/05 17:24:28 INFO Utils: Successfully started service &#39;org.apache.spark.network.netty.NettyBlockTransferService&#39; on port 42561.\r\n21/03/05 17:24:28 INFO NettyBlockTransferService: Server created on 172.18.0.20:42561\r\n21/03/05 17:24:28 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy\r\n21/03/05 17:24:28 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(0, 172.18.0.20, 42561, None)\r\n21/03/05 17:24:28 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(0, 172.18.0.20, 42561, None)\r\n21/03/05 17:24:28 INFO BlockManager: Initialized BlockManager: BlockManagerId(0, 172.18.0.20, 42561, None)\r\n```\r\nWhere it gets stuck forever.\r\nChecking the [source code][2] of the python SDK we can see that &quot;no logging endpoint provided&quot; is fatal and it comes from the lack of configuration sent to him (no logging/artifact/provision/control endpoints). If I try to add the &quot;--artifact_endpoint&quot; to the python command I get grcp error of failed communication because the jobserver creates its own artifact endpoint. In this setup would be necessary to configure all these endpoints (probably as localhost as the SDK and the worker are in the same pod) with fixed ports but I can&#39;t find how to configure it. Checking SO I can find a related [issue][3] but in his case he gets the python SDK configurations automatically (maybe a spark runner issue?)\r\n\r\n2) Using &quot;PROCESS&quot; - Trying to run the python SDK within a process, I built the python SDK with `./gradlew :sdks:python:container:py37:docker`, copied the sdks/python/container/build/target/launcher/linux_amd64/boot executable to /python_sdk/boot inside the spark worker container and used the command:\r\n```python\r\npython3 wordcount.py \\\r\n--output ./data_test/counts \\\r\n--runner=SparkRunner \\\r\n--spark_submit_uber_jar \\\r\n--spark_master_url=spark://spark-master:7077 \\\r\n--spark_rest_url=http://spark-master:6066 \\\r\n--environment_type=PROCESS \\\r\n--spark_job_server_jar=beam-runners-spark-job-server-2.28.0.jar \\\r\n--environment_config=&#39;{&quot;os&quot;:&quot;linux&quot;,&quot;arch&quot;:&quot;x84_64&quot;,&quot;command&quot;:&quot;/python_sdk/boot&quot;}&#39;\r\n```\r\nResulting in &quot;run time exception&quot; in the terminal:\r\n```python\r\nINFO:apache_beam.runners.portability.portable_runner:Job state changed to FAILED\r\nTraceback (most recent call last):\r\n  File &quot;wordcount.py&quot;, line 91, in &lt;module&gt;\r\n    run()\r\n  File &quot;wordcount.py&quot;, line 86, in run\r\n    output | &quot;Write&quot; &gt;&gt; WriteToText(known_args.output)\r\n  File &quot;/usr/local/lib/python3.7/dist-packages/apache_beam/pipeline.py&quot;, line 581, in __exit__\r\n    self.result.wait_until_finish()\r\n  File &quot;/usr/local/lib/python3.7/dist-packages/apache_beam/runners/portability/portable_runner.py&quot;, line 608, in wait_until_finish\r\n    raise self._runtime_exception\r\nRuntimeError: Pipeline job-95c13aa5-96ab-4d1d-bc68-7f9d203c8251 failed in state FAILED: unknown error\r\n```\r\nand checking again the spark stderr worker log I can see that the problem is `java.lang.IllegalArgumentException: No filesystem found for scheme classpath` which I don&#39;t know the reason.\r\n```\r\n21/03/05 18:33:12 INFO Executor: Adding file:/opt/spark/work/app-20210305183309-0000/0/./javax.servlet-api-3.1.0.jar to class loader\r\n21/03/05 18:33:12 INFO TorrentBroadcast: Started reading broadcast variable 0\r\n21/03/05 18:33:12 INFO TransportClientFactory: Successfully created connection to spark-worker-89c5c4c87-5q45s/172.18.0.20:34783 after 1 ms (0 ms spent in bootstraps)\r\n21/03/05 18:33:12 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 12.3 KB, free 366.3 MB)\r\n21/03/05 18:33:12 INFO TorrentBroadcast: Reading broadcast variable 0 took 63 ms\r\n21/03/05 18:33:12 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 32.5 KB, free 366.3 MB)\r\n21/03/05 18:33:13 INFO MemoryStore: Block rdd_13_0 stored as values in memory (estimated size 16.0 B, free 366.3 MB)\r\n21/03/05 18:33:13 INFO MemoryStore: Block rdd_17_0 stored as values in memory (estimated size 16.0 B, free 366.3 MB)\r\n21/03/05 18:33:13 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 5427 bytes result sent to driver\r\n21/03/05 18:33:14 ERROR SerializingExecutor: Exception while executing runnable org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed@5f917914\r\njava.lang.IllegalArgumentException: No filesystem found for scheme classpath\r\n\tat org.apache.beam.sdk.io.FileSystems.getFileSystemInternal(FileSystems.java:467)\r\n\tat org.apache.beam.sdk.io.FileSystems.matchNewResource(FileSystems.java:537)\r\n\tat org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:125)\r\n\tat org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:99)\r\n\tat org.apache.beam.model.jobmanagement.v1.ArtifactRetrievalServiceGrpc$MethodHandlers.invoke(ArtifactRetrievalServiceGrpc.java:327)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:817)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n21/03/05 18:33:16 ERROR SerializingExecutor: Exception while executing runnable org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed@67fb2b2c\r\njava.lang.IllegalArgumentException: No filesystem found for scheme classpath\r\n\tat org.apache.beam.sdk.io.FileSystems.getFileSystemInternal(FileSystems.java:467)\r\n\tat org.apache.beam.sdk.io.FileSystems.matchNewResource(FileSystems.java:537)\r\n\tat org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:125)\r\n\tat org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:99)\r\n\tat org.apache.beam.model.jobmanagement.v1.ArtifactRetrievalServiceGrpc$MethodHandlers.invoke(ArtifactRetrievalServiceGrpc.java:327)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:817)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\r\n\tat org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n21/03/05 18:33:19 INFO ProcessEnvironmentFactory: Still waiting for startup of environment &#39;/python_sdk/boot&#39; for worker id 1-1\r\n```\r\nProbably is missing some configuration parameters.\r\n## Obs\r\n\r\nIf I execute the command \r\n```python\r\npython3 wordcount.py \\\r\n--output ./data_test/counts \\\r\n--runner=SparkRunner \\\r\n--spark_submit_uber_jar \\\r\n--spark_job_server_jar=beam-runners-spark-job-server-2.28.0.jar \\\r\n--spark_master_url=spark://spark-master:7077 \\\r\n--spark_rest_url=http://spark-master:6066 \\\r\n--environment_type=LOOPBACK\r\n``` \r\ninside our spark worker (having only one worker in the spark cluster) we have a full working beam pipeline with [these][4] logs.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/66320831/its-possible-to-configure-the-beam-portable-runner-with-the-spark-configuration\r\n  [2]: https://github.com/apache/beam/blob/master/sdks/python/container/boot.go\r\n  [3]: https://stackoverflow.com/questions/60411012/running-apache-beam-python-pipelines-in-kubernetes\r\n  [4]: https://pastebin.com/ScuYSmyr",
      "title": "How to configure beam python sdk with spark in a kubernetes environment",
      "body": "<h1>TLDR;</h1>\n<p>How to configure Apache Beam pipelines options with &quot;environment_type&quot; = EXTERNAL or PROCESS?</p>\n<h1>Description</h1>\n<p>Currently, we have a standalone spark cluster inside Kubernetes, following <a href=\"https://stackoverflow.com/questions/66320831/its-possible-to-configure-the-beam-portable-runner-with-the-spark-configuration\">this</a> solution (and the setup) we launch a beam pipeline creating an embedded spark job server on the spark worker who needs to run a python SDK jointly.\nApache Beam allows running python SDK in <a href=\"https://github.com/apache/beam/blob/master/sdks/python/container/boot.go\" rel=\"nofollow noreferrer\">4 different ways</a>:</p>\n<ul>\n<li>&quot;DOCKER&quot; - Default and not possible inside a Kubernetes cluster (would use &quot;container inside container&quot;)</li>\n<li>&quot;LOOPBACK&quot; - Only for testing, not possible with more than 1 worker pod</li>\n<li>&quot;EXTERNAL&quot; - Ideal setup, &quot;just&quot; create a sidecar container to run in the same pod as the spark workers</li>\n<li>&quot;PROCESS&quot; - Execute a process in the spark worker, not ideal but could be too.</li>\n</ul>\n<h1>Development</h1>\n<ol>\n<li>Using &quot;External&quot; - Implementing the spark worker with the python sdk on the same pod:</li>\n</ol>\n<pre class=\"lang-yaml prettyprint-override\"><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: spark-worker\n  labels:\n    app: spark-worker\nspec:\n  selector:\n    matchLabels:\n      app: spark-worker\n  template:\n    metadata:\n      labels:\n        app: spark-worker\n    spec:\n      containers:\n      - name: spark-worker\n        image: spark-py-custom:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 8081\n          protocol: TCP\n        command: ['/bin/bash',&quot;-c&quot;,&quot;--&quot;]\n        args: [&quot;/start-worker.sh&quot; ]\n        resources :\n          requests :\n            cpu : 4\n            memory : &quot;5Gi&quot;\n          limits :\n             cpu : 4\n             memory : &quot;5Gi&quot;\n        volumeMounts:\n          - name: spark-jars\n            mountPath: &quot;/tmp&quot;\n      - name: python-beam-sdk\n        image: apachebeam/python3.7_sdk:latest\n        command: [&quot;/opt/apache/beam/boot&quot;, &quot;--worker_pool&quot;]\n        ports:\n        - containerPort: 50000\n        resources:\n          limits:\n            cpu: &quot;1&quot;\n            memory: &quot;1Gi&quot;\n      volumes:\n        - name: spark-jars\n          persistentVolumeClaim:\n            claimName: spark-jars\n</code></pre>\n<p>And them, if we execute the command</p>\n<pre class=\"lang-py prettyprint-override\"><code>python3 wordcount.py \\\n--output ./data_test/counts \\\n--runner=SparkRunner \\\n--spark_submit_uber_jar \\\n--spark_job_server_jar=beam-runners-spark-job-server-2.28.0.jar \\\n--spark_master_url=spark://spark-master:7077 \\\n--spark_rest_url=http://spark-master:6066 \\\n--environment_type=EXTERNAL \\\n--environment_config=localhost:50000\n</code></pre>\n<p>We get a stuck terminal in the state of &quot;RUNNING&quot;:</p>\n<pre><code>INFO:apache_beam.internal.gcp.auth:Setting socket default timeout to 60 seconds.\nINFO:apache_beam.internal.gcp.auth:socket default timeout is 60.0 seconds.\nINFO:oauth2client.client:Timeout attempting to reach GCE metadata service.\nWARNING:apache_beam.internal.gcp.auth:Unable to find default credentials to use: The Application Default Credentials are not available. They are available if running in Google Compute Engine. Otherwise, the environment variable GOOGLE_APPLICATION_CREDENTIALS must be defined pointing to a file defining the credentials. See https://developers.google.com/accounts/docs/application-default-credentials for more information.\nConnecting anonymously.\nWARNING:root:Make sure that locally built Python SDK docker image has Python 3.7 interpreter.\nINFO:root:Default Python SDK image for environment is apache/beam_python3.7_sdk:2.28.0\nINFO:apache_beam.runners.portability.fn_api_runner.translations:==================== &lt;function lift_combiners at 0x7fc360c0b8c8&gt; ====================\nINFO:apache_beam.runners.portability.fn_api_runner.translations:==================== &lt;function sort_stages at 0x7fc360c0f048&gt; ====================\nINFO:apache_beam.runners.portability.abstract_job_service:Artifact server started on port 36369\nINFO:apache_beam.runners.portability.abstract_job_service:Running job 'job-2448721e-e686-41d4-b924-5f8c5ae73ac2'\nINFO:apache_beam.runners.portability.spark_uber_jar_job_server:Submitted Spark job with ID driver-20210305172421-0000\nINFO:apache_beam.runners.portability.portable_runner:Job state changed to STOPPED\nINFO:apache_beam.runners.portability.portable_runner:Job state changed to RUNNING\n</code></pre>\n<p>And in the spark worker log:</p>\n<pre><code>21/03/05 17:24:25 INFO ExecutorRunner: Launch command: &quot;/usr/local/openjdk-8/bin/java&quot; &quot;-cp&quot; &quot;/opt/spark/conf/:/opt/spark/jars/*&quot; &quot;-Xmx1024M&quot; &quot;-Dspark.driver.port=45203&quot; &quot;org.apache.spark.executor.CoarseGrainedExecutorBackend&quot; &quot;--driver-url&quot; &quot;spark://CoarseGrainedScheduler@spark-worker-64fd4ddd6-tqdrs:45203&quot; &quot;--executor-id&quot; &quot;0&quot; &quot;--hostname&quot; &quot;172.18.0.20&quot; &quot;--cores&quot; &quot;3&quot; &quot;--app-id&quot; &quot;app-20210305172425-0000&quot; &quot;--worker-url&quot; &quot;spark://Worker@172.18.0.20:44365&quot;\n</code></pre>\n<p>And on the python sdk:</p>\n<pre><code>2021/03/05 17:19:52 Starting worker pool 1: python -m apache_beam.runners.worker.worker_pool_main --service_port=50000 --container_executable=/opt/apache/beam/boot\nStarting worker with command ['/opt/apache/beam/boot', '--id=1-1', '--logging_endpoint=', '--artifact_endpoint=', '--provision_endpoint=', '--control_endpoint=']\n2021/03/05 17:24:32 No logging endpoint provided.\n</code></pre>\n<p>Checking the spark worker stderr (on localhost 8081):</p>\n<pre><code>Spark Executor Command: &quot;/usr/local/openjdk-8/bin/java&quot; &quot;-cp&quot; &quot;/opt/spark/conf/:/opt/spark/jars/*&quot; &quot;-Xmx1024M&quot; &quot;-Dspark.driver.port=45203&quot; &quot;org.apache.spark.executor.CoarseGrainedExecutorBackend&quot; &quot;--driver-url&quot; &quot;spark://CoarseGrainedScheduler@spark-worker-64fd4ddd6-tqdrs:45203&quot; &quot;--executor-id&quot; &quot;0&quot; &quot;--hostname&quot; &quot;172.18.0.20&quot; &quot;--cores&quot; &quot;3&quot; &quot;--app-id&quot; &quot;app-20210305172425-0000&quot; &quot;--worker-url&quot; &quot;spark://Worker@172.18.0.20:44365&quot;\n========================================\n\nUsing Spark's default log4j profile: org/apache/spark/log4j-defaults.properties\n21/03/05 17:24:26 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 230@spark-worker-64fd4ddd6-tqdrs\n21/03/05 17:24:26 INFO SignalUtils: Registered signal handler for TERM\n21/03/05 17:24:26 INFO SignalUtils: Registered signal handler for HUP\n21/03/05 17:24:26 INFO SignalUtils: Registered signal handler for INT\n21/03/05 17:24:27 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls to: root\n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls to: root\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls groups to: \n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls groups to: \n21/03/05 17:24:27 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()\n21/03/05 17:24:27 INFO TransportClientFactory: Successfully created connection to spark-worker-64fd4ddd6-tqdrs/172.18.0.20:45203 after 50 ms (0 ms spent in bootstraps)\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls to: root\n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls to: root\n21/03/05 17:24:27 INFO SecurityManager: Changing view acls groups to: \n21/03/05 17:24:27 INFO SecurityManager: Changing modify acls groups to: \n21/03/05 17:24:27 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()\n21/03/05 17:24:28 INFO TransportClientFactory: Successfully created connection to spark-worker-64fd4ddd6-tqdrs/172.18.0.20:45203 after 1 ms (0 ms spent in bootstraps)\n21/03/05 17:24:28 INFO DiskBlockManager: Created local directory at /tmp/spark-bdffc2b3-f57a-42fa-a720-e22274b86b67/executor-f1eff7ca-d2cd-4ff4-b18b-c8d6a520f590/blockmgr-c61fb65f-ea97-4bd5-bf15-e0025845a251\n21/03/05 17:24:28 INFO MemoryStore: MemoryStore started with capacity 366.3 MB\n21/03/05 17:24:28 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@spark-worker-64fd4ddd6-tqdrs:45203\n21/03/05 17:24:28 INFO WorkerWatcher: Connecting to worker spark://Worker@172.18.0.20:44365\n21/03/05 17:24:28 INFO TransportClientFactory: Successfully created connection to /172.18.0.20:44365 after 1 ms (0 ms spent in bootstraps)\n21/03/05 17:24:28 INFO WorkerWatcher: Successfully connected to spark://Worker@172.18.0.20:44365\n21/03/05 17:24:28 INFO CoarseGrainedExecutorBackend: Successfully registered with driver\n21/03/05 17:24:28 INFO Executor: Starting executor ID 0 on host 172.18.0.20\n21/03/05 17:24:28 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42561.\n21/03/05 17:24:28 INFO NettyBlockTransferService: Server created on 172.18.0.20:42561\n21/03/05 17:24:28 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy\n21/03/05 17:24:28 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(0, 172.18.0.20, 42561, None)\n21/03/05 17:24:28 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(0, 172.18.0.20, 42561, None)\n21/03/05 17:24:28 INFO BlockManager: Initialized BlockManager: BlockManagerId(0, 172.18.0.20, 42561, None)\n</code></pre>\n<p>Where it gets stuck forever.\nChecking the <a href=\"https://github.com/apache/beam/blob/master/sdks/python/container/boot.go\" rel=\"nofollow noreferrer\">source code</a> of the python SDK we can see that &quot;no logging endpoint provided&quot; is fatal and it comes from the lack of configuration sent to him (no logging/artifact/provision/control endpoints). If I try to add the &quot;--artifact_endpoint&quot; to the python command I get grcp error of failed communication because the jobserver creates its own artifact endpoint. In this setup would be necessary to configure all these endpoints (probably as localhost as the SDK and the worker are in the same pod) with fixed ports but I can't find how to configure it. Checking SO I can find a related <a href=\"https://stackoverflow.com/questions/60411012/running-apache-beam-python-pipelines-in-kubernetes\">issue</a> but in his case he gets the python SDK configurations automatically (maybe a spark runner issue?)</p>\n<ol start=\"2\">\n<li>Using &quot;PROCESS&quot; - Trying to run the python SDK within a process, I built the python SDK with <code>./gradlew :sdks:python:container:py37:docker</code>, copied the sdks/python/container/build/target/launcher/linux_amd64/boot executable to /python_sdk/boot inside the spark worker container and used the command:</li>\n</ol>\n<pre class=\"lang-py prettyprint-override\"><code>python3 wordcount.py \\\n--output ./data_test/counts \\\n--runner=SparkRunner \\\n--spark_submit_uber_jar \\\n--spark_master_url=spark://spark-master:7077 \\\n--spark_rest_url=http://spark-master:6066 \\\n--environment_type=PROCESS \\\n--spark_job_server_jar=beam-runners-spark-job-server-2.28.0.jar \\\n--environment_config='{&quot;os&quot;:&quot;linux&quot;,&quot;arch&quot;:&quot;x84_64&quot;,&quot;command&quot;:&quot;/python_sdk/boot&quot;}'\n</code></pre>\n<p>Resulting in &quot;run time exception&quot; in the terminal:</p>\n<pre class=\"lang-py prettyprint-override\"><code>INFO:apache_beam.runners.portability.portable_runner:Job state changed to FAILED\nTraceback (most recent call last):\n  File &quot;wordcount.py&quot;, line 91, in &lt;module&gt;\n    run()\n  File &quot;wordcount.py&quot;, line 86, in run\n    output | &quot;Write&quot; &gt;&gt; WriteToText(known_args.output)\n  File &quot;/usr/local/lib/python3.7/dist-packages/apache_beam/pipeline.py&quot;, line 581, in __exit__\n    self.result.wait_until_finish()\n  File &quot;/usr/local/lib/python3.7/dist-packages/apache_beam/runners/portability/portable_runner.py&quot;, line 608, in wait_until_finish\n    raise self._runtime_exception\nRuntimeError: Pipeline job-95c13aa5-96ab-4d1d-bc68-7f9d203c8251 failed in state FAILED: unknown error\n</code></pre>\n<p>and checking again the spark stderr worker log I can see that the problem is <code>java.lang.IllegalArgumentException: No filesystem found for scheme classpath</code> which I don't know the reason.</p>\n<pre><code>21/03/05 18:33:12 INFO Executor: Adding file:/opt/spark/work/app-20210305183309-0000/0/./javax.servlet-api-3.1.0.jar to class loader\n21/03/05 18:33:12 INFO TorrentBroadcast: Started reading broadcast variable 0\n21/03/05 18:33:12 INFO TransportClientFactory: Successfully created connection to spark-worker-89c5c4c87-5q45s/172.18.0.20:34783 after 1 ms (0 ms spent in bootstraps)\n21/03/05 18:33:12 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 12.3 KB, free 366.3 MB)\n21/03/05 18:33:12 INFO TorrentBroadcast: Reading broadcast variable 0 took 63 ms\n21/03/05 18:33:12 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 32.5 KB, free 366.3 MB)\n21/03/05 18:33:13 INFO MemoryStore: Block rdd_13_0 stored as values in memory (estimated size 16.0 B, free 366.3 MB)\n21/03/05 18:33:13 INFO MemoryStore: Block rdd_17_0 stored as values in memory (estimated size 16.0 B, free 366.3 MB)\n21/03/05 18:33:13 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 5427 bytes result sent to driver\n21/03/05 18:33:14 ERROR SerializingExecutor: Exception while executing runnable org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed@5f917914\njava.lang.IllegalArgumentException: No filesystem found for scheme classpath\n    at org.apache.beam.sdk.io.FileSystems.getFileSystemInternal(FileSystems.java:467)\n    at org.apache.beam.sdk.io.FileSystems.matchNewResource(FileSystems.java:537)\n    at org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:125)\n    at org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:99)\n    at org.apache.beam.model.jobmanagement.v1.ArtifactRetrievalServiceGrpc$MethodHandlers.invoke(ArtifactRetrievalServiceGrpc.java:327)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:817)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n    at java.lang.Thread.run(Thread.java:748)\n21/03/05 18:33:16 ERROR SerializingExecutor: Exception while executing runnable org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed@67fb2b2c\njava.lang.IllegalArgumentException: No filesystem found for scheme classpath\n    at org.apache.beam.sdk.io.FileSystems.getFileSystemInternal(FileSystems.java:467)\n    at org.apache.beam.sdk.io.FileSystems.matchNewResource(FileSystems.java:537)\n    at org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:125)\n    at org.apache.beam.runners.fnexecution.artifact.ArtifactRetrievalService.getArtifact(ArtifactRetrievalService.java:99)\n    at org.apache.beam.model.jobmanagement.v1.ArtifactRetrievalServiceGrpc$MethodHandlers.invoke(ArtifactRetrievalServiceGrpc.java:327)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.Contexts$ContextualizedServerCallListener.onHalfClose(Contexts.java:86)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:817)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n    at org.apache.beam.vendor.grpc.v1p26p0.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n    at java.lang.Thread.run(Thread.java:748)\n21/03/05 18:33:19 INFO ProcessEnvironmentFactory: Still waiting for startup of environment '/python_sdk/boot' for worker id 1-1\n</code></pre>\n<p>Probably is missing some configuration parameters.</p>\n<h2>Obs</h2>\n<p>If I execute the command</p>\n<pre class=\"lang-py prettyprint-override\"><code>python3 wordcount.py \\\n--output ./data_test/counts \\\n--runner=SparkRunner \\\n--spark_submit_uber_jar \\\n--spark_job_server_jar=beam-runners-spark-job-server-2.28.0.jar \\\n--spark_master_url=spark://spark-master:7077 \\\n--spark_rest_url=http://spark-master:6066 \\\n--environment_type=LOOPBACK\n</code></pre>\n<p>inside our spark worker (having only one worker in the spark cluster) we have a full working beam pipeline with <a href=\"https://pastebin.com/ScuYSmyr\" rel=\"nofollow noreferrer\">these</a> logs.</p>\n"
    },
    {
      "tags": [
        "java",
        "bytecode",
        "byte-buddy",
        "bytecode-manipulation"
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 70524,
                "user_id": 18122,
                "user_type": "registered",
                "accept_rate": 80,
                "profile_image": "https://i.stack.imgur.com/q5nPT.jpg?s=128&g=1",
                "display_name": "Oliver Drotbohm",
                "link": "https://stackoverflow.com/users/18122/oliver-drotbohm"
              },
              "score": 1,
              "creation_date": 1615221052,
              "post_id": 66518508,
              "comment_id": 117618205,
              "body_markdown": "Pretty embarrassing. I have an advice to init a boolean field to `true` and reused that when I actually want the method to be intercepted to flip that flag to `false`. My tests *of course* saw that flag still being `true`. &#129318;&#127996;‍♂️ SO everything works as expected. Thanks for the sample, that actually made me realize my (rather stupid) mistake.",
              "body": "Pretty embarrassing. I have an advice to init a boolean field to <code>true</code> and reused that when I actually want the method to be intercepted to flip that flag to <code>false</code>. My tests <i>of course</i> saw that flag still being <code>true</code>. 🤦🏼‍♂️ SO everything works as expected. Thanks for the sample, that actually made me realize my (rather stupid) mistake."
            },
            {
              "owner": {
                "reputation": 37706,
                "user_id": 1237575,
                "user_type": "registered",
                "accept_rate": 96,
                "profile_image": "https://www.gravatar.com/avatar/bc96521f79789d75fa63cfa5c2758765?s=128&d=identicon&r=PG",
                "display_name": "Rafael Winterhalter",
                "link": "https://stackoverflow.com/users/1237575/rafael-winterhalter"
              },
              "score": 0,
              "creation_date": 1615236780,
              "post_id": 66518508,
              "comment_id": 117624439,
              "body_markdown": "That&#39;s what SO is here for! Glad you figured it out!",
              "body": "That&#39;s what SO is here for! Glad you figured it out!"
            }
          ],
          "owner": {
            "reputation": 37706,
            "user_id": 1237575,
            "user_type": "registered",
            "accept_rate": 96,
            "profile_image": "https://www.gravatar.com/avatar/bc96521f79789d75fa63cfa5c2758765?s=128&d=identicon&r=PG",
            "display_name": "Rafael Winterhalter",
            "link": "https://stackoverflow.com/users/1237575/rafael-winterhalter"
          },
          "comment_count": 2,
          "score": 1,
          "creation_date": 1615132964,
          "answer_id": 66518508,
          "body_markdown": "Can you share a reconstruction of your example? In a simple example, I observe the expected behavior:\r\n\r\n    public class Bar {\r\n      public static void main(String[] args) throws Exception {\r\n        Class&lt;?&gt; type = new ByteBuddy().subclass(Object.class)\r\n          .visit(Advice.to(Bar.class).on(named(&quot;m&quot;)))\r\n          .defineMethod(&quot;m&quot;, void.class, Visibility.PUBLIC)\r\n          .intercept(MethodDelegation.to(Bar.class))\r\n          .make()\r\n          .load(Bar.class.getClassLoader(), ClassLoadingStrategy.Default.WRAPPER)\r\n          .getLoaded();\r\n\r\n        type.getMethod(&quot;m&quot;).invoke(type.getConstructor().newInstance());\r\n      }\r\n\r\n      @BindingPriority(2)\r\n      public static void delegation() {\r\n        System.out.println(&quot;Delegation!&quot;);\r\n      }\r\n\r\n      @Advice.OnMethodEnter\r\n      public static void enter() {\r\n        System.out.println(&quot;Advice!&quot;);\r\n      }\r\n    }\r\n\r\nThis example prints both *Advice!* and *Delegation!*.",
          "body": "<p>Can you share a reconstruction of your example? In a simple example, I observe the expected behavior:</p>\n<pre><code>public class Bar {\n  public static void main(String[] args) throws Exception {\n    Class&lt;?&gt; type = new ByteBuddy().subclass(Object.class)\n      .visit(Advice.to(Bar.class).on(named(&quot;m&quot;)))\n      .defineMethod(&quot;m&quot;, void.class, Visibility.PUBLIC)\n      .intercept(MethodDelegation.to(Bar.class))\n      .make()\n      .load(Bar.class.getClassLoader(), ClassLoadingStrategy.Default.WRAPPER)\n      .getLoaded();\n\n    type.getMethod(&quot;m&quot;).invoke(type.getConstructor().newInstance());\n  }\n\n  @BindingPriority(2)\n  public static void delegation() {\n    System.out.println(&quot;Delegation!&quot;);\n  }\n\n  @Advice.OnMethodEnter\n  public static void enter() {\n    System.out.println(&quot;Advice!&quot;);\n  }\n}\n</code></pre>\n<p>This example prints both <em>Advice!</em> and <em>Delegation!</em>.</p>\n"
        }
      ],
      "owner": {
        "reputation": 70524,
        "user_id": 18122,
        "user_type": "registered",
        "accept_rate": 80,
        "profile_image": "https://i.stack.imgur.com/q5nPT.jpg?s=128&g=1",
        "display_name": "Oliver Drotbohm",
        "link": "https://stackoverflow.com/users/18122/oliver-drotbohm"
      },
      "comment_count": 0,
      "view_count": 28,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1614935118,
      "question_id": 66489614,
      "body_markdown": "## Context\r\n\r\nI am implementing byte code transformations with ByteBuddy and the process of manipulation is a multi step process.\r\nBecause of that, the manipulation has to be able to:\r\n\r\n1. augment originally existing methods\r\n2. create new methods entirely \r\n3. augment a method that was introduced via 2.\r\n\r\nFor 1. I used an `@OnMethodExit` advice applied via:\r\n\r\n    Builder&lt;?&gt; builder = builder.visit(Advice.to(Helper.class)\r\n      .on(ElementMatchers.hasMethodNamed(name));\r\n\r\nwith `Helper` the augmentation code for the method (effectively setting a field&#39;s value).\r\nWhen creating new methods, I build them as follows:\r\n\r\n    Builder&lt;?&gt; builder = builder.defineMethod(…)\r\n      .intercept(MethodDelegation.to(OtherHelper.class));\r\n      .…;\r\n\r\n`OtherHelper` consumes the runtime instance via a static method taking `@This Object object` as argument.\r\n\r\n## The problem\r\n\r\nIn short: I don&#39;t see the *former* transformation applied if it follows the latter.\r\nThe actual execution order is as follows:\r\n\r\n1. My type gets processed and a method added via `MethodDelegation.…`.\r\n2. In a subsequent step I find that newly introduced method and try to augment the implementation generation through `Advice.to(…)` using an `@OnMethodExit` advice.\r\n3. The resulting code has the behavior of step 1 but is lacking the behavior of step 2.\r\n\r\nI am assuming I invalidly combine the two parts of the implementation. Any ideas? A hunch: does the `ElementMatcher` matching the augmentation by name not see the method introduced using `….defineMethod(…)` yet? The `name` is coming from some method inspection I start from `builder.toTypeDescription()` which actually makes me assume that the to-be-created method is already visible to the builder as otherwise it wouldn&#39;t be found in that step in the first place.",
      "title": "How to augment methods during ByteBuddy transformation?",
      "body": "<h2>Context</h2>\n<p>I am implementing byte code transformations with ByteBuddy and the process of manipulation is a multi step process.\nBecause of that, the manipulation has to be able to:</p>\n<ol>\n<li>augment originally existing methods</li>\n<li>create new methods entirely</li>\n<li>augment a method that was introduced via 2.</li>\n</ol>\n<p>For 1. I used an <code>@OnMethodExit</code> advice applied via:</p>\n<pre><code>Builder&lt;?&gt; builder = builder.visit(Advice.to(Helper.class)\n  .on(ElementMatchers.hasMethodNamed(name));\n</code></pre>\n<p>with <code>Helper</code> the augmentation code for the method (effectively setting a field's value).\nWhen creating new methods, I build them as follows:</p>\n<pre><code>Builder&lt;?&gt; builder = builder.defineMethod(…)\n  .intercept(MethodDelegation.to(OtherHelper.class));\n  .…;\n</code></pre>\n<p><code>OtherHelper</code> consumes the runtime instance via a static method taking <code>@This Object object</code> as argument.</p>\n<h2>The problem</h2>\n<p>In short: I don't see the <em>former</em> transformation applied if it follows the latter.\nThe actual execution order is as follows:</p>\n<ol>\n<li>My type gets processed and a method added via <code>MethodDelegation.…</code>.</li>\n<li>In a subsequent step I find that newly introduced method and try to augment the implementation generation through <code>Advice.to(…)</code> using an <code>@OnMethodExit</code> advice.</li>\n<li>The resulting code has the behavior of step 1 but is lacking the behavior of step 2.</li>\n</ol>\n<p>I am assuming I invalidly combine the two parts of the implementation. Any ideas? A hunch: does the <code>ElementMatcher</code> matching the augmentation by name not see the method introduced using <code>….defineMethod(…)</code> yet? The <code>name</code> is coming from some method inspection I start from <code>builder.toTypeDescription()</code> which actually makes me assume that the to-be-created method is already visible to the builder as otherwise it wouldn't be found in that step in the first place.</p>\n"
    },
    {
      "tags": [
        "java",
        "maven",
        "openjpa",
        "openjpa-maven-plugin",
        "byte-code-enhancement"
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 368,
                "user_id": 10524503,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-TTMbFydM2wc/AAAAAAAAAAI/AAAAAAAAIbU/tMY5KezwBbg/photo.jpg?sz=128",
                "display_name": "Wortig",
                "link": "https://stackoverflow.com/users/10524503/wortig"
              },
              "score": 0,
              "creation_date": 1615060757,
              "post_id": 66506036,
              "comment_id": 117577170,
              "body_markdown": "I tried to `mvn package` from the command line, however output is same - same .jar file with same .class files. I guess that enhance goal might be somehow skipped during process-classes step or `&lt;includes&gt;` path is really wrong.",
              "body": "I tried to <code>mvn package</code> from the command line, however output is same - same .jar file with same .class files. I guess that enhance goal might be somehow skipped during process-classes step or <code>&lt;includes&gt;</code> path is really wrong."
            }
          ],
          "owner": {
            "reputation": 64174,
            "user_id": 302139,
            "user_type": "registered",
            "accept_rate": 75,
            "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG",
            "display_name": "Edwin Buck",
            "link": "https://stackoverflow.com/users/302139/edwin-buck"
          },
          "comment_count": 1,
          "score": 1,
          "creation_date": 1615036578,
          "answer_id": 66506036,
          "body_markdown": "A few misundestandings.\r\n\r\n&gt;    I have tried using only openjpa-maven-plugin without maven-compiler-plugin, but it did not help.\r\n\r\nMaven&#39;s pom.xml is considered a &quot;project object model&quot;  That means, for your &quot;project&quot; it is the &quot;object&quot; that &quot;models&quot; the build process.  This object is sub-classed from a &quot;parent pom.xml&quot; that is embedded inside of Maven, which defines a default build; so, if you remove the &quot;maven-compiler-plugin&quot; you will get the default &quot;maven-compiler-plugin&quot; configuration.  Odds are that configuration is quite old, being shipped with Maven, and you probably are better off including an &quot;override&quot; which brings it up to date.\r\n\r\n&lt;h1&gt;Eclipse and Maven&lt;/h1&gt;\r\n\r\nEclpise and Maven work together; but, until you know how they work together, you will have a lot of problems.\r\n\r\nEclipse reads the `pom.xml` file and generates a `Eclipse configuration` that should perform the same steps as the `pom.xml` file, in the same ways.  When you compile with Eclipse, it doesn&#39;t run `mvn compile`, it builds off of the Eclipse configuration, which might be older than the recently edited `pom.xml`.  For this reason, you should reread your project configuration after every edit of `pom.xml` when using ecplise.\r\n\r\nIf you want to look at a different IDE that is similar to Eclipse; but, one that calls `mvn compile` instead of calling it&#39;s own interperted version of &quot;should be the same, but often isn&#39;t&quot;, look at NetBeans. https://netbeans.apache.org/download/nb122/index.html  Unlike Ecplipse, it doesn&#39;t contain its own &quot;mirror image of commands&quot; for Maven plugins (or its own embedded compiler), it uses the `mvn` command and the `javac` compiler and launches them with configurations to generate a lot of output messages, which it then reads to update it&#39;s &quot;IDE side&quot; of things.\r\n\r\nThe reason I point this out, is because you might be following the instructions, and if you are, you might be seeing correct output on a `mvn package` from the command line, but not within Eclipse (because of the need to refresh the eclipse project from the source `pom.xml`)\r\n\r\n",
          "body": "<p>A few misundestandings.</p>\n<blockquote>\n<p>I have tried using only openjpa-maven-plugin without maven-compiler-plugin, but it did not help.</p>\n</blockquote>\n<p>Maven's pom.xml is considered a &quot;project object model&quot;  That means, for your &quot;project&quot; it is the &quot;object&quot; that &quot;models&quot; the build process.  This object is sub-classed from a &quot;parent pom.xml&quot; that is embedded inside of Maven, which defines a default build; so, if you remove the &quot;maven-compiler-plugin&quot; you will get the default &quot;maven-compiler-plugin&quot; configuration.  Odds are that configuration is quite old, being shipped with Maven, and you probably are better off including an &quot;override&quot; which brings it up to date.</p>\n<h1>Eclipse and Maven</h1>\n<p>Eclpise and Maven work together; but, until you know how they work together, you will have a lot of problems.</p>\n<p>Eclipse reads the <code>pom.xml</code> file and generates a <code>Eclipse configuration</code> that should perform the same steps as the <code>pom.xml</code> file, in the same ways.  When you compile with Eclipse, it doesn't run <code>mvn compile</code>, it builds off of the Eclipse configuration, which might be older than the recently edited <code>pom.xml</code>.  For this reason, you should reread your project configuration after every edit of <code>pom.xml</code> when using ecplise.</p>\n<p>If you want to look at a different IDE that is similar to Eclipse; but, one that calls <code>mvn compile</code> instead of calling it's own interperted version of &quot;should be the same, but often isn't&quot;, look at NetBeans. <a href=\"https://netbeans.apache.org/download/nb122/index.html\" rel=\"nofollow noreferrer\">https://netbeans.apache.org/download/nb122/index.html</a>  Unlike Ecplipse, it doesn't contain its own &quot;mirror image of commands&quot; for Maven plugins (or its own embedded compiler), it uses the <code>mvn</code> command and the <code>javac</code> compiler and launches them with configurations to generate a lot of output messages, which it then reads to update it's &quot;IDE side&quot; of things.</p>\n<p>The reason I point this out, is because you might be following the instructions, and if you are, you might be seeing correct output on a <code>mvn package</code> from the command line, but not within Eclipse (because of the need to refresh the eclipse project from the source <code>pom.xml</code>)</p>\n"
        },
        {
          "comments": [
            {
              "owner": {
                "reputation": 368,
                "user_id": 10524503,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-TTMbFydM2wc/AAAAAAAAAAI/AAAAAAAAIbU/tMY5KezwBbg/photo.jpg?sz=128",
                "display_name": "Wortig",
                "link": "https://stackoverflow.com/users/10524503/wortig"
              },
              "score": 0,
              "creation_date": 1615068693,
              "post_id": 66510812,
              "comment_id": 117579106,
              "body_markdown": "You are savior! Enhance goal seem to be running however, i am getting build failure: https://justpaste.it/5ws66. I have META-INF/persistence.xml file and it is in my classpath. Can you show your project structure?",
              "body": "You are savior! Enhance goal seem to be running however, i am getting build failure: <a href=\"https://justpaste.it/5ws66\" rel=\"nofollow noreferrer\">justpaste.it/5ws66</a>. I have META-INF/persistence.xml file and it is in my classpath. Can you show your project structure?"
            },
            {
              "owner": {
                "reputation": 86,
                "user_id": 8959387,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/Gpstj.jpg?s=128&g=1",
                "display_name": "Gordon Tytler",
                "link": "https://stackoverflow.com/users/8959387/gordon-tytler"
              },
              "score": 1,
              "creation_date": 1615069331,
              "post_id": 66510812,
              "comment_id": 117579227,
              "body_markdown": "My file is in src/main/resources/META-INF and I have this in my pom.xml `\t\t&lt;resources&gt;\n\t\t\t&lt;resource&gt;\n\t\t\t\t&lt;directory&gt;src/main/resources&lt;/directory&gt;\n\t\t\t&lt;/resource&gt;\n\t\t&lt;/resources&gt;\n\t&lt;/build&gt;`",
              "body": "My file is in src/main/resources/META-INF and I have this in my pom.xml `\t\t&lt;resources&gt; \t\t\t&lt;resource&gt; \t\t\t\t&lt;directory&gt;src/main/resources&lt;/directory&gt; \t\t\t&lt;/resource&gt; \t\t&lt;/resources&gt; \t&lt;/build&gt;`"
            },
            {
              "owner": {
                "reputation": 368,
                "user_id": 10524503,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-TTMbFydM2wc/AAAAAAAAAAI/AAAAAAAAIbU/tMY5KezwBbg/photo.jpg?sz=128",
                "display_name": "Wortig",
                "link": "https://stackoverflow.com/users/10524503/wortig"
              },
              "score": 0,
              "creation_date": 1615071111,
              "post_id": 66510812,
              "comment_id": 117579608,
              "body_markdown": "Adding that resource to pom.xml helped, but now i am getting error when it tries to parse that file: https://justpaste.it/7ihlc. Do you have any idea what could be wrong? Eclipse does not alert any errors in that file. Can you describe your persistence.xml maybe?",
              "body": "Adding that resource to pom.xml helped, but now i am getting error when it tries to parse that file: <a href=\"https://justpaste.it/7ihlc\" rel=\"nofollow noreferrer\">justpaste.it/7ihlc</a>. Do you have any idea what could be wrong? Eclipse does not alert any errors in that file. Can you describe your persistence.xml maybe?"
            },
            {
              "owner": {
                "reputation": 368,
                "user_id": 10524503,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-TTMbFydM2wc/AAAAAAAAAAI/AAAAAAAAIbU/tMY5KezwBbg/photo.jpg?sz=128",
                "display_name": "Wortig",
                "link": "https://stackoverflow.com/users/10524503/wortig"
              },
              "score": 0,
              "creation_date": 1615071707,
              "post_id": 66510812,
              "comment_id": 117579739,
              "body_markdown": "https://stackoverflow.com/questions/11114665/org-xml-sax-saxparseexception-premature-end-of-file-for-valid-xml",
              "body": "<a href=\"https://stackoverflow.com/questions/11114665/org-xml-sax-saxparseexception-premature-end-of-file-for-valid-xml\" title=\"org xml sax saxparseexception premature end of file for valid xml\">stackoverflow.com/questions/11114665/&hellip;</a>"
            },
            {
              "owner": {
                "reputation": 86,
                "user_id": 8959387,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/Gpstj.jpg?s=128&g=1",
                "display_name": "Gordon Tytler",
                "link": "https://stackoverflow.com/users/8959387/gordon-tytler"
              },
              "score": 1,
              "creation_date": 1615106991,
              "post_id": 66510812,
              "comment_id": 117584817,
              "body_markdown": "@Wortig I think its the [Oracle security change](https://stackoverflow.com/questions/56728487/org-xml-sax-saxparseexceptionpublicid-http-xmlns-jcp-org-xml-ns-persistence-p).  You need  \n`xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/persistence https://www.oracle.com/webfolder/technetwork/jsc/xml/ns/persistence/persistence_2_2.xsd&quot;`",
              "body": "@Wortig I think its the <a href=\"https://stackoverflow.com/questions/56728487/org-xml-sax-saxparseexceptionpublicid-http-xmlns-jcp-org-xml-ns-persistence-p\">Oracle security change</a>.  You need   <code>xsi:schemaLocation=&quot;http:&#47;&#47;xmlns.jcp.org&#47;xml&#47;ns&#47;persistence https:&#47;&#47;www.oracle.com&#47;webfolder&#47;technetwork&#47;jsc&#47;xml&#47;ns&#47;pers&zwnj;&#8203;istence&#47;persistence_&zwnj;&#8203;2_2.xsd&quot;</code>"
            }
          ],
          "owner": {
            "reputation": 86,
            "user_id": 8959387,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/Gpstj.jpg?s=128&g=1",
            "display_name": "Gordon Tytler",
            "link": "https://stackoverflow.com/users/8959387/gordon-tytler"
          },
          "comment_count": 5,
          "score": 1,
          "creation_date": 1615066273,
          "answer_id": 66510812,
          "body_markdown": "You need to tell maven to run the enhance goal.\r\n\r\n    mvn clean compile openjpa:enhance\r\n\r\nYou should see this output: \r\n\r\n    [INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ jpa-example ---\r\n    [INFO] Changes detected - recompiling the module!\r\n    [INFO] Compiling 2 source files to /home/gordon/docs/programming/openjpa/jpa-example/target/classes\r\n    [INFO] \r\n    [INFO] --- openjpa-maven-plugin:3.1.2:enhance (default-cli) @ jpa-example ---\r\n    [INFO] \r\n\r\nThere is a hierarchy in maven. At the top are lifecycles which are composed of phases that are are implemented as plugin goals. The packaging determines the goals for a phase. \r\n\r\nThe enhance goal is not one of the default goals for build or compile.\r\n\r\nIn eclipse, if you change the pom.xml you need to right click and select Maven-&gt;Update Project. You can put your openjpa:enhance in the goals field on the eclipse run configurations for Maven Build.\r\n\r\n[![Maven Build run configuration][1]][1]\r\n\r\n\r\n\r\n \r\n\r\n\r\n  [1]: https://i.stack.imgur.com/vFoxe.jpg",
          "body": "<p>You need to tell maven to run the enhance goal.</p>\n<pre><code>mvn clean compile openjpa:enhance\n</code></pre>\n<p>You should see this output:</p>\n<pre><code>[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ jpa-example ---\n[INFO] Changes detected - recompiling the module!\n[INFO] Compiling 2 source files to /home/gordon/docs/programming/openjpa/jpa-example/target/classes\n[INFO] \n[INFO] --- openjpa-maven-plugin:3.1.2:enhance (default-cli) @ jpa-example ---\n[INFO] \n</code></pre>\n<p>There is a hierarchy in maven. At the top are lifecycles which are composed of phases that are are implemented as plugin goals. The packaging determines the goals for a phase.</p>\n<p>The enhance goal is not one of the default goals for build or compile.</p>\n<p>In eclipse, if you change the pom.xml you need to right click and select Maven-&gt;Update Project. You can put your openjpa:enhance in the goals field on the eclipse run configurations for Maven Build.</p>\n<p><a href=\"https://i.stack.imgur.com/vFoxe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vFoxe.jpg\" alt=\"Maven Build run configuration\" /></a></p>\n"
        },
        {
          "owner": {
            "reputation": 25705,
            "user_id": 927493,
            "user_type": "registered",
            "accept_rate": 61,
            "profile_image": "https://i.stack.imgur.com/sxsnm.png?s=128&g=1",
            "display_name": "J Fabian Meier",
            "link": "https://stackoverflow.com/users/927493/j-fabian-meier"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615301784,
          "answer_id": 66549279,
          "body_markdown": "Move the plugin definition to from `&lt;pluginManagement&gt;` to `&lt;plugins&gt;` like\r\n\r\n````xml\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    &lt;groupId&gt;registry&lt;/groupId&gt;\r\n    &lt;artifactId&gt;datalayer&lt;/artifactId&gt;\r\n    &lt;version&gt;0.0.1&lt;/version&gt;\r\n    &lt;packaging&gt;jar&lt;/packaging&gt;\r\n\r\n    &lt;properties&gt;\r\n        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\r\n        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\r\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n        &lt;project.reporting.sourceEncoding&gt;UTF-8&lt;/project.reporting.sourceEncoding&gt;\r\n    &lt;/properties&gt;\r\n\r\n    &lt;build&gt;\r\n        &lt;pluginManagement&gt;\r\n            &lt;plugins&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.8.1&lt;/version&gt;\r\n                &lt;/plugin&gt;\r\n            &lt;/plugins&gt;\r\n        &lt;/pluginManagement&gt;\r\n        &lt;plugins&gt;\r\n                &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;openjpa-maven-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.1.2&lt;/version&gt;\r\n                    &lt;configuration&gt;\r\n                        &lt;includes&gt;datalayer/dto/*.class&lt;/includes&gt;\r\n                        &lt;addDefaultConstructor&gt;true&lt;/addDefaultConstructor&gt;\r\n                        &lt;enforcePropertyRestrictions&gt;true&lt;/enforcePropertyRestrictions&gt;\r\n                    &lt;/configuration&gt;\r\n                    &lt;executions&gt;\r\n                        &lt;execution&gt;\r\n                            &lt;id&gt;enhancer&lt;/id&gt;\r\n                            &lt;phase&gt;process-classes&lt;/phase&gt;\r\n                            &lt;goals&gt;\r\n                                &lt;goal&gt;enhance&lt;/goal&gt;\r\n                            &lt;/goals&gt;\r\n                        &lt;/execution&gt;\r\n                    &lt;/executions&gt;\r\n                &lt;/plugin&gt;\r\n       &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n\r\n    &lt;dependencies&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\r\n            &lt;artifactId&gt;openjpa&lt;/artifactId&gt;\r\n            &lt;version&gt;3.1.2&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\r\n            &lt;artifactId&gt;derby&lt;/artifactId&gt;\r\n            &lt;version&gt;10.15.2.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\r\n            &lt;artifactId&gt;derbytools&lt;/artifactId&gt;\r\n            &lt;version&gt;10.15.2.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n    &lt;/dependencies&gt;\r\n&lt;/project&gt;\r\n````\r\n\r\nPluginManagement is only for configuration -- the plugins are not run automatically.\r\n",
          "body": "<p>Move the plugin definition to from <code>&lt;pluginManagement&gt;</code> to <code>&lt;plugins&gt;</code> like</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;registry&lt;/groupId&gt;\n    &lt;artifactId&gt;datalayer&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\n        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.sourceEncoding&gt;UTF-8&lt;/project.reporting.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;build&gt;\n        &lt;pluginManagement&gt;\n            &lt;plugins&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;3.8.1&lt;/version&gt;\n                &lt;/plugin&gt;\n            &lt;/plugins&gt;\n        &lt;/pluginManagement&gt;\n        &lt;plugins&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\n                    &lt;artifactId&gt;openjpa-maven-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;3.1.2&lt;/version&gt;\n                    &lt;configuration&gt;\n                        &lt;includes&gt;datalayer/dto/*.class&lt;/includes&gt;\n                        &lt;addDefaultConstructor&gt;true&lt;/addDefaultConstructor&gt;\n                        &lt;enforcePropertyRestrictions&gt;true&lt;/enforcePropertyRestrictions&gt;\n                    &lt;/configuration&gt;\n                    &lt;executions&gt;\n                        &lt;execution&gt;\n                            &lt;id&gt;enhancer&lt;/id&gt;\n                            &lt;phase&gt;process-classes&lt;/phase&gt;\n                            &lt;goals&gt;\n                                &lt;goal&gt;enhance&lt;/goal&gt;\n                            &lt;/goals&gt;\n                        &lt;/execution&gt;\n                    &lt;/executions&gt;\n                &lt;/plugin&gt;\n       &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\n            &lt;artifactId&gt;openjpa&lt;/artifactId&gt;\n            &lt;version&gt;3.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\n            &lt;artifactId&gt;derby&lt;/artifactId&gt;\n            &lt;version&gt;10.15.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\n            &lt;artifactId&gt;derbytools&lt;/artifactId&gt;\n            &lt;version&gt;10.15.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>PluginManagement is only for configuration -- the plugins are not run automatically.</p>\n"
        }
      ],
      "owner": {
        "reputation": 368,
        "user_id": 10524503,
        "user_type": "registered",
        "profile_image": "https://lh4.googleusercontent.com/-TTMbFydM2wc/AAAAAAAAAAI/AAAAAAAAIbU/tMY5KezwBbg/photo.jpg?sz=128",
        "display_name": "Wortig",
        "link": "https://stackoverflow.com/users/10524503/wortig"
      },
      "comment_count": 0,
      "view_count": 115,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1614849107,
      "question_id": 66471893,
      "body_markdown": "I am trying to *enhance* (entities) classes so i will not get this Exception:\r\n\r\n    Exception in thread &quot;main&quot; &lt;openjpa-3.1.2-r66d2a72 nonfatal user error&gt; org.apache.op\r\n    enjpa.persistence.ArgumentException: Attempt to cast instance &quot;entities.EntityPerson@\r\n    6dba847b&quot; to PersistenceCapable failed.  Ensure that it has been enhanced.\r\n    FailedObject: entities.EntityPerson@6dba847b\r\n    \tat org.apache.openjpa.kernel.BrokerImpl.assertPersistenceCapable(BrokerImpl.java:486\r\n    3)\r\n    \tat org.apache.openjpa.kernel.BrokerImpl.persistInternal(BrokerImpl.java:2762)\r\n    \tat org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2707)\r\n    \tat org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2690)\r\n    \tat org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2592)\r\n    \tat org.apache.openjpa.kernel.DelegatingBroker.persist(DelegatingBroker.java:1197)\r\n    \tat org.apache.openjpa.persistence.EntityManagerImpl.persist(EntityManagerImpl.java:8\r\n    37)\r\n    \tat openjpa.Test/main.Main.main(Main.java:23)\r\n\r\nsaying that my instance i am trying to persist is not *enhanced*.\r\n\r\nI have followed this: https://openjpa.apache.org/enhancement-with-maven.html official openjpa page and added `openjpa-maven-plugin` to the section of my pom.xml:\r\n\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n    \txmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    \txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    \t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \t&lt;groupId&gt;registry&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;datalayer&lt;/artifactId&gt;\r\n    \t&lt;version&gt;0.0.1&lt;/version&gt;\r\n    \t&lt;packaging&gt;jar&lt;/packaging&gt;\r\n    \r\n    \t&lt;properties&gt;\r\n    \t\t&lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\r\n    \t\t&lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\r\n    \t\t&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n    \t\t&lt;project.reporting.sourceEncoding&gt;UTF-8&lt;/project.reporting.sourceEncoding&gt;\r\n    \t&lt;/properties&gt;\r\n    \r\n    \t&lt;build&gt;\r\n    \t\t&lt;pluginManagement&gt;\r\n    \t\t\t&lt;plugins&gt;\r\n    \t\t\t\t&lt;plugin&gt;\r\n    \t\t\t\t\t&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n    \t\t\t\t\t&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n    \t\t\t\t\t&lt;version&gt;3.8.1&lt;/version&gt;\r\n    \t\t\t\t&lt;/plugin&gt;\r\n    \t\t\t\t&lt;plugin&gt;\r\n    \t\t\t\t\t&lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\r\n    \t\t\t\t\t&lt;artifactId&gt;openjpa-maven-plugin&lt;/artifactId&gt;\r\n    \t\t\t\t\t&lt;version&gt;3.1.2&lt;/version&gt;\r\n    \t\t\t\t\t&lt;configuration&gt;\r\n    \t\t\t\t\t\t&lt;includes&gt;datalayer/dto/*.class&lt;/includes&gt;\r\n    \t\t\t\t\t\t&lt;addDefaultConstructor&gt;true&lt;/addDefaultConstructor&gt;\r\n    \t\t\t\t\t\t&lt;enforcePropertyRestrictions&gt;true&lt;/enforcePropertyRestrictions&gt;\r\n    \t\t\t\t\t&lt;/configuration&gt;\r\n    \t\t\t\t\t&lt;executions&gt;\r\n    \t\t\t\t\t\t&lt;execution&gt;\r\n    \t\t\t\t\t\t\t&lt;id&gt;enhancer&lt;/id&gt;\r\n    \t\t\t\t\t\t\t&lt;phase&gt;process-classes&lt;/phase&gt;\r\n    \t\t\t\t\t\t\t&lt;goals&gt;\r\n    \t\t\t\t\t\t\t\t&lt;goal&gt;enhance&lt;/goal&gt;\r\n    \t\t\t\t\t\t\t&lt;/goals&gt;\r\n    \t\t\t\t\t\t&lt;/execution&gt;\r\n    \t\t\t\t\t&lt;/executions&gt;\r\n    \t\t\t\t&lt;/plugin&gt;\r\n    \t\t\t&lt;/plugins&gt;\r\n    \t\t&lt;/pluginManagement&gt;\r\n    \t&lt;/build&gt;\r\n    \r\n    \t&lt;dependencies&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;openjpa&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;3.1.2&lt;/version&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;derby&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;10.15.2.0&lt;/version&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;derbytools&lt;/artifactId&gt;\r\n    \t\t\t&lt;version&gt;10.15.2.0&lt;/version&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t&lt;/dependencies&gt;\r\n    &lt;/project&gt;\r\n\r\n, but i still get that exception. I am using Eclipse and built in command `Run As -&gt; Maven install`. I also tried to run `mvn install` from command line. Then i just try to persist some entity using `EntityManager`.\r\n\r\n**Running `mvn install` with and without openjpa-maven-plugin does not change anything** (same .jar generated with same .class files, same maven output to console)\r\n\r\n**As answer says, i needed to run `openjpa:enhance` goal when building with Maven. I was de facto not using `openjpa-maven-plugin`, so i fixed that.** Maven output:\r\n\r\n    [INFO] Error stacktraces are turned on.\r\n    [INFO] Scanning for projects...\r\n    [INFO] \r\n    [INFO] -------------------------&lt; registry:datalayer &gt;-------------------------\r\n    [INFO] Building datalayer 0.0.1\r\n    [INFO] --------------------------------[ jar ]---------------------------------\r\n    [INFO] \r\n    [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ datalayer ---\r\n    [INFO] Deleting C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\target\r\n    [INFO] \r\n    [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ datalayer ---\r\n    [INFO] Using &#39;UTF-8&#39; encoding to copy filtered resources.\r\n    [INFO] Copying 1 resource\r\n    [INFO] \r\n    [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ datalayer ---\r\n    [WARNING] Can&#39;t extract module name from geronimo-jms_1.1_spec-1.1.1.jar: geronimo.jm\r\n    s.1.1.spec: Invalid module name: &#39;1&#39; is not a Java identifier\r\n    [WARNING] Can&#39;t extract module name from geronimo-jta_1.1_spec-1.1.1.jar: geronimo.jt\r\n    a.1.1.spec: Invalid module name: &#39;1&#39; is not a Java identifier\r\n    [INFO] Changes detected - recompiling the module!\r\n    [INFO] Compiling 3 source files to C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Op\r\n    enjpa.Test\\target\\classes\r\n    [INFO] \r\n    [INFO] --- openjpa-maven-plugin:3.1.2:enhance (default-cli) @ datalayer ---\r\n    130  DataLayer  INFO   [main] openjpa.Tool - Enhancer running on type &quot;class entities\r\n    .EntityPerson&quot;.\r\n    [INFO] \r\n    [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ datalayer ---\r\n    [INFO] Using &#39;UTF-8&#39; encoding to copy filtered resources.\r\n    [INFO] Copying 1 resource\r\n    [INFO] \r\n    [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ datalayer ---\r\n    [WARNING] Can&#39;t extract module name from geronimo-jms_1.1_spec-1.1.1.jar: geronimo.jm\r\n    s.1.1.spec: Invalid module name: &#39;1&#39; is not a Java identifier\r\n    [WARNING] Can&#39;t extract module name from geronimo-jta_1.1_spec-1.1.1.jar: geronimo.jt\r\n    a.1.1.spec: Invalid module name: &#39;1&#39; is not a Java identifier\r\n    [INFO] Changes detected - recompiling the module!\r\n    [INFO] Compiling 3 source files to C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Op\r\n    enjpa.Test\\target\\classes\r\n    [INFO] \r\n    [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ datalay\r\n    er ---\r\n    [INFO] Using &#39;UTF-8&#39; encoding to copy filtered resources.\r\n    [INFO] Copying 0 resource\r\n    [INFO] \r\n    [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ datalayer \r\n    ---\r\n    [WARNING] Can&#39;t extract module name from geronimo-jta_1.1_spec-1.1.1.jar: geronimo.jt\r\n    a.1.1.spec: Invalid module name: &#39;1&#39; is not a Java identifier\r\n    [WARNING] Can&#39;t extract module name from geronimo-jms_1.1_spec-1.1.1.jar: geronimo.jm\r\n    s.1.1.spec: Invalid module name: &#39;1&#39; is not a Java identifier\r\n    [INFO] Changes detected - recompiling the module!\r\n    [INFO] \r\n    [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ datalayer ---\r\n    [INFO] \r\n    [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ datalayer ---\r\n    [INFO] Building jar: C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\tar\r\n    get\\datalayer-0.0.1.jar\r\n    [INFO] \r\n    [INFO] --- maven-install-plugin:2.4:install (default-install) @ datalayer ---\r\n    [INFO] Installing C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\target\r\n    \\datalayer-0.0.1.jar to C:\\Users\\wortigson\\.m2\\repository\\registry\\datalayer\\0.0.1\\da\r\n    talayer-0.0.1.jar\r\n    [INFO] Installing C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\pom.xm\r\n    l to C:\\Users\\wortigson\\.m2\\repository\\registry\\datalayer\\0.0.1\\datalayer-0.0.1.pom\r\n    [INFO] ------------------------------------------------------------------------\r\n    [INFO] BUILD SUCCESS\r\n\r\nYou can see i run enhancer on EntityPerson class, which is simple JPA entity i tested this on. However i still get that Exception. **I noticed** `maven-compiler-plugin:3.8.1:compile` running twice. Before and after `openjpa-maven-plugin:3.1.2:enhance` - might this be problem?\r\n\r\nI think this is not my case: https://stackoverflow.com/questions/32229585/how-to-enhance-a-class-from-a-separate-jar-at-build-time-with-openjpa\r\n\r\nFound there is workaround https://stackoverflow.com/questions/4102294/attempt-to-cast-instance-to-persistencecapable-failed-ensure-that-its-been-enh by setting some attribute in configuration as accepted answer says, but i do not want to do it that way, as first comment says it is not recommended and points to the official openjpa page, where i found that example how to enhance classes during maven build time, but as i wrote, it does not work.\r\n\r\nTesting main method:\r\n\r\n    public static void main(String[] args)\r\n    \t{\r\n    \t\tHashMap&lt;String, String&gt; jpaProps = new HashMap&lt;String, String&gt;();\r\n    \t\tjpaProps.put(&quot;javax.persistence.jdbc.url&quot;, &quot;jdbc:derby:testDB;create=true&quot;);\r\n    \t\tEntityManagerFactory factory = Persistence.createEntityManagerFactory(&quot;DataLayer&quot;, jpaProps);\r\n    \t\tEntityManager manager = factory.createEntityManager();\r\n    \t\tEntityPerson person = new EntityPerson();\r\n    \t\tperson.setAge(25);\r\n    \t\tperson.setName(&quot;Andrej Hruska&quot;);\r\n    \t\tmanager.persist(person); // +\r\n    \t}\r\n\r\nEntityPerson class:\r\n\r\n    package entities;\r\n    \r\n    import javax.persistence.Column;\r\n    import javax.persistence.Entity;\r\n    import javax.persistence.GeneratedValue;\r\n    import javax.persistence.Id;\r\n    \r\n    @Entity\r\n    public class EntityPerson\r\n    {\r\n    \t@Id\r\n    \t@GeneratedValue\r\n    \tprivate long id;\r\n    \t\r\n    \t@Column(nullable = false)\r\n    \tprivate String name;\r\n    \t\r\n    \tprivate int age;\r\n    \r\n    \tpublic long getId()\r\n    \t{\r\n    \t\treturn id;\r\n    \t}\r\n    \r\n    \tpublic void setId(long id)\r\n    \t{\r\n    \t\tthis.id = id;\r\n    \t}\r\n    \r\n    \tpublic String getName()\r\n    \t{\r\n    \t\treturn name;\r\n    \t}\r\n    \r\n    \tpublic void setName(String name)\r\n    \t{\r\n    \t\tthis.name = name;\r\n    \t}\r\n    \r\n    \tpublic int getAge()\r\n    \t{\r\n    \t\treturn age;\r\n    \t}\r\n    \r\n    \tpublic void setAge(int age)\r\n    \t{\r\n    \t\tthis.age = age;\r\n    \t}\r\n    }\r\n\r\npersistence.xml:\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;persistence version=&quot;2.2&quot;\r\n    \txmlns=&quot;http://xmlns.jcp.org/xml/ns/persistence&quot;\r\n    \txmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n    \txsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/persistence https://www.oracle.com/webfolder/technetwork/jsc/xml/ns/persistence/persistence_2_2.xsd&quot;&gt;\r\n    \t&lt;persistence-unit name=&quot;DataLayer&quot;\r\n    \t\ttransaction-type=&quot;RESOURCE_LOCAL&quot;&gt;\r\n    \t\t&lt;non-jta-data-source&gt;DataSource&lt;/non-jta-data-source&gt;\r\n    \t\t&lt;properties&gt;\r\n    \t\t\t&lt;property\r\n    \t\t\t\tname=&quot;javax.persistence.schema-generation.database.action&quot;\r\n    \t\t\t\tvalue=&quot;create&quot; /&gt;\r\n    \t\t\t&lt;property name=&quot;javax.persistence.jdbc.driver&quot;\r\n    \t\t\t\tvalue=&quot;org.apache.derby.jdbc.EmbeddedDriver&quot; /&gt;\r\n    \t\t\t&lt;property name=&quot;javax.persistence.jdbc.url&quot;\r\n    \t\t\t\tvalue=&quot;jdbc:derby:db;create=true&quot; /&gt;\r\n    \t\t&lt;/properties&gt;\r\n    \t&lt;/persistence-unit&gt;\r\n    &lt;/persistence&gt;\r\n\r\nProject structure:\r\n\r\n[![Project structure][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/T3zeW.png\r\n\r\n**Steps to reproduce:**\r\n 1. Crete Maven project in Eclipse\r\n 2. Copy my pom.xml (or add dependencies to derby, openjpa and set up your openjpa-maven-plugin, names and paths)\r\n 3. Copy my persistence.xml (or create your own with some persistence unit)\r\n 4. Copy my EntityPerson class (or create simple JPA entity to test it on)\r\n 5. Run mvn clean compile openjpa:enhance install (important part is openjpa:enhance)\r\n 6. Try to persist entity as i did in my main method",
      "title": "How to enhance classes properly at build time using Maven? OpenJPA",
      "body": "<p>I am trying to <em>enhance</em> (entities) classes so i will not get this Exception:</p>\n<pre><code>Exception in thread &quot;main&quot; &lt;openjpa-3.1.2-r66d2a72 nonfatal user error&gt; org.apache.op\nenjpa.persistence.ArgumentException: Attempt to cast instance &quot;entities.EntityPerson@\n6dba847b&quot; to PersistenceCapable failed.  Ensure that it has been enhanced.\nFailedObject: entities.EntityPerson@6dba847b\n    at org.apache.openjpa.kernel.BrokerImpl.assertPersistenceCapable(BrokerImpl.java:486\n3)\n    at org.apache.openjpa.kernel.BrokerImpl.persistInternal(BrokerImpl.java:2762)\n    at org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2707)\n    at org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2690)\n    at org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2592)\n    at org.apache.openjpa.kernel.DelegatingBroker.persist(DelegatingBroker.java:1197)\n    at org.apache.openjpa.persistence.EntityManagerImpl.persist(EntityManagerImpl.java:8\n37)\n    at openjpa.Test/main.Main.main(Main.java:23)\n</code></pre>\n<p>saying that my instance i am trying to persist is not <em>enhanced</em>.</p>\n<p>I have followed this: <a href=\"https://openjpa.apache.org/enhancement-with-maven.html\" rel=\"nofollow noreferrer\">https://openjpa.apache.org/enhancement-with-maven.html</a> official openjpa page and added <code>openjpa-maven-plugin</code> to the section of my pom.xml:</p>\n<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;registry&lt;/groupId&gt;\n    &lt;artifactId&gt;datalayer&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\n        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.sourceEncoding&gt;UTF-8&lt;/project.reporting.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;build&gt;\n        &lt;pluginManagement&gt;\n            &lt;plugins&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;3.8.1&lt;/version&gt;\n                &lt;/plugin&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\n                    &lt;artifactId&gt;openjpa-maven-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;3.1.2&lt;/version&gt;\n                    &lt;configuration&gt;\n                        &lt;includes&gt;datalayer/dto/*.class&lt;/includes&gt;\n                        &lt;addDefaultConstructor&gt;true&lt;/addDefaultConstructor&gt;\n                        &lt;enforcePropertyRestrictions&gt;true&lt;/enforcePropertyRestrictions&gt;\n                    &lt;/configuration&gt;\n                    &lt;executions&gt;\n                        &lt;execution&gt;\n                            &lt;id&gt;enhancer&lt;/id&gt;\n                            &lt;phase&gt;process-classes&lt;/phase&gt;\n                            &lt;goals&gt;\n                                &lt;goal&gt;enhance&lt;/goal&gt;\n                            &lt;/goals&gt;\n                        &lt;/execution&gt;\n                    &lt;/executions&gt;\n                &lt;/plugin&gt;\n            &lt;/plugins&gt;\n        &lt;/pluginManagement&gt;\n    &lt;/build&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;\n            &lt;artifactId&gt;openjpa&lt;/artifactId&gt;\n            &lt;version&gt;3.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\n            &lt;artifactId&gt;derby&lt;/artifactId&gt;\n            &lt;version&gt;10.15.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;\n            &lt;artifactId&gt;derbytools&lt;/artifactId&gt;\n            &lt;version&gt;10.15.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>, but i still get that exception. I am using Eclipse and built in command <code>Run As -&gt; Maven install</code>. I also tried to run <code>mvn install</code> from command line. Then i just try to persist some entity using <code>EntityManager</code>.</p>\n<p><strong>Running <code>mvn install</code> with and without openjpa-maven-plugin does not change anything</strong> (same .jar generated with same .class files, same maven output to console)</p>\n<p><strong>As answer says, i needed to run <code>openjpa:enhance</code> goal when building with Maven. I was de facto not using <code>openjpa-maven-plugin</code>, so i fixed that.</strong> Maven output:</p>\n<pre><code>[INFO] Error stacktraces are turned on.\n[INFO] Scanning for projects...\n[INFO] \n[INFO] -------------------------&lt; registry:datalayer &gt;-------------------------\n[INFO] Building datalayer 0.0.1\n[INFO] --------------------------------[ jar ]---------------------------------\n[INFO] \n[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ datalayer ---\n[INFO] Deleting C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\target\n[INFO] \n[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ datalayer ---\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\n[INFO] Copying 1 resource\n[INFO] \n[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ datalayer ---\n[WARNING] Can't extract module name from geronimo-jms_1.1_spec-1.1.1.jar: geronimo.jm\ns.1.1.spec: Invalid module name: '1' is not a Java identifier\n[WARNING] Can't extract module name from geronimo-jta_1.1_spec-1.1.1.jar: geronimo.jt\na.1.1.spec: Invalid module name: '1' is not a Java identifier\n[INFO] Changes detected - recompiling the module!\n[INFO] Compiling 3 source files to C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Op\nenjpa.Test\\target\\classes\n[INFO] \n[INFO] --- openjpa-maven-plugin:3.1.2:enhance (default-cli) @ datalayer ---\n130  DataLayer  INFO   [main] openjpa.Tool - Enhancer running on type &quot;class entities\n.EntityPerson&quot;.\n[INFO] \n[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ datalayer ---\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\n[INFO] Copying 1 resource\n[INFO] \n[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ datalayer ---\n[WARNING] Can't extract module name from geronimo-jms_1.1_spec-1.1.1.jar: geronimo.jm\ns.1.1.spec: Invalid module name: '1' is not a Java identifier\n[WARNING] Can't extract module name from geronimo-jta_1.1_spec-1.1.1.jar: geronimo.jt\na.1.1.spec: Invalid module name: '1' is not a Java identifier\n[INFO] Changes detected - recompiling the module!\n[INFO] Compiling 3 source files to C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Op\nenjpa.Test\\target\\classes\n[INFO] \n[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ datalay\ner ---\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\n[INFO] Copying 0 resource\n[INFO] \n[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ datalayer \n---\n[WARNING] Can't extract module name from geronimo-jta_1.1_spec-1.1.1.jar: geronimo.jt\na.1.1.spec: Invalid module name: '1' is not a Java identifier\n[WARNING] Can't extract module name from geronimo-jms_1.1_spec-1.1.1.jar: geronimo.jm\ns.1.1.spec: Invalid module name: '1' is not a Java identifier\n[INFO] Changes detected - recompiling the module!\n[INFO] \n[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ datalayer ---\n[INFO] \n[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ datalayer ---\n[INFO] Building jar: C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\tar\nget\\datalayer-0.0.1.jar\n[INFO] \n[INFO] --- maven-install-plugin:2.4:install (default-install) @ datalayer ---\n[INFO] Installing C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\target\n\\datalayer-0.0.1.jar to C:\\Users\\wortigson\\.m2\\repository\\registry\\datalayer\\0.0.1\\da\ntalayer-0.0.1.jar\n[INFO] Installing C:\\Users\\wortigson\\Desktop\\ISMatrikaBcWorkspace\\Openjpa.Test\\pom.xm\nl to C:\\Users\\wortigson\\.m2\\repository\\registry\\datalayer\\0.0.1\\datalayer-0.0.1.pom\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n</code></pre>\n<p>You can see i run enhancer on EntityPerson class, which is simple JPA entity i tested this on. However i still get that Exception. <strong>I noticed</strong> <code>maven-compiler-plugin:3.8.1:compile</code> running twice. Before and after <code>openjpa-maven-plugin:3.1.2:enhance</code> - might this be problem?</p>\n<p>I think this is not my case: <a href=\"https://stackoverflow.com/questions/32229585/how-to-enhance-a-class-from-a-separate-jar-at-build-time-with-openjpa\">How to enhance a class from a separate jar at build time with openJPA?</a></p>\n<p>Found there is workaround <a href=\"https://stackoverflow.com/questions/4102294/attempt-to-cast-instance-to-persistencecapable-failed-ensure-that-its-been-enh\">Attempt to cast instance to PersistenceCapable failed. Ensure that it&#39;s been enhanced</a> by setting some attribute in configuration as accepted answer says, but i do not want to do it that way, as first comment says it is not recommended and points to the official openjpa page, where i found that example how to enhance classes during maven build time, but as i wrote, it does not work.</p>\n<p>Testing main method:</p>\n<pre><code>public static void main(String[] args)\n    {\n        HashMap&lt;String, String&gt; jpaProps = new HashMap&lt;String, String&gt;();\n        jpaProps.put(&quot;javax.persistence.jdbc.url&quot;, &quot;jdbc:derby:testDB;create=true&quot;);\n        EntityManagerFactory factory = Persistence.createEntityManagerFactory(&quot;DataLayer&quot;, jpaProps);\n        EntityManager manager = factory.createEntityManager();\n        EntityPerson person = new EntityPerson();\n        person.setAge(25);\n        person.setName(&quot;Andrej Hruska&quot;);\n        manager.persist(person); // +\n    }\n</code></pre>\n<p>EntityPerson class:</p>\n<pre><code>package entities;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\n\n@Entity\npublic class EntityPerson\n{\n    @Id\n    @GeneratedValue\n    private long id;\n    \n    @Column(nullable = false)\n    private String name;\n    \n    private int age;\n\n    public long getId()\n    {\n        return id;\n    }\n\n    public void setId(long id)\n    {\n        this.id = id;\n    }\n\n    public String getName()\n    {\n        return name;\n    }\n\n    public void setName(String name)\n    {\n        this.name = name;\n    }\n\n    public int getAge()\n    {\n        return age;\n    }\n\n    public void setAge(int age)\n    {\n        this.age = age;\n    }\n}\n</code></pre>\n<p>persistence.xml:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;persistence version=&quot;2.2&quot;\n    xmlns=&quot;http://xmlns.jcp.org/xml/ns/persistence&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/persistence https://www.oracle.com/webfolder/technetwork/jsc/xml/ns/persistence/persistence_2_2.xsd&quot;&gt;\n    &lt;persistence-unit name=&quot;DataLayer&quot;\n        transaction-type=&quot;RESOURCE_LOCAL&quot;&gt;\n        &lt;non-jta-data-source&gt;DataSource&lt;/non-jta-data-source&gt;\n        &lt;properties&gt;\n            &lt;property\n                name=&quot;javax.persistence.schema-generation.database.action&quot;\n                value=&quot;create&quot; /&gt;\n            &lt;property name=&quot;javax.persistence.jdbc.driver&quot;\n                value=&quot;org.apache.derby.jdbc.EmbeddedDriver&quot; /&gt;\n            &lt;property name=&quot;javax.persistence.jdbc.url&quot;\n                value=&quot;jdbc:derby:db;create=true&quot; /&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n<p>Project structure:</p>\n<p><a href=\"https://i.stack.imgur.com/T3zeW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T3zeW.png\" alt=\"Project structure\" /></a></p>\n<p><strong>Steps to reproduce:</strong></p>\n<ol>\n<li>Crete Maven project in Eclipse</li>\n<li>Copy my pom.xml (or add dependencies to derby, openjpa and set up your openjpa-maven-plugin, names and paths)</li>\n<li>Copy my persistence.xml (or create your own with some persistence unit)</li>\n<li>Copy my EntityPerson class (or create simple JPA entity to test it on)</li>\n<li>Run mvn clean compile openjpa:enhance install (important part is openjpa:enhance)</li>\n<li>Try to persist entity as i did in my main method</li>\n</ol>\n"
    },
    {
      "tags": [
        "java",
        "arraylist",
        "coldfusion",
        "lucee"
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 7299,
                "user_id": 1769733,
                "user_type": "registered",
                "accept_rate": 46,
                "profile_image": "https://i.stack.imgur.com/lii61.png?s=128&g=1",
                "display_name": "Alex",
                "link": "https://stackoverflow.com/users/1769733/alex"
              },
              "score": 1,
              "creation_date": 1614897951,
              "post_id": 66467164,
              "comment_id": 117533645,
              "body_markdown": "I checked Lucee&#39;s source code and found out that it doesn&#39;t even reach `identityHashCode`. The ArrayLists are stored in a `Set` which calls `contains` to do some &quot;clean up&quot;(?), triggering ArrayList&#39;s `hashCode`. So there we go. Filing a bug for them. Thanks for your insight.",
              "body": "I checked Lucee&#39;s source code and found out that it doesn&#39;t even reach <code>identityHashCode</code>. The ArrayLists are stored in a <code>Set</code> which calls <code>contains</code> to do some &quot;clean up&quot;(?), triggering ArrayList&#39;s <code>hashCode</code>. So there we go. Filing a bug for them. Thanks for your insight."
            }
          ],
          "owner": {
            "reputation": 38622,
            "user_id": 768644,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=128&d=identicon&r=PG",
            "display_name": "rzwitserloot",
            "link": "https://stackoverflow.com/users/768644/rzwitserloot"
          },
          "comment_count": 1,
          "score": 6,
          "creation_date": 1614820219,
          "answer_id": 66467164,
          "body_markdown": "The implementation of `System.identityHashCode` is `native` - its implemented at the VM level; it&#39;s not java code. The specification of iHC is intentionally vague.\r\n\r\nThe reason it&#39;s vague is because it&#39;s highly platform dependent, and the spec is trying to give sufficient leeway to implementers of VMs on exotic platforms (and ColdFusion and Lucee certainly count, no?) to make an impl that fits spec.\r\n\r\nIt&#39;s technically possible for the hashCode impl of `Object` to scan fields, though that would be highly inefficient (because System.iHC is used a ton in places where a fast response is required, and that would be anything but), and you&#39;re not the only one who makes the assumption that System.iHC would not loop forever even in an object that (eventually) references itself.\r\n\r\nBut, the key point is, those are widely used __assumptions__; nothing in the spec of that method actually says it works that way.\r\n\r\nOn the flipside, the leeway that lucee is taking (if what you say is indeed true), is rather excessive.\r\n\r\nThus, you&#39;re now well stuck. These things are all true:\r\n\r\n* Tons of code assumes iHC cannot loop. It is therefore, de facto, highly impractical that a VM impl would loop.\r\n* Tons of code assumes iHC is fast. It is therefore, de facto, highly impractical that a VM impl would be slow.\r\n* Nevetheless, Lucee can go the &#39;I am rubber and you are glue, whatever you bug report bounces off of me and sticks to you&#39; route on this and just tell you that their impl is valid according to spec and therefore whatever code you care to toss at em to make your point is at fault.\r\n\r\nBut give them a chance first, before you assume they&#39;ll take the open door &#39;nu uh! Not our fault!&#39; route that is technically available to them here.\r\n\r\nIf they deny your bug report, and/or you want to beef it up some before you file it at their bugtracker, here are some things you may wish to investigate:\r\n\r\n* Make a self-reffing object and use it as key in an IdentityHashMap. Does this stackoverflow? That&#39;d be a good one to lead with, because now you&#39;re showing them the severity of this issue: Either they admit that a core class in java.util is buggy, or they admit their code is buggy, or they take the even more exotic position that the specifications of IHM and System.iHC combine to conclude that any code that attempts to use self-ref objects as keys in an IHM is buggy. That&#39;s probably where they end up if they don&#39;t want to accept this bug, so prepare yourself for disappointment.\r\n* Find a couple of libraries and show that they just don&#39;t work on lucee. One place to look is serialization libraries that state that they support self-ref / cloned refs (such as a list that contains itself, or contains the same obj ref multiple times).\r\n* What does `==`  behave like, in lucee? Does `new String(&quot;foo&quot;) == new String(&quot;foo&quot;)` equal true?\r\n\r\nBut most of all do keep some patience with the lucee folk. It is entirely possible that there is no real way they can actually impl System.iHC due to the limitations of the platform they&#39;re working with, in which case there&#39;s not much they can do but commiserate and shrug.\r\n",
          "body": "<p>The implementation of <code>System.identityHashCode</code> is <code>native</code> - its implemented at the VM level; it's not java code. The specification of iHC is intentionally vague.</p>\n<p>The reason it's vague is because it's highly platform dependent, and the spec is trying to give sufficient leeway to implementers of VMs on exotic platforms (and ColdFusion and Lucee certainly count, no?) to make an impl that fits spec.</p>\n<p>It's technically possible for the hashCode impl of <code>Object</code> to scan fields, though that would be highly inefficient (because System.iHC is used a ton in places where a fast response is required, and that would be anything but), and you're not the only one who makes the assumption that System.iHC would not loop forever even in an object that (eventually) references itself.</p>\n<p>But, the key point is, those are widely used <strong>assumptions</strong>; nothing in the spec of that method actually says it works that way.</p>\n<p>On the flipside, the leeway that lucee is taking (if what you say is indeed true), is rather excessive.</p>\n<p>Thus, you're now well stuck. These things are all true:</p>\n<ul>\n<li>Tons of code assumes iHC cannot loop. It is therefore, de facto, highly impractical that a VM impl would loop.</li>\n<li>Tons of code assumes iHC is fast. It is therefore, de facto, highly impractical that a VM impl would be slow.</li>\n<li>Nevetheless, Lucee can go the 'I am rubber and you are glue, whatever you bug report bounces off of me and sticks to you' route on this and just tell you that their impl is valid according to spec and therefore whatever code you care to toss at em to make your point is at fault.</li>\n</ul>\n<p>But give them a chance first, before you assume they'll take the open door 'nu uh! Not our fault!' route that is technically available to them here.</p>\n<p>If they deny your bug report, and/or you want to beef it up some before you file it at their bugtracker, here are some things you may wish to investigate:</p>\n<ul>\n<li>Make a self-reffing object and use it as key in an IdentityHashMap. Does this stackoverflow? That'd be a good one to lead with, because now you're showing them the severity of this issue: Either they admit that a core class in java.util is buggy, or they admit their code is buggy, or they take the even more exotic position that the specifications of IHM and System.iHC combine to conclude that any code that attempts to use self-ref objects as keys in an IHM is buggy. That's probably where they end up if they don't want to accept this bug, so prepare yourself for disappointment.</li>\n<li>Find a couple of libraries and show that they just don't work on lucee. One place to look is serialization libraries that state that they support self-ref / cloned refs (such as a list that contains itself, or contains the same obj ref multiple times).</li>\n<li>What does <code>==</code>  behave like, in lucee? Does <code>new String(&quot;foo&quot;) == new String(&quot;foo&quot;)</code> equal true?</li>\n</ul>\n<p>But most of all do keep some patience with the lucee folk. It is entirely possible that there is no real way they can actually impl System.iHC due to the limitations of the platform they're working with, in which case there's not much they can do but commiserate and shrug.</p>\n"
        }
      ],
      "owner": {
        "reputation": 7299,
        "user_id": 1769733,
        "user_type": "registered",
        "accept_rate": 46,
        "profile_image": "https://i.stack.imgur.com/lii61.png?s=128&g=1",
        "display_name": "Alex",
        "link": "https://stackoverflow.com/users/1769733/alex"
      },
      "comment_count": 0,
      "view_count": 49,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1614819117,
      "question_id": 66467046,
      "body_markdown": "**Edit: [Bug has been filed.](https://luceeserver.atlassian.net/browse/LDEV-3333)**\r\n\r\nLet&#39;s say I have two ArrayLists that point to each other (circular reference):\r\n\r\n\tx = createObject(&quot;java&quot;, &quot;java.util.ArrayList&quot;).init();\r\n\ty = createObject(&quot;java&quot;, &quot;java.util.ArrayList&quot;).init();\r\n\tx.add(y);\r\n\ty.add(x);\r\n\r\nIf I call `hashCode` on any of them, it causes a `StackOverflowError` [due to the ArrayList implementation](https://code.yawk.at/java/11/java.base/java/util/ArrayList.java#java.util.ArrayList%23hashCode()). This is to be expected.\r\n\r\nHowever, when I invoke `System.identityHashCode`, isn&#39;t it supposed to use the `Object.hashCode` implementation, which won&#39;t follow the elements in an ArrayList and thus won&#39;t cause a `StackOverflowError`?\r\n\r\n[Documentation of `identityHashCode`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/System.html#identityHashCode(java.lang.Object)) states:\r\n&gt; Returns the same hash code for the given object as would be returned\r\n&gt; by the default method hashCode(), whether or not the given object&#39;s\r\n&gt; class overrides hashCode().\r\n\r\nIn Adobe ColdFusion, this code works fine:\r\n\r\n\tSystem = createObject(&quot;java&quot;, &quot;java.lang.System&quot;);\r\n\r\n\tSystem.identityHashCode(x); // returns some integer\r\n\tSystem.identityHashCode(y); // returns another integer\r\n\r\n(This obviously also works when natively compiled and run with Java.)\r\n\r\nIn Lucee however, it immediately causes a `StackOverflowError`:\r\n\r\n\tlucee.runtime.exp.NativeException: java.lang.StackOverflowError\r\n\t\tat java.base/java.util.ArrayList.hashCodeRange(ArrayList.java:627)\r\n\t\tat java.base/java.util.ArrayList.hashCode(ArrayList.java:614)\r\n\t\tat java.base/java.util.ArrayList.hashCodeRange(ArrayList.java:627)\r\n\t\tat java.base/java.util.ArrayList.hashCode(ArrayList.java:614)\r\n\t\t[...]\r\n\r\nWhy is it running the ArrayList implementation of `hashCode` here?\r\n\r\nBoth CFML engines run with the same JVM (HotSpot) and Java version (11) on the same servlet (Tomcat 9). I&#39;d like to understand why they behave differently.",
      "title": "identityHashCode difference between Java/ColdFusion and Lucee",
      "body": "<p><strong>Edit: <a href=\"https://luceeserver.atlassian.net/browse/LDEV-3333\" rel=\"nofollow noreferrer\">Bug has been filed.</a></strong></p>\n<p>Let's say I have two ArrayLists that point to each other (circular reference):</p>\n<pre><code>x = createObject(&quot;java&quot;, &quot;java.util.ArrayList&quot;).init();\ny = createObject(&quot;java&quot;, &quot;java.util.ArrayList&quot;).init();\nx.add(y);\ny.add(x);\n</code></pre>\n<p>If I call <code>hashCode</code> on any of them, it causes a <code>StackOverflowError</code> <a href=\"https://code.yawk.at/java/11/java.base/java/util/ArrayList.java#java.util.ArrayList%23hashCode()\" rel=\"nofollow noreferrer\">due to the ArrayList implementation</a>. This is to be expected.</p>\n<p>However, when I invoke <code>System.identityHashCode</code>, isn't it supposed to use the <code>Object.hashCode</code> implementation, which won't follow the elements in an ArrayList and thus won't cause a <code>StackOverflowError</code>?</p>\n<p><a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/System.html#identityHashCode(java.lang.Object)\" rel=\"nofollow noreferrer\">Documentation of <code>identityHashCode</code></a> states:</p>\n<blockquote>\n<p>Returns the same hash code for the given object as would be returned\nby the default method hashCode(), whether or not the given object's\nclass overrides hashCode().</p>\n</blockquote>\n<p>In Adobe ColdFusion, this code works fine:</p>\n<pre><code>System = createObject(&quot;java&quot;, &quot;java.lang.System&quot;);\n\nSystem.identityHashCode(x); // returns some integer\nSystem.identityHashCode(y); // returns another integer\n</code></pre>\n<p>(This obviously also works when natively compiled and run with Java.)</p>\n<p>In Lucee however, it immediately causes a <code>StackOverflowError</code>:</p>\n<pre><code>lucee.runtime.exp.NativeException: java.lang.StackOverflowError\n    at java.base/java.util.ArrayList.hashCodeRange(ArrayList.java:627)\n    at java.base/java.util.ArrayList.hashCode(ArrayList.java:614)\n    at java.base/java.util.ArrayList.hashCodeRange(ArrayList.java:627)\n    at java.base/java.util.ArrayList.hashCode(ArrayList.java:614)\n    [...]\n</code></pre>\n<p>Why is it running the ArrayList implementation of <code>hashCode</code> here?</p>\n<p>Both CFML engines run with the same JVM (HotSpot) and Java version (11) on the same servlet (Tomcat 9). I'd like to understand why they behave differently.</p>\n"
    },
    {
      "tags": [
        "java",
        "class",
        "nested"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 8927,
            "user_id": 2338547,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/QT3fG.png?s=128&g=1",
            "display_name": "markspace",
            "link": "https://stackoverflow.com/users/2338547/markspace"
          },
          "score": 0,
          "creation_date": 1615474889,
          "post_id": 66585058,
          "comment_id": 117706429,
          "body_markdown": "Hmm, on second thought, it *might* be nested, if it&#39;s the anonymous class that is nested (probably named `Test$1` or somesuch).  But that kind of construct isn&#39;t what I think of as &quot;nested&quot;, it&#39;s an anonymous class imo.",
          "body": "Hmm, on second thought, it <i>might</i> be nested, if it&#39;s the anonymous class that is nested (probably named <code>Test$1</code> or somesuch).  But that kind of construct isn&#39;t what I think of as &quot;nested&quot;, it&#39;s an anonymous class imo."
        },
        {
          "owner": {
            "reputation": 45593,
            "user_id": 3890632,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1",
            "display_name": "khelwood",
            "link": "https://stackoverflow.com/users/3890632/khelwood"
          },
          "score": 0,
          "creation_date": 1615474895,
          "post_id": 66585058,
          "comment_id": 117706434,
          "body_markdown": "`new Test() {...}` is a nested class inside `Test` that is also an anonymous subclass of `Test`, used to create one instance.",
          "body": "<code>new Test() {...}</code> is a nested class inside <code>Test</code> that is also an anonymous subclass of <code>Test</code>, used to create one instance."
        },
        {
          "owner": {
            "reputation": 8927,
            "user_id": 2338547,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/QT3fG.png?s=128&g=1",
            "display_name": "markspace",
            "link": "https://stackoverflow.com/users/2338547/markspace"
          },
          "score": 0,
          "creation_date": 1615474930,
          "post_id": 66585058,
          "comment_id": 117706459,
          "body_markdown": "I&#39;d wait a bit and let others chime in before deleting, I could be wrong and the discussion might be interesting.",
          "body": "I&#39;d wait a bit and let others chime in before deleting, I could be wrong and the discussion might be interesting."
        },
        {
          "owner": {
            "reputation": 17397,
            "user_id": 5515060,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://i.stack.imgur.com/BXWsz.png?s=128&g=1",
            "display_name": "Lino",
            "link": "https://stackoverflow.com/users/5515060/lino"
          },
          "score": 0,
          "creation_date": 1615474989,
          "post_id": 66585058,
          "comment_id": 117706501,
          "body_markdown": "Related and worth a read: [Why is an anonymous class in a static context valid](https://stackoverflow.com/q/27738935/5515060), not sure if it would apply as a duplicate though",
          "body": "Related and worth a read: <a href=\"https://stackoverflow.com/q/27738935/5515060\">Why is an anonymous class in a static context valid</a>, not sure if it would apply as a duplicate though"
        }
      ],
      "answers": [
        {
          "owner": {
            "reputation": 4011,
            "user_id": 2442526,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/c673a5b98a6b201606a39c644c467b13?s=128&d=identicon&r=PG&f=1",
            "display_name": "xtratic",
            "link": "https://stackoverflow.com/users/2442526/xtratic"
          },
          "comment_count": 0,
          "score": 6,
          "creation_date": 1615475610,
          "answer_id": 66585307,
          "body_markdown": "It&#39;s an *Inner Class*, specifically an *Anonymous Inner Class*, but not what people typically call a *Nested Class* though they are very closely related.\r\n\r\nThe class is not &quot;nested within itself&quot; since `new Test() { ... }` is actually an anonymous **subclass** of `Test`.",
          "body": "<p>It's an <em>Inner Class</em>, specifically an <em>Anonymous Inner Class</em>, but not what people typically call a <em>Nested Class</em> though they are very closely related.</p>\n<p>The class is not &quot;nested within itself&quot; since <code>new Test() { ... }</code> is actually an anonymous <strong>subclass</strong> of <code>Test</code>.</p>\n"
        },
        {
          "comments": [
            {
              "owner": {
                "user_type": "does_not_exist",
                "display_name": "user14528515"
              },
              "score": 0,
              "creation_date": 1615477665,
              "post_id": 66585524,
              "comment_id": 117707873,
              "body_markdown": "So if this class was not an inner class but something like [Oracledoc](https://docs.oracle.com/javase/tutorial/java/javaOO/anonymousclasses.html#:~:text=Anonymous%20classes%20enable%20you%20to,a%20local%20class%20only%20once.) then its name would have been simple $1. I mean if it wouldn&#39;t have been an inner class but just an anonymous class then its name would have been simply $1?",
              "body": "So if this class was not an inner class but something like <a href=\"https://docs.oracle.com/javase/tutorial/java/javaOO/anonymousclasses.html#:~:text=Anonymous%20classes%20enable%20you%20to,a%20local%20class%20only%20once.\" rel=\"nofollow noreferrer\">Oracledoc</a> then its name would have been simple $1. I mean if it wouldn&#39;t have been an inner class but just an anonymous class then its name would have been simply $1?"
            },
            {
              "owner": {
                "reputation": 2495,
                "user_id": 12952113,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0cd304694ce77e4951fd0636d8bc0474?s=128&d=identicon&r=PG&f=1",
                "display_name": "Alex",
                "link": "https://stackoverflow.com/users/12952113/alex"
              },
              "score": 0,
              "creation_date": 1615480216,
              "post_id": 66585524,
              "comment_id": 117709177,
              "body_markdown": "Well, actually the name of the class is just `1`. The full binary name of the class is `&lt;outerclass&gt;$&lt;innerclass&gt;`, so it&#39;s placed into `Test$1.class` file. Obviously you can&#39;t create a class with name `1` manually.",
              "body": "Well, actually the name of the class is just <code>1</code>. The full binary name of the class is <code>&lt;outerclass&gt;$&lt;innerclass&gt;</code>, so it&#39;s placed into <code>Test$1.class</code> file. Obviously you can&#39;t create a class with name <code>1</code> manually."
            },
            {
              "owner": {
                "reputation": 2495,
                "user_id": 12952113,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0cd304694ce77e4951fd0636d8bc0474?s=128&d=identicon&r=PG&f=1",
                "display_name": "Alex",
                "link": "https://stackoverflow.com/users/12952113/alex"
              },
              "score": 0,
              "creation_date": 1615480638,
              "post_id": 66585524,
              "comment_id": 117709387,
              "body_markdown": "Btw, similar idea is used for lambda&#39;s: their are just automatically generated methods with special numerical names, which cannot be created manually.",
              "body": "Btw, similar idea is used for lambda&#39;s: their are just automatically generated methods with special numerical names, which cannot be created manually."
            },
            {
              "owner": {
                "user_type": "does_not_exist",
                "display_name": "user14528515"
              },
              "score": 0,
              "creation_date": 1615480718,
              "post_id": 66585524,
              "comment_id": 117709417,
              "body_markdown": "Got it thanks for helping out.",
              "body": "Got it thanks for helping out."
            }
          ],
          "owner": {
            "reputation": 2495,
            "user_id": 12952113,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/0cd304694ce77e4951fd0636d8bc0474?s=128&d=identicon&r=PG&f=1",
            "display_name": "Alex",
            "link": "https://stackoverflow.com/users/12952113/alex"
          },
          "comment_count": 4,
          "score": 3,
          "creation_date": 1615476467,
          "answer_id": 66585524,
          "body_markdown": "While [xtratic][1] answer is correct, some additional explanation might be provided. Your code is interpreted as if you declare a new inner class which is a subclass of Test and then instantiate an object of this class:\r\n\r\n```java\r\npublic class Test {\r\n\r\n    public static Test ONE = new $1();\r\n\r\n    class $1 extends Test {\r\n        @Override\r\n        public int value() {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    private Test() {\r\n    }\r\n\r\n    public int value() {\r\n        return 0;\r\n    }\r\n}\r\n```\r\nIf you compile your Test.java you&#39;ll see that two class files are generated, Test.class and Test$1.class, the later contains the anonymous inner class which was auto-generated. The name of the anonymous class is $1, but because it&#39;s an inner class of Test the class file has name Test$1.class.\r\n\r\n\r\n  [1]: https://stackoverflow.com/users/2442526/xtratic",
          "body": "<p>While <a href=\"https://stackoverflow.com/users/2442526/xtratic\">xtratic</a> answer is correct, some additional explanation might be provided. Your code is interpreted as if you declare a new inner class which is a subclass of Test and then instantiate an object of this class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Test {\n\n    public static Test ONE = new $1();\n\n    class $1 extends Test {\n        @Override\n        public int value() {\n            return 1;\n        }\n    }\n\n    private Test() {\n    }\n\n    public int value() {\n        return 0;\n    }\n}\n</code></pre>\n<p>If you compile your Test.java you'll see that two class files are generated, Test.class and Test$1.class, the later contains the anonymous inner class which was auto-generated. The name of the anonymous class is $1, but because it's an inner class of Test the class file has name Test$1.class.</p>\n"
        }
      ],
      "owner": {
        "user_type": "does_not_exist",
        "display_name": "user14528515"
      },
      "comment_count": 4,
      "view_count": 55,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1615474693,
      "question_id": 66585058,
      "body_markdown": "I came across this piece of code while I was working on a project, this was reported as a bug for something.\r\n```\r\npublic class Test {\r\n\r\n    public static Test ONE = new Test() {\r\n        @Override\r\n        public int value() {\r\n            return 1;\r\n        }\r\n    };\r\n\r\n    private Test() {\r\n    }\r\n\r\n    public int value() {\r\n        return 0;\r\n    }\r\n}\r\n```\r\n**What I think this code means:**&lt;br /&gt;\r\nI think that this is simply instantiating the class `Test` with a reference variable named `ONE`.&lt;br /&gt;\r\n**What the user mentioned:**&lt;br /&gt;\r\nThe user mentioned that this is a nested class within the outer class, but I&#39;m confused that how can a class be nested within itself.&lt;br /&gt;\r\n**What I have researched:**&lt;br /&gt;\r\nI used code parser named ANTLR to parse this code and it showed that this is not a class, insted used the token Type.&lt;br /&gt; \r\nThanks in Advance \r\n",
      "title": "Is this a Nested class?",
      "body": "<p>I came across this piece of code while I was working on a project, this was reported as a bug for something.</p>\n<pre><code>public class Test {\n\n    public static Test ONE = new Test() {\n        @Override\n        public int value() {\n            return 1;\n        }\n    };\n\n    private Test() {\n    }\n\n    public int value() {\n        return 0;\n    }\n}\n</code></pre>\n<p><strong>What I think this code means:</strong><br />\nI think that this is simply instantiating the class <code>Test</code> with a reference variable named <code>ONE</code>.<br />\n<strong>What the user mentioned:</strong><br />\nThe user mentioned that this is a nested class within the outer class, but I'm confused that how can a class be nested within itself.<br />\n<strong>What I have researched:</strong><br />\nI used code parser named ANTLR to parse this code and it showed that this is not a class, insted used the token Type.<br />\nThanks in Advance</p>\n"
    },
    {
      "tags": [
        "java",
        "arrays"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 45593,
            "user_id": 3890632,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1",
            "display_name": "khelwood",
            "link": "https://stackoverflow.com/users/3890632/khelwood"
          },
          "score": 2,
          "creation_date": 1615378674,
          "post_id": 66564613,
          "comment_id": 117670976,
          "body_markdown": "You mean `Arrays.asList(new String[][] {{&quot;Slot&quot;}});` ?",
          "body": "You mean <code>Arrays.asList(new String[][] {{&quot;Slot&quot;}});</code> ?"
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 17397,
                "user_id": 5515060,
                "user_type": "registered",
                "accept_rate": 100,
                "profile_image": "https://i.stack.imgur.com/BXWsz.png?s=128&g=1",
                "display_name": "Lino",
                "link": "https://stackoverflow.com/users/5515060/lino"
              },
              "score": 2,
              "creation_date": 1615379573,
              "post_id": 66564674,
              "comment_id": 117671370,
              "body_markdown": "Another way would be to use `List&lt;String[]&gt; notWithArrays = Collections.singletonList(new String[]{&quot;Slot&quot;});`",
              "body": "Another way would be to use <code>List&lt;String[]&gt; notWithArrays = Collections.singletonList(new String[]{&quot;Slot&quot;});</code>"
            }
          ],
          "owner": {
            "reputation": 45593,
            "user_id": 3890632,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1",
            "display_name": "khelwood",
            "link": "https://stackoverflow.com/users/3890632/khelwood"
          },
          "comment_count": 1,
          "score": 6,
          "creation_date": 1615378799,
          "answer_id": 66564674,
          "body_markdown": "I think you want to create a `List&lt;String[]&gt;` using `Arrays.asList`, containing the string array `{&quot;Slot&quot;}`.\r\n\r\nYou can do that like this:\r\n\r\n    List&lt;String[]&gt; notWithArrays = Arrays.asList(new String[][] {{&quot;Slot&quot;}});\r\n\r\nor you can explicitly specify the generic type parameter to `asList`, like this:\r\n\r\n    List&lt;String[]&gt; notWithArrays = Arrays.&lt;String[]&gt;asList(new String[] {&quot;Slot&quot;});",
          "body": "<p>I think you want to create a <code>List&lt;String[]&gt;</code> using <code>Arrays.asList</code>, containing the string array <code>{&quot;Slot&quot;}</code>.</p>\n<p>You can do that like this:</p>\n<pre><code>List&lt;String[]&gt; notWithArrays = Arrays.asList(new String[][] {{&quot;Slot&quot;}});\n</code></pre>\n<p>or you can explicitly specify the generic type parameter to <code>asList</code>, like this:</p>\n<pre><code>List&lt;String[]&gt; notWithArrays = Arrays.&lt;String[]&gt;asList(new String[] {&quot;Slot&quot;});\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 476088,
            "user_id": 1968,
            "user_type": "registered",
            "accept_rate": 83,
            "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG",
            "display_name": "Konrad Rudolph",
            "link": "https://stackoverflow.com/users/1968/konrad-rudolph"
          },
          "comment_count": 0,
          "score": 4,
          "creation_date": 1615379405,
          "answer_id": 66564833,
          "body_markdown": "`Arrays.asList` has a varargs parameter, `T...`. The issue that you’re facing is that Java has two ways of calling a method with a vararg parameter:\r\n\r\n1. With multiple arguments of type `T`\r\n2. With a single argument of type `T[]`\r\n\r\nIn addition, `Arrays.asList` is generic and infers the type parameter `T` from the type of its arguments. If only a single argument of array type is given, interpretation (2) takes precedence.\r\n\r\nThis means that when you write `Arrays.asList(new String[] {&quot;x&quot;})`, Java interprets this as a call of form (2) with `T = String`.\r\n\r\nWith multiple arguments there’s no confusion: Java always interprets it as a call of form (1), and infers `T` to be of type `String[]`.\r\n\r\nSo the solution, [as khelwood has shown](https://stackoverflow.com/a/66564674/1968), is to disambiguate calls with a single argument, either by packing the argument into an additional array layer, or by explicitly specifying the generic type parameter `T`.",
          "body": "<p><code>Arrays.asList</code> has a varargs parameter, <code>T...</code>. The issue that you’re facing is that Java has two ways of calling a method with a vararg parameter:</p>\n<ol>\n<li>With multiple arguments of type <code>T</code></li>\n<li>With a single argument of type <code>T[]</code></li>\n</ol>\n<p>In addition, <code>Arrays.asList</code> is generic and infers the type parameter <code>T</code> from the type of its arguments. If only a single argument of array type is given, interpretation (2) takes precedence.</p>\n<p>This means that when you write <code>Arrays.asList(new String[] {&quot;x&quot;})</code>, Java interprets this as a call of form (2) with <code>T = String</code>.</p>\n<p>With multiple arguments there’s no confusion: Java always interprets it as a call of form (1), and infers <code>T</code> to be of type <code>String[]</code>.</p>\n<p>So the solution, <a href=\"https://stackoverflow.com/a/66564674/1968\">as khelwood has shown</a>, is to disambiguate calls with a single argument, either by packing the argument into an additional array layer, or by explicitly specifying the generic type parameter <code>T</code>.</p>\n"
        }
      ],
      "owner": {
        "reputation": 90,
        "user_id": 13029230,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/27a95994d458f7fb74677722ad9e9d42?s=128&d=identicon&r=PG&f=1",
        "display_name": "MarekUlip",
        "link": "https://stackoverflow.com/users/13029230/marekulip"
      },
      "comment_count": 1,
      "view_count": 53,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1615378551,
      "question_id": 66564613,
      "body_markdown": "I am trying to create ArrayList of arrays with method Arrays.asList but I am struggling to achieve this goal when I have only one array to pass into the list. \r\n\r\n```java\r\nList&lt;String[]&gt; notWithArrays = Arrays.asList(new String[] {&quot;Slot&quot;}); // compiler does not allow this\r\nList&lt;String[]&gt; withArrays = Arrays.asList(new String[] {&quot;Slot&quot;},new String[] {&quot;ts&quot;}); // this is ok\r\n```\r\nThe problem is that sometimes I have only one array to pass as argument and since it is only one iterable method asList creates List of strings out of it instead of required List&lt;String[]&gt;. Is there a way or method to make the list of arrays *notWithArrays* without having to create it manually?\r\n\r\nExample of creating it manually:\r\n```java\r\nList&lt;String[]&gt; withArraysManual = new ArrayList&lt;&gt;();\r\nwithArraysManual.add(new String[] {&quot;Slot&quot;});\r\n```",
      "title": "Create ArrayList of arrays using Arrays.asList",
      "body": "<p>I am trying to create ArrayList of arrays with method Arrays.asList but I am struggling to achieve this goal when I have only one array to pass into the list.</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String[]&gt; notWithArrays = Arrays.asList(new String[] {&quot;Slot&quot;}); // compiler does not allow this\nList&lt;String[]&gt; withArrays = Arrays.asList(new String[] {&quot;Slot&quot;},new String[] {&quot;ts&quot;}); // this is ok\n</code></pre>\n<p>The problem is that sometimes I have only one array to pass as argument and since it is only one iterable method asList creates List of strings out of it instead of required List&lt;String[]&gt;. Is there a way or method to make the list of arrays <em>notWithArrays</em> without having to create it manually?</p>\n<p>Example of creating it manually:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String[]&gt; withArraysManual = new ArrayList&lt;&gt;();\nwithArraysManual.add(new String[] {&quot;Slot&quot;});\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "lambda",
        "collections",
        "java-8",
        "java-stream"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 2417,
            "user_id": 865448,
            "user_type": "registered",
            "accept_rate": 82,
            "profile_image": "https://www.gravatar.com/avatar/152023fb742facb625142611b9fa7474?s=128&d=identicon&r=PG",
            "display_name": "tostao",
            "link": "https://stackoverflow.com/users/865448/tostao"
          },
          "score": 1,
          "creation_date": 1615365160,
          "post_id": 66560968,
          "comment_id": 117665219,
          "body_markdown": "What did you try so far? Please show some code.",
          "body": "What did you try so far? Please show some code."
        },
        {
          "owner": {
            "reputation": 4080,
            "user_id": 2224047,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/UZ83S.jpg?s=128&g=1",
            "display_name": "Nikolai  Shevchenko",
            "link": "https://stackoverflow.com/users/2224047/nikolai-shevchenko"
          },
          "score": 0,
          "creation_date": 1615367611,
          "post_id": 66560968,
          "comment_id": 117666221,
          "body_markdown": "@EdgarHan don&#39;t put code snippets into comments, attach them to the Question instead",
          "body": "@EdgarHan don&#39;t put code snippets into comments, attach them to the Question instead"
        },
        {
          "owner": {
            "reputation": 49,
            "user_id": 9030675,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/7c8a43711bf0de85b4954bd14e4bc011?s=128&d=identicon&r=PG&f=1",
            "display_name": "EdgarHan",
            "link": "https://stackoverflow.com/users/9030675/edgarhan"
          },
          "score": 1,
          "creation_date": 1615368208,
          "post_id": 66560968,
          "comment_id": 117666472,
          "body_markdown": "@Nikolai Shevchenko thank you, I edited my post",
          "body": "@Nikolai Shevchenko thank you, I edited my post"
        },
        {
          "owner": {
            "reputation": 488,
            "user_id": 2860981,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/35c7d7ccf38d7145cb4a47330dea7e24?s=128&d=identicon&r=PG&f=1",
            "display_name": "MK Tan",
            "link": "https://stackoverflow.com/users/2860981/mk-tan"
          },
          "score": 0,
          "creation_date": 1615372077,
          "post_id": 66560968,
          "comment_id": 117668203,
          "body_markdown": "@EdgarHan perhaps add the expected output as well.",
          "body": "@EdgarHan perhaps add the expected output as well."
        }
      ],
      "answers": [
        {
          "owner": {
            "reputation": 5056,
            "user_id": 10584605,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1",
            "display_name": "ETO",
            "link": "https://stackoverflow.com/users/10584605/eto"
          },
          "comment_count": 0,
          "score": 2,
          "creation_date": 1615371265,
          "answer_id": 66562623,
          "body_markdown": "Try this:\r\n\r\n```java\r\nMap&lt;Integer, B&gt; bMap = bList.stream()\r\n                            .collect(toMap(B::getId, identity()));\r\n\r\naList.forEach(a -&gt; a.setBList(a.getBIds()\r\n                               .stream()\r\n                               .map(bMap::get)\r\n                               .collect(toList())));\r\n```",
          "body": "<p>Try this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Map&lt;Integer, B&gt; bMap = bList.stream()\n                            .collect(toMap(B::getId, identity()));\n\naList.forEach(a -&gt; a.setBList(a.getBIds()\n                               .stream()\n                               .map(bMap::get)\n                               .collect(toList())));\n</code></pre>\n"
        }
      ],
      "owner": {
        "reputation": 49,
        "user_id": 9030675,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/7c8a43711bf0de85b4954bd14e4bc011?s=128&d=identicon&r=PG&f=1",
        "display_name": "EdgarHan",
        "link": "https://stackoverflow.com/users/9030675/edgarhan"
      },
      "comment_count": 4,
      "view_count": 63,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1615364961,
      "question_id": 66560968,
      "body_markdown": "There is two List vo class\r\n\r\n```\r\nclass A {\r\n    Integer aid;\r\n    List&lt;Integer&gt; bIds;\r\n    List&lt;B&gt; bList;\r\n}\r\n\r\nclass B {\r\n    Integer id;\r\n    String Name;\r\n}\r\n\r\nList&lt;A&gt; aList; //size:3, bIds: {2,3}, {1,2}, {3}\r\nList&lt;B&gt; bList; //id [{bId:1, ...},{bId:2, ...},{bId:3, ...},{bId:4, ...},{bId:5, ...}]\r\n```\r\n\r\nI wanna put B object in a list in each A object\r\n\r\nhow to get I do this with java stream?\r\n\r\n\r\nnot working this code \r\n\r\n```\r\n        aList.forEach(\r\n                a -&gt; {\r\n                    a.setBList(\r\n                            a.getBIds().stream()\r\n                                .flatMap(id -&gt; b.stream().filter(b -&gt; b.getId() == id))\r\n                                .collect(Collectors.toList())\r\n                    );\r\n                }\r\n        );\r\n```\r\n\r\n\r\nexpect out put\r\n```\r\n//pre\r\naList = [ \r\n {aid: 1, bIds: [2,3], bList:[]},\r\n {aid: 2, bIds: [1,2], bList:[]},\r\n {aid: 3, bIds: [3], bList:[]},\r\n\r\n]\r\n\r\n//after\r\naList = [ \r\n {aid: 1, bIds: [2,3], bList:[{bId:2 ...},{bId:3 ...}]},\r\n {aid: 2, bIds: [1,2], bList:[{bId:1 ...},{bId:2 ...}]},\r\n {aid: 3, bIds: [3], bList:[{bId:2 ...}]},\r\n]\r\n```",
      "title": "Two List merge with java 8",
      "body": "<p>There is two List vo class</p>\n<pre><code>class A {\n    Integer aid;\n    List&lt;Integer&gt; bIds;\n    List&lt;B&gt; bList;\n}\n\nclass B {\n    Integer id;\n    String Name;\n}\n\nList&lt;A&gt; aList; //size:3, bIds: {2,3}, {1,2}, {3}\nList&lt;B&gt; bList; //id [{bId:1, ...},{bId:2, ...},{bId:3, ...},{bId:4, ...},{bId:5, ...}]\n</code></pre>\n<p>I wanna put B object in a list in each A object</p>\n<p>how to get I do this with java stream?</p>\n<p>not working this code</p>\n<pre><code>        aList.forEach(\n                a -&gt; {\n                    a.setBList(\n                            a.getBIds().stream()\n                                .flatMap(id -&gt; b.stream().filter(b -&gt; b.getId() == id))\n                                .collect(Collectors.toList())\n                    );\n                }\n        );\n</code></pre>\n<p>expect out put</p>\n<pre><code>//pre\naList = [ \n {aid: 1, bIds: [2,3], bList:[]},\n {aid: 2, bIds: [1,2], bList:[]},\n {aid: 3, bIds: [3], bList:[]},\n\n]\n\n//after\naList = [ \n {aid: 1, bIds: [2,3], bList:[{bId:2 ...},{bId:3 ...}]},\n {aid: 2, bIds: [1,2], bList:[{bId:1 ...},{bId:2 ...}]},\n {aid: 3, bIds: [3], bList:[{bId:2 ...}]},\n]\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "collections",
        "java-8",
        "enums",
        "comparator"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 988,
            "user_id": 4135011,
            "user_type": "registered",
            "profile_image": "https://lh5.googleusercontent.com/-kPMk6pssDMY/AAAAAAAAAAI/AAAAAAAAANo/qyfn53EfPmo/photo.jpg?sz=128",
            "display_name": "Anurag Wagh",
            "link": "https://stackoverflow.com/users/4135011/anurag-wagh"
          },
          "comment_count": 0,
          "score": 2,
          "creation_date": 1615298570,
          "answer_id": 66548373,
          "body_markdown": "You can assign int values to enums and give them values according to the preferences you want. \r\n\r\nThen implement `Comparable` interface for your `Car` object to sort the using these assigned `int` values for each model \r\n\r\n\r\n**Code**\r\n\r\n\r\n    import java.util.ArrayList;\r\n    import java.util.List;\r\n    // assign enum values in ascending order here \r\n    enum Model {\r\n        SEDAN(0),\r\n        BMW(1),\r\n        UNICORN(2);\r\n    \r\n        private int value;\r\n    \r\n        private Model(int value) {\r\n            this.value = value;\r\n        }\r\n    \r\n        public int getValue() {\r\n            return value;\r\n        }\r\n    \r\n        public void setValue(int value) {\r\n            this.value = value;\r\n        }\r\n    }\r\n    // implement comparable class \r\n    public class Car implements Comparable&lt;Car&gt; {\r\n    \r\n        private Model model;\r\n    \r\n        private int id;\r\n    \r\n        public Car(Model model, int id) {\r\n            super();\r\n            this.model = model;\r\n            this.id = id;\r\n        }\r\n    \r\n        public Model getModel() {\r\n            return model;\r\n        }\r\n    \r\n        public void setModel(Model model) {\r\n            this.model = model;\r\n        }\r\n    \r\n        public int getId() {\r\n            return id;\r\n        }\r\n    \r\n        public void setId(int id) {\r\n            this.id = id;\r\n        }\r\n       // compare Cars by Model int value\r\n        @Override\r\n        public int compareTo(Car otherCar) {\r\n            if (this.getModel().getValue() &gt; otherCar.getModel().getValue())\r\n                return 1;\r\n            else return -1;\r\n        }\r\n    \r\n        @Override\r\n        public String toString() {\r\n            return &quot;Car{&quot; +\r\n                    &quot;model=&quot; + model +\r\n                    &quot;, id=&quot; + id +\r\n                    &#39;}&#39;;\r\n        }\r\n    }\r\n    \r\n    public static List&lt;Car&gt; l = new ArrayList&lt;Car&gt;();\r\n    Car c1 = new Car(Model.BMW, 1);\r\n    Car c2 = new Car(Model.BMW, 2);\r\n    Car c3 = new Car(Model.SEDAN, 3);\r\n    Car c4 = new Car(Model.SEDAN, 4);\r\n    Car c5 = new Car(Model.SEDAN, 5);\r\n    Car c6 = new Car(Model.UNICORN, 6);\r\n    Car c7 = new Car(Model.BMW, 7);\r\n    Car c8 = new Car(Model.BMW, 8);\r\n    \r\n    l.add(c1);\r\n    l.add(c2);\r\n    l.add(c3);\r\n    l.add(c4);\r\n    l.add(c5);\r\n    l.add(c6);\r\n    l.add(c7);\r\n    l.add(c8);\r\n    l.sort(Car::compareTo);\r\n    l;\r\n\r\n\r\n**Output**\r\n\r\n    [Car{model=SEDAN, id=5}, \r\n    Car{model=SEDAN, id=4}, \r\n    Car{model=SEDAN, id=3}, \r\n    Car{model=BMW, id=8},\r\n    Car{model=BMW, id=7}, \r\n    Car{model=BMW, id=2}, \r\n    Car{model=BMW, id=1}, \r\n    Car{model=UNICORN, id=6}]\r\n\r\n",
          "body": "<p>You can assign int values to enums and give them values according to the preferences you want.</p>\n<p>Then implement <code>Comparable</code> interface for your <code>Car</code> object to sort the using these assigned <code>int</code> values for each model</p>\n<p><strong>Code</strong></p>\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n// assign enum values in ascending order here \nenum Model {\n    SEDAN(0),\n    BMW(1),\n    UNICORN(2);\n\n    private int value;\n\n    private Model(int value) {\n        this.value = value;\n    }\n\n    public int getValue() {\n        return value;\n    }\n\n    public void setValue(int value) {\n        this.value = value;\n    }\n}\n// implement comparable class \npublic class Car implements Comparable&lt;Car&gt; {\n\n    private Model model;\n\n    private int id;\n\n    public Car(Model model, int id) {\n        super();\n        this.model = model;\n        this.id = id;\n    }\n\n    public Model getModel() {\n        return model;\n    }\n\n    public void setModel(Model model) {\n        this.model = model;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n   // compare Cars by Model int value\n    @Override\n    public int compareTo(Car otherCar) {\n        if (this.getModel().getValue() &gt; otherCar.getModel().getValue())\n            return 1;\n        else return -1;\n    }\n\n    @Override\n    public String toString() {\n        return &quot;Car{&quot; +\n                &quot;model=&quot; + model +\n                &quot;, id=&quot; + id +\n                '}';\n    }\n}\n\npublic static List&lt;Car&gt; l = new ArrayList&lt;Car&gt;();\nCar c1 = new Car(Model.BMW, 1);\nCar c2 = new Car(Model.BMW, 2);\nCar c3 = new Car(Model.SEDAN, 3);\nCar c4 = new Car(Model.SEDAN, 4);\nCar c5 = new Car(Model.SEDAN, 5);\nCar c6 = new Car(Model.UNICORN, 6);\nCar c7 = new Car(Model.BMW, 7);\nCar c8 = new Car(Model.BMW, 8);\n\nl.add(c1);\nl.add(c2);\nl.add(c3);\nl.add(c4);\nl.add(c5);\nl.add(c6);\nl.add(c7);\nl.add(c8);\nl.sort(Car::compareTo);\nl;\n</code></pre>\n<p><strong>Output</strong></p>\n<pre><code>[Car{model=SEDAN, id=5}, \nCar{model=SEDAN, id=4}, \nCar{model=SEDAN, id=3}, \nCar{model=BMW, id=8},\nCar{model=BMW, id=7}, \nCar{model=BMW, id=2}, \nCar{model=BMW, id=1}, \nCar{model=UNICORN, id=6}]\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 5056,
            "user_id": 10584605,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1",
            "display_name": "ETO",
            "link": "https://stackoverflow.com/users/10584605/eto"
          },
          "comment_count": 0,
          "score": 3,
          "creation_date": 1615300739,
          "answer_id": 66548987,
          "body_markdown": "**First approach**\r\n\r\nReorder the enum entries so the resulting order follows your requirements:\r\n```java\r\nenum Model {\r\n    SEDAN, BMW, UNICORN\r\n}\r\n```\r\nthen you can sort your list as follows:\r\n```java\r\nl.sort(Comparator.comparing(Car::getModel));\r\n```\r\nNote that enum values are compared by their order in code (i.e. `ordinal()`)\r\n\r\n----------\r\n\r\n**Second approach**\r\n\r\nAssign a value to each enum entry:\r\n```java\r\nenum Model {\r\n    SEDAN(0), BMW(1), UNICORN(2);\r\n    final int val;\r\n    Model(int val) { this.val = val; }\r\n}\r\n```\r\nthen you can sort your list as follows:\r\n```java\r\nl.sort(Comparator.comparing((Car car) -&gt; car.getModel().val));\r\n```\r\n----------",
          "body": "<p><strong>First approach</strong></p>\n<p>Reorder the enum entries so the resulting order follows your requirements:</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum Model {\n    SEDAN, BMW, UNICORN\n}\n</code></pre>\n<p>then you can sort your list as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>l.sort(Comparator.comparing(Car::getModel));\n</code></pre>\n<p>Note that enum values are compared by their order in code (i.e. <code>ordinal()</code>)</p>\n<hr />\n<p><strong>Second approach</strong></p>\n<p>Assign a value to each enum entry:</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum Model {\n    SEDAN(0), BMW(1), UNICORN(2);\n    final int val;\n    Model(int val) { this.val = val; }\n}\n</code></pre>\n<p>then you can sort your list as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>l.sort(Comparator.comparing((Car car) -&gt; car.getModel().val));\n</code></pre>\n<hr />\n"
        }
      ],
      "owner": {
        "reputation": 105,
        "user_id": 14820140,
        "user_type": "registered",
        "profile_image": "https://lh5.googleusercontent.com/-Gm5T3JLO_H4/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucm5IvoBYdEJ_8z-uOON4iIIufxB3Q/s96-c/photo.jpg?sz=128",
        "display_name": "Starbucks Admin",
        "link": "https://stackoverflow.com/users/14820140/starbucks-admin"
      },
      "comment_count": 0,
      "view_count": 55,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1615297543,
      "question_id": 66548092,
      "body_markdown": "I am using java 8. I have a list of car objects . I want to sort them in a specific order.  \r\neach car objects belong to a model . i like to sort the list of car objects by model. The sorted list should be in the following order , cars with models SEDAN, then followed by BMW and then UNICORN. \r\n\r\n\r\n\r\n    import java.util.ArrayList;\r\n    import java.util.List;\r\n    \r\n    enum Model {\r\n    \r\n    \tBMW, SEDAN, UNICORN\r\n    \r\n    }\r\n    \r\n    public class Car {\r\n    \r\n    \tprivate Model model;\r\n    \r\n    \tprivate int id;\r\n    \r\n    \tpublic Car(Model model, int id) {\r\n    \t\tsuper();\r\n    \t\tthis.model = model;\r\n    \t\tthis.id = id;\r\n    \t}\r\n    \r\n    \tpublic Model getModel() {\r\n    \t\treturn model;\r\n    \t}\r\n    \r\n    \tpublic void setModel(Model model) {\r\n    \t\tthis.model = model;\r\n    \t}\r\n    \r\n    \tpublic int getId() {\r\n    \t\treturn id;\r\n    \t}\r\n    \r\n    \tpublic void setId(int id) {\r\n    \t\tthis.id = id;\r\n    \t}\r\n    \r\n    \tpublic static void main(String[] args) {\r\n    \r\n    \t\tList&lt;Car&gt; l = new ArrayList&lt;Car&gt;();\r\n    \r\n    \t\tCar c1 = new Car(Model.BMW, 1);\r\n    \t\tCar c2 = new Car(Model.BMW, 2);\r\n    \t\tCar c3 = new Car(Model.SEDAN, 3);\r\n    \t\tCar c4 = new Car(Model.SEDAN, 4);\r\n    \t\tCar c5 = new Car(Model.SEDAN, 5);\r\n    \t\tCar c6 = new Car(Model.UNICORN, 6);\r\n    \t\tCar c7 = new Car(Model.BMW, 7);\r\n    \t\tCar c8 = new Car(Model.BMW, 8);\r\n    \r\n    \t\tl.add(c1);\r\n    \t\tl.add(c2);\r\n    \t\tl.add(c3);\r\n    \t\tl.add(c4);\r\n    \t\tl.add(c5);\r\n    \t\tl.add(c6);\r\n    \t\tl.add(c7);\r\n    \t\tl.add(c8);\r\n    \t}\r\n    }\r\n\r\nso when i print the sorted list it should be like this \r\n\r\n    [Car [model=SEDAN, id=3],  Car [model=SEDAN, id=4]  ,Car [model=SEDAN, id=5],  [model=BMW, id=1], Car [model=BMW, id=2], Car [model=BMW, id=7], Car [model=BMW, id=8],  Car [model=UNICORN, id=6]]\r\n\r\n How can i achieve this order of sorting on the model enum with a custom comparator.\r\n\r\nappreciate if you can help\r\n",
      "title": "How to sort a list of objects by contained enum?",
      "body": "<p>I am using java 8. I have a list of car objects . I want to sort them in a specific order.<br />\neach car objects belong to a model . i like to sort the list of car objects by model. The sorted list should be in the following order , cars with models SEDAN, then followed by BMW and then UNICORN.</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n\nenum Model {\n\n    BMW, SEDAN, UNICORN\n\n}\n\npublic class Car {\n\n    private Model model;\n\n    private int id;\n\n    public Car(Model model, int id) {\n        super();\n        this.model = model;\n        this.id = id;\n    }\n\n    public Model getModel() {\n        return model;\n    }\n\n    public void setModel(Model model) {\n        this.model = model;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public static void main(String[] args) {\n\n        List&lt;Car&gt; l = new ArrayList&lt;Car&gt;();\n\n        Car c1 = new Car(Model.BMW, 1);\n        Car c2 = new Car(Model.BMW, 2);\n        Car c3 = new Car(Model.SEDAN, 3);\n        Car c4 = new Car(Model.SEDAN, 4);\n        Car c5 = new Car(Model.SEDAN, 5);\n        Car c6 = new Car(Model.UNICORN, 6);\n        Car c7 = new Car(Model.BMW, 7);\n        Car c8 = new Car(Model.BMW, 8);\n\n        l.add(c1);\n        l.add(c2);\n        l.add(c3);\n        l.add(c4);\n        l.add(c5);\n        l.add(c6);\n        l.add(c7);\n        l.add(c8);\n    }\n}\n</code></pre>\n<p>so when i print the sorted list it should be like this</p>\n<pre><code>[Car [model=SEDAN, id=3],  Car [model=SEDAN, id=4]  ,Car [model=SEDAN, id=5],  [model=BMW, id=1], Car [model=BMW, id=2], Car [model=BMW, id=7], Car [model=BMW, id=8],  Car [model=UNICORN, id=6]]\n</code></pre>\n<p>How can i achieve this order of sorting on the model enum with a custom comparator.</p>\n<p>appreciate if you can help</p>\n"
    },
    {
      "tags": [
        "java",
        "for-loop",
        "collections",
        "java-8",
        "java-stream"
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 145,
                "user_id": 9649220,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/080310d2b79d009480666458ffa1e4b5?s=128&d=identicon&r=PG&f=1",
                "display_name": "coder Tester",
                "link": "https://stackoverflow.com/users/9649220/coder-tester"
              },
              "score": 0,
              "creation_date": 1615321277,
              "post_id": 66546836,
              "comment_id": 117653971,
              "body_markdown": "That&#39;s perfect, thanks for the explanation, i got it :D",
              "body": "That&#39;s perfect, thanks for the explanation, i got it :D"
            }
          ],
          "owner": {
            "reputation": 5056,
            "user_id": 10584605,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/LEgo9.jpg?s=128&g=1",
            "display_name": "ETO",
            "link": "https://stackoverflow.com/users/10584605/eto"
          },
          "comment_count": 1,
          "score": 4,
          "creation_date": 1615292710,
          "answer_id": 66546836,
          "body_markdown": "Let&#39;s do it step by step.\r\n\r\n1. How can you get the price of an order line?\r\n```java\r\nBigDecimal getPrice(OrderLine orderLine) {\r\n    return orderLine.getProduct()\r\n                    .getPrice()\r\n                    .multiply(BigDecimal.valueOf(orderLine.getQuantity()));\r\n}\r\n```\r\n2. How can you get the total price of an order?\r\n```java\r\nBigDecimal getPrice(Order order) {\r\n    return order.getOrderLines()\r\n                .stream()\r\n                .map(orderLine -&gt; getPrice(orderLine))\r\n                .collect(reducing(BigDecimal.ZERO, BigDecimal::add));\r\n}\r\n```\r\n3. Now assuming you have implemented the methods above, how can you determine the total money spent per each customer?\r\n```java\r\nMap&lt;Customer, BigDecimal&gt; totalPerCustomer =\r\n    orders.stream()\r\n          .collect(groupingBy(Order::getCustomer,\r\n                              reducing(BigDecimal.ZERO, o -&gt; getPrice(o), BigDecimal::add)));\r\n```\r\n4. Now as you have all the information stored in a convenient map, how can you determine which customer spent the most money?\r\n```java\r\nOptional&lt;Customer&gt; topCustomer = \r\n    totalPerCustomer.entrySet()\r\n                    .stream()\r\n                    .max(Map.Entry.comparingByValue())\r\n                    .map(Map.Entry::getKey);\r\n```\r\nNote that `topCustomer` will be equal to `Optional.empty()` if the list of orders is empty.",
          "body": "<p>Let's do it step by step.</p>\n<ol>\n<li>How can you get the price of an order line?</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>BigDecimal getPrice(OrderLine orderLine) {\n    return orderLine.getProduct()\n                    .getPrice()\n                    .multiply(BigDecimal.valueOf(orderLine.getQuantity()));\n}\n</code></pre>\n<ol start=\"2\">\n<li>How can you get the total price of an order?</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>BigDecimal getPrice(Order order) {\n    return order.getOrderLines()\n                .stream()\n                .map(orderLine -&gt; getPrice(orderLine))\n                .collect(reducing(BigDecimal.ZERO, BigDecimal::add));\n}\n</code></pre>\n<ol start=\"3\">\n<li>Now assuming you have implemented the methods above, how can you determine the total money spent per each customer?</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>Map&lt;Customer, BigDecimal&gt; totalPerCustomer =\n    orders.stream()\n          .collect(groupingBy(Order::getCustomer,\n                              reducing(BigDecimal.ZERO, o -&gt; getPrice(o), BigDecimal::add)));\n</code></pre>\n<ol start=\"4\">\n<li>Now as you have all the information stored in a convenient map, how can you determine which customer spent the most money?</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>Optional&lt;Customer&gt; topCustomer = \n    totalPerCustomer.entrySet()\n                    .stream()\n                    .max(Map.Entry.comparingByValue())\n                    .map(Map.Entry::getKey);\n</code></pre>\n<p>Note that <code>topCustomer</code> will be equal to <code>Optional.empty()</code> if the list of orders is empty.</p>\n"
        }
      ],
      "owner": {
        "reputation": 145,
        "user_id": 9649220,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/080310d2b79d009480666458ffa1e4b5?s=128&d=identicon&r=PG&f=1",
        "display_name": "coder Tester",
        "link": "https://stackoverflow.com/users/9649220/coder-tester"
      },
      "comment_count": 0,
      "view_count": 60,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1615284409,
      "question_id": 66544780,
      "body_markdown": "I have this problem that I need to solve using Java 8 streams, but so far I have not succeeded.\r\n\r\nI have:\r\n\r\n    public class Customer {\r\n       String id;\r\n       String firstName;\r\n       String lastName;\r\n    }\r\n\r\n    public class Order {\r\n       private final String id;\r\n       Set&lt;OrderLine&gt; orderLines = new HashSet&lt;&gt;();\r\n       Customer customer;\r\n    }\r\n\r\n    public class OrderLine {\r\n       Product product;\r\n       Integer quantity;\r\n    }\r\n\r\n    public class Product {\r\n       String name;\r\n       BigDecimal price;\r\n    }\r\n\r\nAll objects have their own equals implemented so its possible to compare objects.\r\n\r\nThis is the data that i have to iterate from:\r\n\r\n        List&lt;Order&gt; orders = new ArrayList&lt;&gt;();\r\n        Customer customer1 = new Customer(randomId(), &quot;Will&quot;, &quot;Sanders&quot;);\r\n        Customer customer2 = new Customer(randomId(), &quot;Jonh&quot;, &quot;Doe&quot;);\r\n        Product p1 = new Product(&quot;Book 1&quot;, new BigDecimal(&quot;50.00&quot;));\r\n        Product p2 = new Product(&quot;Book 2&quot;, new BigDecimal(&quot;19.00&quot;));\r\n        Product p3 = new Product(&quot;Book 3&quot;, new BigDecimal(&quot;100.00&quot;));\r\n        orders.add(new Order(randomId(), customer1).addOrderLine(p1, 1));\r\n        orders.add(new Order(randomId(), customer1).addOrderLine(p2, 1));\r\n        orders.add(new Order(randomId(), customer2).addOrderLine(p3, 1));\r\n\r\nAnd i want to know which customer has given more money to the company.\r\n\r\nI have solved this using a foreach like this:\r\n\r\n    \torders.forEach(order -&gt; {\r\n    \t\t\r\n    \t\torder.getOrderLines().forEach(orderLine -&gt; {\t\t\r\n    \t\t\t\r\n    \t\t    if(!map.containsKey(order.getCustomer())) {\r\n    \t\t    \tmap.put(order.getCustomer(), orderLine.getProduct().getPrice());\r\n    \t\t    } else {\r\n    \t\t    \tmap.put(order.getCustomer(),map.get(order.getCustomer()).add(orderLine.getProduct().getPrice()));\r\n    \t\t    }\r\n    \t\t});\r\n    \t});\r\n                \r\n    \tCustomer c = Collections.max(map.entrySet(), Comparator.comparing(Map.Entry::getValue)).getKey();\r\n\r\n\r\nbut i would like to know a way to solve this with streams.\r\n\r\nMy first thought was transforming this\r\na Map&lt;Customer,BigDecimal&gt;, where that BigDecimal value would be the sum of all customer purchases.\r\n\r\nAny Sugestions?\r\n\r\nThanks.\r\n\r\n",
      "title": "How to reduce a list of nested objects into a Map",
      "body": "<p>I have this problem that I need to solve using Java 8 streams, but so far I have not succeeded.</p>\n<p>I have:</p>\n<pre><code>public class Customer {\n   String id;\n   String firstName;\n   String lastName;\n}\n\npublic class Order {\n   private final String id;\n   Set&lt;OrderLine&gt; orderLines = new HashSet&lt;&gt;();\n   Customer customer;\n}\n\npublic class OrderLine {\n   Product product;\n   Integer quantity;\n}\n\npublic class Product {\n   String name;\n   BigDecimal price;\n}\n</code></pre>\n<p>All objects have their own equals implemented so its possible to compare objects.</p>\n<p>This is the data that i have to iterate from:</p>\n<pre><code>    List&lt;Order&gt; orders = new ArrayList&lt;&gt;();\n    Customer customer1 = new Customer(randomId(), &quot;Will&quot;, &quot;Sanders&quot;);\n    Customer customer2 = new Customer(randomId(), &quot;Jonh&quot;, &quot;Doe&quot;);\n    Product p1 = new Product(&quot;Book 1&quot;, new BigDecimal(&quot;50.00&quot;));\n    Product p2 = new Product(&quot;Book 2&quot;, new BigDecimal(&quot;19.00&quot;));\n    Product p3 = new Product(&quot;Book 3&quot;, new BigDecimal(&quot;100.00&quot;));\n    orders.add(new Order(randomId(), customer1).addOrderLine(p1, 1));\n    orders.add(new Order(randomId(), customer1).addOrderLine(p2, 1));\n    orders.add(new Order(randomId(), customer2).addOrderLine(p3, 1));\n</code></pre>\n<p>And i want to know which customer has given more money to the company.</p>\n<p>I have solved this using a foreach like this:</p>\n<pre><code>    orders.forEach(order -&gt; {\n        \n        order.getOrderLines().forEach(orderLine -&gt; {        \n            \n            if(!map.containsKey(order.getCustomer())) {\n                map.put(order.getCustomer(), orderLine.getProduct().getPrice());\n            } else {\n                map.put(order.getCustomer(),map.get(order.getCustomer()).add(orderLine.getProduct().getPrice()));\n            }\n        });\n    });\n            \n    Customer c = Collections.max(map.entrySet(), Comparator.comparing(Map.Entry::getValue)).getKey();\n</code></pre>\n<p>but i would like to know a way to solve this with streams.</p>\n<p>My first thought was transforming this\na Map&lt;Customer,BigDecimal&gt;, where that BigDecimal value would be the sum of all customer purchases.</p>\n<p>Any Sugestions?</p>\n<p>Thanks.</p>\n"
    },
    {
      "tags": [
        "java",
        "oop",
        "functional-programming",
        "polymorphism",
        "dynamic-dispatch"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 630,
            "user_id": 9630366,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/JG9mq.png?s=128&g=1",
            "display_name": "salazarin",
            "link": "https://stackoverflow.com/users/9630366/salazarin"
          },
          "score": 0,
          "creation_date": 1615277812,
          "post_id": 66543106,
          "comment_id": 117634785,
          "body_markdown": "Does this answer your question https://stackoverflow.com/questions/20783266/what-is-the-difference-between-dynamic-and-static-polymorphism-in-java ?",
          "body": "Does this answer your question <a href=\"https://stackoverflow.com/questions/20783266/what-is-the-difference-between-dynamic-and-static-polymorphism-in-java\" title=\"what is the difference between dynamic and static polymorphism in java\">stackoverflow.com/questions/20783266/&hellip;</a> ?"
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615278005,
          "post_id": 66543106,
          "comment_id": 117634865,
          "body_markdown": "@salazarin I think I basically understand the differences between static and dynamic polymorphism, but I still do not understand when is dynamic polymorphism necessary.",
          "body": "@salazarin I think I basically understand the differences between static and dynamic polymorphism, but I still do not understand when is dynamic polymorphism necessary."
        },
        {
          "owner": {
            "reputation": 9572,
            "user_id": 4621513,
            "user_type": "registered",
            "accept_rate": 77,
            "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1",
            "display_name": "mkrieger1",
            "link": "https://stackoverflow.com/users/4621513/mkrieger1"
          },
          "score": 0,
          "creation_date": 1615278130,
          "post_id": 66543106,
          "comment_id": 117634925,
          "body_markdown": "&quot;Why not use ADT or union types&quot; - maybe a language doesn&#39;t have them.",
          "body": "&quot;Why not use ADT or union types&quot; - maybe a language doesn&#39;t have them."
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615278339,
          "post_id": 66543106,
          "comment_id": 117635012,
          "body_markdown": "@mkrieger1 Yes I know many OOP languages do not fully support ADT or union/intersection types. So does that mean we can safely avoid dynamic dispatching if we have them?",
          "body": "@mkrieger1 Yes I know many OOP languages do not fully support ADT or union/intersection types. So does that mean we can safely avoid dynamic dispatching if we have them?"
        },
        {
          "owner": {
            "reputation": 38361,
            "user_id": 5761558,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/b3cf04bfac11ef3ee693852eccde3b3c?s=128&d=identicon&r=PG&f=1",
            "display_name": "ernest_k",
            "link": "https://stackoverflow.com/users/5761558/ernest-k"
          },
          "score": 0,
          "creation_date": 1615278545,
          "post_id": 66543106,
          "comment_id": 117635123,
          "body_markdown": "I think you need to start with the concepts of composition (has-a) and inheritance (is-a) relationships among types. From there, if you consider that an is-a relationship can apply to a static type (the parent) and a dynamic type (the child, as in when the object is instantiated dynamically), then you begin to see that not all dynamic behavior can be statically programmed in source. This is where dynamic polymorphism adds flexibility to objects compiled separately but following the same contract.",
          "body": "I think you need to start with the concepts of composition (has-a) and inheritance (is-a) relationships among types. From there, if you consider that an is-a relationship can apply to a static type (the parent) and a dynamic type (the child, as in when the object is instantiated dynamically), then you begin to see that not all dynamic behavior can be statically programmed in source. This is where dynamic polymorphism adds flexibility to objects compiled separately but following the same contract."
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615278868,
          "post_id": 66543106,
          "comment_id": 117635255,
          "body_markdown": "@ernest_k Thank you for your suggestions. I think you prefer OOP&#39;s way to model problems(such as &#39;is-a&#39; relation). However I&#39;ve programed a lot with Haskell without this modeling approach... So does this mean that dynamic polymorphism is only useful under OOP&#39;s framework even though we may avoid them? Is there any situations where we have to use dynamic dispatching (also have to use &#39;is-a&#39; model)?",
          "body": "@ernest_k Thank you for your suggestions. I think you prefer OOP&#39;s way to model problems(such as &#39;is-a&#39; relation). However I&#39;ve programed a lot with Haskell without this modeling approach... So does this mean that dynamic polymorphism is only useful under OOP&#39;s framework even though we may avoid them? Is there any situations where we have to use dynamic dispatching (also have to use &#39;is-a&#39; model)?"
        },
        {
          "owner": {
            "reputation": 30212,
            "user_id": 719263,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG",
            "display_name": "Jean-Baptiste Yun&#232;s",
            "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"
          },
          "score": 0,
          "creation_date": 1615279029,
          "post_id": 66543106,
          "comment_id": 117635320,
          "body_markdown": "Does https://stackoverflow.com/questions/13106683/dynamic-dispatch-in-haskell answers your question?",
          "body": "Does <a href=\"https://stackoverflow.com/questions/13106683/dynamic-dispatch-in-haskell\" title=\"dynamic dispatch in haskell\">stackoverflow.com/questions/13106683/&hellip;</a> answers your question?"
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615279498,
          "post_id": 66543106,
          "comment_id": 117635495,
          "body_markdown": "@Jean-BaptisteYun&#232;s  Thank you! This question has something similar with mine. Answers of this question discussed a lot on how to implement &#39;dynamic-dispatch-like&#39; way of OOP(such as ADT or simply first-class function) but these are still not OOP&#39;s way of dynamic polymorphism... I still want some specific examples where dynamic polymorphism is necessary and cannot be replaced",
          "body": "@Jean-BaptisteYun&#232;s  Thank you! This question has something similar with mine. Answers of this question discussed a lot on how to implement &#39;dynamic-dispatch-like&#39; way of OOP(such as ADT or simply first-class function) but these are still not OOP&#39;s way of dynamic polymorphism... I still want some specific examples where dynamic polymorphism is necessary and cannot be replaced"
        },
        {
          "owner": {
            "reputation": 30212,
            "user_id": 719263,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG",
            "display_name": "Jean-Baptiste Yun&#232;s",
            "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"
          },
          "score": 1,
          "creation_date": 1615279757,
          "post_id": 66543106,
          "comment_id": 117635583,
          "body_markdown": "But if you have a framework, thus not knowing the class that will be used, the only way is to use a dynamic dispatch, no? You must also know that &quot;dynamic&quot; dispatch is a semantic explanation, the trick is that a single indirection is sufficient (c++ vptr) to implement it (meaning that there is no complex &quot;function searching&quot; algorithm). The cost is constant.",
          "body": "But if you have a framework, thus not knowing the class that will be used, the only way is to use a dynamic dispatch, no? You must also know that &quot;dynamic&quot; dispatch is a semantic explanation, the trick is that a single indirection is sufficient (c++ vptr) to implement it (meaning that there is no complex &quot;function searching&quot; algorithm). The cost is constant."
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615280076,
          "post_id": 66543106,
          "comment_id": 117635689,
          "body_markdown": "@Jean-BaptisteYun&#232;s What do you mean by &#39;not knowing the class that will be used&#39;? Does that mean that we only know the object&#39;s methods&#39; names but we have no idea of its real type(or we only know its interface)? I think this is weird. Does this situation only appears in OOP&#39;s world? I understand vptr is sufficient, however, static polymorphism actually has no overhead compared with dynamic dispatching.",
          "body": "@Jean-BaptisteYun&#232;s What do you mean by &#39;not knowing the class that will be used&#39;? Does that mean that we only know the object&#39;s methods&#39; names but we have no idea of its real type(or we only know its interface)? I think this is weird. Does this situation only appears in OOP&#39;s world? I understand vptr is sufficient, however, static polymorphism actually has no overhead compared with dynamic dispatching."
        },
        {
          "owner": {
            "reputation": 30212,
            "user_id": 719263,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG",
            "display_name": "Jean-Baptiste Yun&#232;s",
            "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"
          },
          "score": 0,
          "creation_date": 1615280418,
          "post_id": 66543106,
          "comment_id": 117635833,
          "body_markdown": "@Ireina &quot;we only know the object&#39;s methods&#39; names but we have no idea of its real type&quot;. Yes that&#39;s it! Very common in OOP that specifically focus on this kind of property...",
          "body": "@Ireina &quot;we only know the object&#39;s methods&#39; names but we have no idea of its real type&quot;. Yes that&#39;s it! Very common in OOP that specifically focus on this kind of property..."
        },
        {
          "owner": {
            "reputation": 235351,
            "user_id": 2711488,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1",
            "display_name": "Holger",
            "link": "https://stackoverflow.com/users/2711488/holger"
          },
          "score": 1,
          "creation_date": 1615280736,
          "post_id": 66543106,
          "comment_id": 117635979,
          "body_markdown": "Let’s take a very simple example, a user interface. All implementations I know of have a tree structure, its nodes having a certain compile-time base type but actual sub types determining their appearance and behavior. I have no idea how an implementation of a real life UI not using this kind of polymorphism would look like.",
          "body": "Let’s take a very simple example, a user interface. All implementations I know of have a tree structure, its nodes having a certain compile-time base type but actual sub types determining their appearance and behavior. I have no idea how an implementation of a real life UI not using this kind of polymorphism would look like."
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615280967,
          "post_id": 66543106,
          "comment_id": 117636079,
          "body_markdown": "@Holger Thank you for your example. However, you can still use ADT to implement this without dynamic overhead. The only difference I see is that OOP&#39;s way can extend node types easily.",
          "body": "@Holger Thank you for your example. However, you can still use ADT to implement this without dynamic overhead. The only difference I see is that OOP&#39;s way can extend node types easily."
        },
        {
          "owner": {
            "reputation": 235351,
            "user_id": 2711488,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1",
            "display_name": "Holger",
            "link": "https://stackoverflow.com/users/2711488/holger"
          },
          "score": 2,
          "creation_date": 1615283461,
          "post_id": 66543106,
          "comment_id": 117637115,
          "body_markdown": "I doubt that a recursively defined algebraic data type for an arbitrarily large and deep tree will perform better than a plain tree with dynamic dispatch. That depends a lot on the compiler’s ability to transform this definition into something entirely different under the hood. The result wouldn’t be so different to what the OOP code produces.",
          "body": "I doubt that a recursively defined algebraic data type for an arbitrarily large and deep tree will perform better than a plain tree with dynamic dispatch. That depends a lot on the compiler’s ability to transform this definition into something entirely different under the hood. The result wouldn’t be so different to what the OOP code produces."
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "score": 0,
          "creation_date": 1615291978,
          "post_id": 66543106,
          "comment_id": 117640597,
          "body_markdown": "Thank you, I agree with you. Now I consider OOP&#39;s way may have a better scalability under normal OO framework and this topic may be a little complicated.",
          "body": "Thank you, I agree with you. Now I consider OOP&#39;s way may have a better scalability under normal OO framework and this topic may be a little complicated."
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 83,
                "user_id": 15149707,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
                "display_name": "Ireina",
                "link": "https://stackoverflow.com/users/15149707/ireina"
              },
              "score": 0,
              "creation_date": 1615344384,
              "post_id": 66553765,
              "comment_id": 117660030,
              "body_markdown": "Thank you very much! Higher-order functions are awesome! However, with polymorphism, I&#39;d like to use the same function name with various kinds of parameters(of different types). In Haskell, the only way I see is to through typeclasses(via static overloading) or just generics(limited) which is quite different compared with OOP&#39;s dynamic dispatching. Therefore In haskell, we may simulate &#39;OOP-like&#39; dynamic polymorphism. However, Is there any cases I have to use this instead of simple static overloading?",
              "body": "Thank you very much! Higher-order functions are awesome! However, with polymorphism, I&#39;d like to use the same function name with various kinds of parameters(of different types). In Haskell, the only way I see is to through typeclasses(via static overloading) or just generics(limited) which is quite different compared with OOP&#39;s dynamic dispatching. Therefore In haskell, we may simulate &#39;OOP-like&#39; dynamic polymorphism. However, Is there any cases I have to use this instead of simple static overloading?"
            }
          ],
          "owner": {
            "reputation": 236,
            "user_id": 11912342,
            "user_type": "registered",
            "profile_image": "https://lh4.googleusercontent.com/-5dzZhq7CXLY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAh8_2B9P8QjtK73Qj0O67uJWqPg/photo.jpg?sz=128",
            "display_name": "Mark Saving",
            "link": "https://stackoverflow.com/users/11912342/mark-saving"
          },
          "comment_count": 1,
          "score": 5,
          "creation_date": 1615319299,
          "answer_id": 66553765,
          "body_markdown": "In Haskell, we replace &quot;dynamic polymorphism&quot; with higher-order functions. \r\n\r\nConsider the following problem: we want to define a type which denotes a predicate. We will eventually use this type Predicate when we implement our Lists so that we can define the filter function. We would like to be able to easily define the equality predicate, the less-than predicate, and be able to combine two predicates by joining them with &quot;and&quot;.\r\n\r\nA reasonable Java attempt would look like this.\r\n\r\n```java\r\ninterface Predicate&lt;T&gt; {\r\n    public abstract boolean predicate(T x);\r\n}\r\n\r\nclass EqualsPredicate&lt;T&gt; implements Predicate&lt;T&gt; {\r\n    private final T value;\r\n\r\n    public EqualsPredicate(T value) {\r\n        this.value = value;\r\n    }\r\n\r\n    @Override\r\n    public boolean predicate(T x) {\r\n        return this.value.equals(x);\r\n    }\r\n}\r\n\r\nclass LessPredicate&lt;T implements Comparable&lt;T&gt;&gt; implements Predicate&lt;T&gt;{\r\n    private final T value;\r\n\r\n    public LessPredicate(T value) {\r\n        this.value = value;\r\n    }\r\n\r\n    @Override\r\n    public boolean predicate(T x) {\r\n        return this.value.compareTo(x) &lt; 0;\r\n    }\r\n}\r\n\r\nclass AndPredicate&lt;T&gt; implements Predicate&lt;T&gt; {\r\n    private final Predicate&lt;T&gt; p1;\r\n    private final Predicate&lt;T&gt; p2;\r\n\r\n    public AndPredicate(Predicate&lt;T&gt; p1, Predicate&lt;T&gt; p2) {\r\n        this.p1 = p1;\r\n        this.p2 = p2;\r\n    }\r\n\r\n    @Override\r\n    public boolean predicate(T x) {\r\n        return p1.predicate(x) &amp;&amp; p2.predicate(x);\r\n    }\r\n}\r\n```\r\n\r\nIn Haskell, the answer to this conundrum is obvious. We just define\r\n\r\n```haskell\r\ntype Predicate t = t -&gt; Bool\r\n\r\nmakeEqualsPredicate :: Eq t =&gt; t -&gt; Predicate t\r\nmakeEqualsPredicate = (==)\r\n\r\nmakeLessPredicate :: Ord t =&gt; t -&gt; Predicate t\r\nmakeLessPredicate = (&lt;)\r\n\r\nmakeAndPredicate :: Predicate t -&gt; Predicate t -&gt; Predicate t\r\nmakeAndPredicate p1 p2 x = p1 x &amp;&amp; p2 x\r\n-- or, even more succinctly, makeAndPredicate = liftA2 (&amp;&amp;)\r\n```\r\n\r\nJava allows &quot;dynamic dispatch&quot; of methods through subclassing. Haskell allows &quot;dynamic dispatch&quot; of functions through higher-order functions.\r\n\r\nBut wait, you say. Predicate&lt;T&gt; was an interface with only one method. What should we do if we want to have two methods?\r\n\r\nWell, if an interface with one method corresponds to a function, an interface with two methods must correspond to a pair of functions. This is just the OOP principle known as &quot;composition over inheritance&quot;.\r\n\r\nSo we can always replace Java-style dynamic polymorphism with Haskell-style higher-order functions.\r\n\r\nIn fact, you actually see this observation in modern Java as well. As of Java 8, you can add the annotation `@FunctionalInterface` to an interface with one method, which permits you to create instances of that interface using lambdas. So you could write in Java 8\r\n\r\n```java\r\n@FunctionalInterface\r\ninterface Predicate&lt;T&gt; {\r\n    public abstract boolean predicate(T x);\r\n\r\n    public static Predicate&lt;J&gt; makeEqualsPredicate(J t) {\r\n        return (x) -&gt; t.equals(x);\r\n    }\r\n\r\n    public static Predicate&lt;J implements Comparable&lt;J&gt;&gt; makeLessPredicate(J t) {\r\n        return (x) -&gt; t.compareTo(x) &lt; 0;\r\n    }\r\n\r\n    public Predicate&lt;T&gt; makeAndPredicate(Predicate&lt;T&gt; other) {\r\n        return (x) -&gt; this.predicate(x) &amp;&amp; other.predicate(x);\r\n    }\r\n}\r\n```\r\n",
          "body": "<p>In Haskell, we replace &quot;dynamic polymorphism&quot; with higher-order functions.</p>\n<p>Consider the following problem: we want to define a type which denotes a predicate. We will eventually use this type Predicate when we implement our Lists so that we can define the filter function. We would like to be able to easily define the equality predicate, the less-than predicate, and be able to combine two predicates by joining them with &quot;and&quot;.</p>\n<p>A reasonable Java attempt would look like this.</p>\n<pre class=\"lang-java prettyprint-override\"><code>interface Predicate&lt;T&gt; {\n    public abstract boolean predicate(T x);\n}\n\nclass EqualsPredicate&lt;T&gt; implements Predicate&lt;T&gt; {\n    private final T value;\n\n    public EqualsPredicate(T value) {\n        this.value = value;\n    }\n\n    @Override\n    public boolean predicate(T x) {\n        return this.value.equals(x);\n    }\n}\n\nclass LessPredicate&lt;T implements Comparable&lt;T&gt;&gt; implements Predicate&lt;T&gt;{\n    private final T value;\n\n    public LessPredicate(T value) {\n        this.value = value;\n    }\n\n    @Override\n    public boolean predicate(T x) {\n        return this.value.compareTo(x) &lt; 0;\n    }\n}\n\nclass AndPredicate&lt;T&gt; implements Predicate&lt;T&gt; {\n    private final Predicate&lt;T&gt; p1;\n    private final Predicate&lt;T&gt; p2;\n\n    public AndPredicate(Predicate&lt;T&gt; p1, Predicate&lt;T&gt; p2) {\n        this.p1 = p1;\n        this.p2 = p2;\n    }\n\n    @Override\n    public boolean predicate(T x) {\n        return p1.predicate(x) &amp;&amp; p2.predicate(x);\n    }\n}\n</code></pre>\n<p>In Haskell, the answer to this conundrum is obvious. We just define</p>\n<pre class=\"lang-hs prettyprint-override\"><code>type Predicate t = t -&gt; Bool\n\nmakeEqualsPredicate :: Eq t =&gt; t -&gt; Predicate t\nmakeEqualsPredicate = (==)\n\nmakeLessPredicate :: Ord t =&gt; t -&gt; Predicate t\nmakeLessPredicate = (&lt;)\n\nmakeAndPredicate :: Predicate t -&gt; Predicate t -&gt; Predicate t\nmakeAndPredicate p1 p2 x = p1 x &amp;&amp; p2 x\n-- or, even more succinctly, makeAndPredicate = liftA2 (&amp;&amp;)\n</code></pre>\n<p>Java allows &quot;dynamic dispatch&quot; of methods through subclassing. Haskell allows &quot;dynamic dispatch&quot; of functions through higher-order functions.</p>\n<p>But wait, you say. Predicate was an interface with only one method. What should we do if we want to have two methods?</p>\n<p>Well, if an interface with one method corresponds to a function, an interface with two methods must correspond to a pair of functions. This is just the OOP principle known as &quot;composition over inheritance&quot;.</p>\n<p>So we can always replace Java-style dynamic polymorphism with Haskell-style higher-order functions.</p>\n<p>In fact, you actually see this observation in modern Java as well. As of Java 8, you can add the annotation <code>@FunctionalInterface</code> to an interface with one method, which permits you to create instances of that interface using lambdas. So you could write in Java 8</p>\n<pre class=\"lang-java prettyprint-override\"><code>@FunctionalInterface\ninterface Predicate&lt;T&gt; {\n    public abstract boolean predicate(T x);\n\n    public static Predicate&lt;J&gt; makeEqualsPredicate(J t) {\n        return (x) -&gt; t.equals(x);\n    }\n\n    public static Predicate&lt;J implements Comparable&lt;J&gt;&gt; makeLessPredicate(J t) {\n        return (x) -&gt; t.compareTo(x) &lt; 0;\n    }\n\n    public Predicate&lt;T&gt; makeAndPredicate(Predicate&lt;T&gt; other) {\n        return (x) -&gt; this.predicate(x) &amp;&amp; other.predicate(x);\n    }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 83,
            "user_id": 15149707,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
            "display_name": "Ireina",
            "link": "https://stackoverflow.com/users/15149707/ireina"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615463784,
          "answer_id": 66582089,
          "body_markdown": "With many people&#39;s help, currently I&#39;ve got some of answers I want after reflecting lots of designs. Since *Rust* has both nice support for static and dynamic polymorphism, I shall use *Rust* in this answer to demonstrate my points.\r\n\r\nI now have 2 points for *dynamic dispatch*: **user-friendly scalability** and **smaller compiled size** .\r\n\r\n## Point 1: user-friendly scalability\r\nMany people argue that *dynamic dispatch* is suitable for a situation where you have a container to collect various kinds of objects(of course, different types). For example:\r\n```Rust\r\ntrait MyTrait {\r\n  fn method(&amp;self, ...) -&gt; ReturnType;\r\n}\r\n\r\ntype MyContainer = Vec&lt;Box&lt;MyTrait&gt;&gt;;\r\n\r\nfn main() {\r\n  ...\r\n  //the_container : MyContainer\r\n  the_container.iter().map(... { x.method(...) } ...) //only demo code\r\n}\r\n```\r\nIn code above, on compile time, we only know that the elements are *trait objects*, which means the program shall use a *vptr-like* strategy to find which method to use during executing the expression in the `main` function.\r\n\r\nHowever, there&#39;s another way to implement nearly the same thing:\r\n```Rust\r\nenum MyContainerTypes {\r\n  Type0 A,\r\n  Type1 B,\r\n  ...\r\n}\r\n\r\nimpl MyTrait for MyContainerType {\r\n  fn method(&amp;self, ...) -&gt; ReturnType {\r\n    match self {\r\n      Type0 a =&gt; {...},\r\n      Type1 b =&gt; {...},\r\n      ...\r\n    }\r\n  }\r\n}\r\n\r\ntype MyContainer = Vec&lt;MyContainerType&gt;;\r\n\r\nfn main() {\r\n  ...\r\n  //my_container : MyContainer\r\n  my_container.iter().map(... { x.method(...) } ...); //demo\r\n}\r\n```\r\nIn this way, no *dynamic polymorphism* is required, however, consider the following situation: You are a user of a library which has been designed and you have no access to change definitions like `enums` inside the library. Now you want to make your own type of `ContainerType` and you want to reuse codes of existed logic. If you are using *dynamic dispatch*, the work is simple: just make another `impl` of your custom container type and everything&#39;s fine. Unfortunately, if you are using the static version of the library, it may become a little hard to achieve this goal...\r\n\r\n## Point 2: Smaller compiled size\r\nLanguages like Rust may have to compile a generic function many times, once for each type it’s used with. This could make the binary large, a phenomenon called code bloat in C++ circles.\r\nLet&#39;s consider a simpler case:\r\n```Rust\r\ntrait MyTrait {\r\n  fn method(&amp;self, ...) -&gt; ReturnType;\r\n}\r\n\r\nfn f(x: MyTrait) { ... }\r\nfn g&lt;T: MyTrait&gt;(x: T) { ... }\r\n```\r\nIf you have lots of functions like function `g`, the compiled size may become larger and larger. However this should not be a big issue since most of us have the luxury of ignoring code size for plentiful memory nowadays.\r\n\r\n## Conclusion\r\nIn short, although *static polymorphism* has many advantages over *dynamic polymorphism*, there&#39;re still some corners *dynamic dispatch* can work better. Personally I really love *Haskell-like*&#39;s way to treat polymorphism(that&#39;s also why I like Rust). I don&#39;t think this can be the final best and complete answer, discussions are welcome!",
          "body": "<p>With many people's help, currently I've got some of answers I want after reflecting lots of designs. Since <em>Rust</em> has both nice support for static and dynamic polymorphism, I shall use <em>Rust</em> in this answer to demonstrate my points.</p>\n<p>I now have 2 points for <em>dynamic dispatch</em>: <strong>user-friendly scalability</strong> and <strong>smaller compiled size</strong> .</p>\n<h2>Point 1: user-friendly scalability</h2>\n<p>Many people argue that <em>dynamic dispatch</em> is suitable for a situation where you have a container to collect various kinds of objects(of course, different types). For example:</p>\n<pre><code>trait MyTrait {\n  fn method(&amp;self, ...) -&gt; ReturnType;\n}\n\ntype MyContainer = Vec&lt;Box&lt;MyTrait&gt;&gt;;\n\nfn main() {\n  ...\n  //the_container : MyContainer\n  the_container.iter().map(... { x.method(...) } ...) //only demo code\n}\n</code></pre>\n<p>In code above, on compile time, we only know that the elements are <em>trait objects</em>, which means the program shall use a <em>vptr-like</em> strategy to find which method to use during executing the expression in the <code>main</code> function.</p>\n<p>However, there's another way to implement nearly the same thing:</p>\n<pre><code>enum MyContainerTypes {\n  Type0 A,\n  Type1 B,\n  ...\n}\n\nimpl MyTrait for MyContainerType {\n  fn method(&amp;self, ...) -&gt; ReturnType {\n    match self {\n      Type0 a =&gt; {...},\n      Type1 b =&gt; {...},\n      ...\n    }\n  }\n}\n\ntype MyContainer = Vec&lt;MyContainerType&gt;;\n\nfn main() {\n  ...\n  //my_container : MyContainer\n  my_container.iter().map(... { x.method(...) } ...); //demo\n}\n</code></pre>\n<p>In this way, no <em>dynamic polymorphism</em> is required, however, consider the following situation: You are a user of a library which has been designed and you have no access to change definitions like <code>enums</code> inside the library. Now you want to make your own type of <code>ContainerType</code> and you want to reuse codes of existed logic. If you are using <em>dynamic dispatch</em>, the work is simple: just make another <code>impl</code> of your custom container type and everything's fine. Unfortunately, if you are using the static version of the library, it may become a little hard to achieve this goal...</p>\n<h2>Point 2: Smaller compiled size</h2>\n<p>Languages like Rust may have to compile a generic function many times, once for each type it’s used with. This could make the binary large, a phenomenon called code bloat in C++ circles.\nLet's consider a simpler case:</p>\n<pre><code>trait MyTrait {\n  fn method(&amp;self, ...) -&gt; ReturnType;\n}\n\nfn f(x: MyTrait) { ... }\nfn g&lt;T: MyTrait&gt;(x: T) { ... }\n</code></pre>\n<p>If you have lots of functions like function <code>g</code>, the compiled size may become larger and larger. However this should not be a big issue since most of us have the luxury of ignoring code size for plentiful memory nowadays.</p>\n<h2>Conclusion</h2>\n<p>In short, although <em>static polymorphism</em> has many advantages over <em>dynamic polymorphism</em>, there're still some corners <em>dynamic dispatch</em> can work better. Personally I really love <em>Haskell-like</em>'s way to treat polymorphism(that's also why I like Rust). I don't think this can be the final best and complete answer, discussions are welcome!</p>\n"
        }
      ],
      "owner": {
        "reputation": 83,
        "user_id": 15149707,
        "user_type": "registered",
        "profile_image": "https://i.stack.imgur.com/SPI0Z.jpg?s=128&g=1",
        "display_name": "Ireina",
        "link": "https://stackoverflow.com/users/15149707/ireina"
      },
      "comment_count": 15,
      "view_count": 88,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1615277755,
      "question_id": 66543106,
      "body_markdown": "I come from functional languages (e.g. Haskell) and I enjoy a lot on *typeclasses* to achieve polymorphism which is also a structural approach to implement ad-hoc overloading.\r\n\r\nHowever, recently I&#39;m starting to understand **OOP**&#39;s way to model real problems and I&#39;m curious why do we need **dynamic polymorphism** in OOP languages (such as Java). In my experience, most of function call can be resolved during compile time as many functional languages do not support *subtyping*.\r\n\r\nSo my problem is that, In what kind of situation do we have to use dynamic polymorphism instead of compile-time polymorphism? My guesses are:\r\n\r\n- When we use the subtype system where we have objects we cannot decide its actual type (e.g. we have a container containing many objects of various types. However, in this situation, why not try *Algebraic data type* or *union type* to model the container&#39;s element type?).\r\n- We only have the object and we do not know its methods&#39; real name, so we have to use the *vptr* table to help us.",
      "title": "When is dynamic polymorphism necessary (compared with static polymorphism)?",
      "body": "<p>I come from functional languages (e.g. Haskell) and I enjoy a lot on <em>typeclasses</em> to achieve polymorphism which is also a structural approach to implement ad-hoc overloading.</p>\n<p>However, recently I'm starting to understand <strong>OOP</strong>'s way to model real problems and I'm curious why do we need <strong>dynamic polymorphism</strong> in OOP languages (such as Java). In my experience, most of function call can be resolved during compile time as many functional languages do not support <em>subtyping</em>.</p>\n<p>So my problem is that, In what kind of situation do we have to use dynamic polymorphism instead of compile-time polymorphism? My guesses are:</p>\n<ul>\n<li>When we use the subtype system where we have objects we cannot decide its actual type (e.g. we have a container containing many objects of various types. However, in this situation, why not try <em>Algebraic data type</em> or <em>union type</em> to model the container's element type?).</li>\n<li>We only have the object and we do not know its methods' real name, so we have to use the <em>vptr</em> table to help us.</li>\n</ul>\n"
    },
    {
      "tags": [
        "java",
        "stringindexoutofbounds"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 373910,
            "user_id": 1863229,
            "user_type": "registered",
            "accept_rate": 58,
            "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1",
            "display_name": "Tim Biegeleisen",
            "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"
          },
          "score": 0,
          "creation_date": 1615197305,
          "post_id": 66527641,
          "comment_id": 117607342,
          "body_markdown": "Without seeing your string data, this question is not very answerable.",
          "body": "Without seeing your string data, this question is not very answerable."
        },
        {
          "owner": {
            "reputation": 77,
            "user_id": 8224329,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/c1hag.jpg?s=128&g=1",
            "display_name": "Abhinandan",
            "link": "https://stackoverflow.com/users/8224329/abhinandan"
          },
          "score": 0,
          "creation_date": 1615197533,
          "post_id": 66527641,
          "comment_id": 117607434,
          "body_markdown": "@TimBiegeleisen Here&#39;s the value I got while debugging for variable named header,\n \n&lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt;  Sent: Thu Feb 04 19:06:38 IST 2021  From: test@test.com  To: tester1@test.com,tester2@test.com  Subject:",
          "body": "@TimBiegeleisen Here&#39;s the value I got while debugging for variable named header,   &lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt;  Sent: Thu Feb 04 19:06:38 IST 2021  From: test@test.com  To: tester1@test.com,tester2@test.com  Subject:"
        },
        {
          "owner": {
            "reputation": 8358,
            "user_id": 2067492,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG",
            "display_name": "matt",
            "link": "https://stackoverflow.com/users/2067492/matt"
          },
          "score": 0,
          "creation_date": 1615199887,
          "post_id": 66527641,
          "comment_id": 117608444,
          "body_markdown": "Also which java are you using? It seems newer java 12 gives an error specific to substring.",
          "body": "Also which java are you using? It seems newer java 12 gives an error specific to substring."
        },
        {
          "owner": {
            "reputation": 77,
            "user_id": 8224329,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/c1hag.jpg?s=128&g=1",
            "display_name": "Abhinandan",
            "link": "https://stackoverflow.com/users/8224329/abhinandan"
          },
          "score": 0,
          "creation_date": 1615199980,
          "post_id": 66527641,
          "comment_id": 117608489,
          "body_markdown": "@matt I am using java 1.8",
          "body": "@matt I am using java 1.8"
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 77,
                "user_id": 8224329,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/c1hag.jpg?s=128&g=1",
                "display_name": "Abhinandan",
                "link": "https://stackoverflow.com/users/8224329/abhinandan"
              },
              "score": 1,
              "creation_date": 1615199341,
              "post_id": 66527725,
              "comment_id": 117608235,
              "body_markdown": "Thanks for the explanation with the code.",
              "body": "Thanks for the explanation with the code."
            },
            {
              "owner": {
                "reputation": 806,
                "user_id": 13963086,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/fc1cc611282db04bd79eac96ad8b28c7?s=128&d=identicon&r=PG&f=1",
                "display_name": "k314159",
                "link": "https://stackoverflow.com/users/13963086/k314159"
              },
              "score": 0,
              "creation_date": 1615200812,
              "post_id": 66527725,
              "comment_id": 117608839,
              "body_markdown": "Wow, this is a misleading error message from the Java API. It&#39;s not the string _index_ that is -4, it is the difference between the indexes but the message doesn&#39;t say so. I&#39;m surprised and disappointed with this message.",
              "body": "Wow, this is a misleading error message from the Java API. It&#39;s not the string <i>index</i> that is -4, it is the difference between the indexes but the message doesn&#39;t say so. I&#39;m surprised and disappointed with this message."
            },
            {
              "owner": {
                "reputation": 353770,
                "user_id": 1221571,
                "user_type": "registered",
                "accept_rate": 67,
                "profile_image": "https://i.stack.imgur.com/GLKUy.jpg?s=128&g=1",
                "display_name": "Eran",
                "link": "https://stackoverflow.com/users/1221571/eran"
              },
              "score": 1,
              "creation_date": 1615201220,
              "post_id": 66527725,
              "comment_id": 117608993,
              "body_markdown": "@k314159 well, it depends how you look at it. When you call `str.substring(5,1)`, the index of the first character of the output String is 0, so if the beginIndex 5 is mapped to 0, the endIndex 1 should be mapped to -4, which is the invalid index.",
              "body": "@k314159 well, it depends how you look at it. When you call <code>str.substring(5,1)</code>, the index of the first character of the output String is 0, so if the beginIndex 5 is mapped to 0, the endIndex 1 should be mapped to -4, which is the invalid index."
            }
          ],
          "owner": {
            "reputation": 353770,
            "user_id": 1221571,
            "user_type": "registered",
            "accept_rate": 67,
            "profile_image": "https://i.stack.imgur.com/GLKUy.jpg?s=128&g=1",
            "display_name": "Eran",
            "link": "https://stackoverflow.com/users/1221571/eran"
          },
          "comment_count": 3,
          "score": 5,
          "creation_date": 1615197578,
          "answer_id": 66527725,
          "body_markdown": "The relevant code of `substring` is:\r\n\r\n    1965    int subLen = endIndex - beginIndex;\r\n    1966    if (subLen &lt; 0) {\r\n    1967        throw new StringIndexOutOfBoundsException(subLen);\r\n    1968    }\r\n\r\nIf you see `-4` in the exception&#39;s message, this means `endIndex - beginIndex == -4`.\r\n\r\nObviously, `endIndex` should be larger than or equal to `beginIndex`, so that the difference won&#39;t be negative.\r\n\r\nLooking at the full method (this version of the code seems to match your version, based on the line number - 1967 - in which the exception was thrown):\r\n\r\n    public String substring(int beginIndex, int endIndex) {\r\n        if (beginIndex &lt; 0) {\r\n            throw new StringIndexOutOfBoundsException(beginIndex);\r\n        }\r\n        if (endIndex &gt; value.length) {\r\n            throw new StringIndexOutOfBoundsException(endIndex);\r\n        }\r\n        int subLen = endIndex - beginIndex;\r\n        if (subLen &lt; 0) {\r\n            throw new StringIndexOutOfBoundsException(subLen);\r\n        }\r\n        return ((beginIndex == 0) &amp;&amp; (endIndex == value.length)) ? this\r\n                : new String(value, beginIndex, subLen);\r\n    }\r\n\r\nyou can see that you would have gotten `-1` in the error message if `beginIndex` was `-1`.\r\n\r\nBut if `beginIndex` is non-negative, and `endIndex` is not too large, the number you get in the exception&#39;s message is `endIndex - beginIndex`.",
          "body": "<p>The relevant code of <code>substring</code> is:</p>\n<pre><code>1965    int subLen = endIndex - beginIndex;\n1966    if (subLen &lt; 0) {\n1967        throw new StringIndexOutOfBoundsException(subLen);\n1968    }\n</code></pre>\n<p>If you see <code>-4</code> in the exception's message, this means <code>endIndex - beginIndex == -4</code>.</p>\n<p>Obviously, <code>endIndex</code> should be larger than or equal to <code>beginIndex</code>, so that the difference won't be negative.</p>\n<p>Looking at the full method (this version of the code seems to match your version, based on the line number - 1967 - in which the exception was thrown):</p>\n<pre><code>public String substring(int beginIndex, int endIndex) {\n    if (beginIndex &lt; 0) {\n        throw new StringIndexOutOfBoundsException(beginIndex);\n    }\n    if (endIndex &gt; value.length) {\n        throw new StringIndexOutOfBoundsException(endIndex);\n    }\n    int subLen = endIndex - beginIndex;\n    if (subLen &lt; 0) {\n        throw new StringIndexOutOfBoundsException(subLen);\n    }\n    return ((beginIndex == 0) &amp;&amp; (endIndex == value.length)) ? this\n            : new String(value, beginIndex, subLen);\n}\n</code></pre>\n<p>you can see that you would have gotten <code>-1</code> in the error message if <code>beginIndex</code> was <code>-1</code>.</p>\n<p>But if <code>beginIndex</code> is non-negative, and <code>endIndex</code> is not too large, the number you get in the exception's message is <code>endIndex - beginIndex</code>.</p>\n"
        },
        {
          "comments": [
            {
              "owner": {
                "reputation": 77,
                "user_id": 8224329,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/c1hag.jpg?s=128&g=1",
                "display_name": "Abhinandan",
                "link": "https://stackoverflow.com/users/8224329/abhinandan"
              },
              "score": 0,
              "creation_date": 1615199545,
              "post_id": 66527878,
              "comment_id": 117608326,
              "body_markdown": "Thanks, Tim for the suggestion.",
              "body": "Thanks, Tim for the suggestion."
            }
          ],
          "owner": {
            "reputation": 373910,
            "user_id": 1863229,
            "user_type": "registered",
            "accept_rate": 58,
            "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1",
            "display_name": "Tim Biegeleisen",
            "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"
          },
          "comment_count": 1,
          "score": 0,
          "creation_date": 1615198199,
          "answer_id": 66527878,
          "body_markdown": "This is not an exact answer or correction, because I think your approach needs to change.  I suggest using a regex based approach to find all key value pairs in the body of your text.  Consider this version:\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    String input = &quot;&lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; Sent: Thu Feb 04 19:06:38 IST 2021 From: test@test.com To: tester1@test.com,tester2@test.com Subject:&quot;;\r\n    String pattern = &quot;\\\\b(\\\\S+): (.*?)(?= \\\\S+:)&quot;;\r\n    Pattern r = Pattern.compile(pattern);\r\n    Matcher m = r.matcher(input);\r\n\r\n    while (m.find()) {\r\n        System.out.println(&quot;Found: (&quot; + m.group(1) + &quot;, &quot; + m.group(2) + &quot;)&quot;);\r\n    }\r\n\r\nThis prints:\r\n\r\n    Found: (Sent, Thu Feb 04)\r\n    Found: (From, test@test.com)\r\n    Found: (To, tester1@test.com,tester2@test.com)\r\n\r\nYou may iterate over the text and search for whatever key/value you need.  Avoid substring operations in this case because it leaves too many edge cases open.",
          "body": "<p>This is not an exact answer or correction, because I think your approach needs to change.  I suggest using a regex based approach to find all key value pairs in the body of your text.  Consider this version:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String input = &quot;&lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; Sent: Thu Feb 04 19:06:38 IST 2021 From: test@test.com To: tester1@test.com,tester2@test.com Subject:&quot;;\nString pattern = &quot;\\\\b(\\\\S+): (.*?)(?= \\\\S+:)&quot;;\nPattern r = Pattern.compile(pattern);\nMatcher m = r.matcher(input);\n\nwhile (m.find()) {\n    System.out.println(&quot;Found: (&quot; + m.group(1) + &quot;, &quot; + m.group(2) + &quot;)&quot;);\n}\n</code></pre>\n<p>This prints:</p>\n<pre><code>Found: (Sent, Thu Feb 04)\nFound: (From, test@test.com)\nFound: (To, tester1@test.com,tester2@test.com)\n</code></pre>\n<p>You may iterate over the text and search for whatever key/value you need.  Avoid substring operations in this case because it leaves too many edge cases open.</p>\n"
        }
      ],
      "owner": {
        "reputation": 77,
        "user_id": 8224329,
        "user_type": "registered",
        "profile_image": "https://i.stack.imgur.com/c1hag.jpg?s=128&g=1",
        "display_name": "Abhinandan",
        "link": "https://stackoverflow.com/users/8224329/abhinandan"
      },
      "comment_count": 4,
      "view_count": 36,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1615197246,
      "question_id": 66527641,
      "body_markdown": "I am trying to get a substring out of a string. I have written logic to provide a start index and an end index but getting below exception.\r\nThe code is:\r\n```\r\nfinal int startIndex = header.indexOf(startValue + &quot;:&quot;)\r\n\t\t\t\t+ (startValue + &quot;:&quot;).length();\r\nfinal int endIndex = header.indexOf(endValue + &quot;:&quot;);\r\nreturn header.substring(startIndex, endIndex).trim();\r\n```\r\n\r\nThe exception:\r\n\r\n**&#39;String index out of range: -4&#39;\r\njava.lang.StringIndexOutOfBoundsException: String index out of range: -4\r\n\tat java.lang.String.substring(String.java:1967)**\r\n\r\nAny help would be appreciated.",
      "title": "Why does the following exception showing -4 index specifically instead of -1?",
      "body": "<p>I am trying to get a substring out of a string. I have written logic to provide a start index and an end index but getting below exception.\nThe code is:</p>\n<pre><code>final int startIndex = header.indexOf(startValue + &quot;:&quot;)\n                + (startValue + &quot;:&quot;).length();\nfinal int endIndex = header.indexOf(endValue + &quot;:&quot;);\nreturn header.substring(startIndex, endIndex).trim();\n</code></pre>\n<p>The exception:</p>\n<p><strong>'String index out of range: -4'\njava.lang.StringIndexOutOfBoundsException: String index out of range: -4\nat java.lang.String.substring(String.java:1967)</strong></p>\n<p>Any help would be appreciated.</p>\n"
    },
    {
      "tags": [
        "java",
        "recursion"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 293,
            "user_id": 10334839,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/zi9ig.png?s=128&g=1",
            "display_name": "HomeworkHopper",
            "link": "https://stackoverflow.com/users/10334839/homeworkhopper"
          },
          "comment_count": 0,
          "score": 2,
          "creation_date": 1615145458,
          "answer_id": 66520553,
          "body_markdown": "Looks like there are already some other answers here, but just to show that there can be many different ways to achieve the same output, a slightly different and more concise version could be something like:\r\n\r\n    public static void write1ToNInOneLine(final int n) {\r\n        if(n &gt; 1)\r\n        {\r\n            write1ToNInOneLine(n - 1);\r\n            System.out.print(&#39;,&#39;);\r\n        }\r\n        System.out.print(n);\r\n    }\r\n\r\nWhen called like so: `write1ToNInOneLine(6)`, the output is:\r\n\r\n    1,2,3,4,5,6",
          "body": "<p>Looks like there are already some other answers here, but just to show that there can be many different ways to achieve the same output, a slightly different and more concise version could be something like:</p>\n<pre><code>public static void write1ToNInOneLine(final int n) {\n    if(n &gt; 1)\n    {\n        write1ToNInOneLine(n - 1);\n        System.out.print(',');\n    }\n    System.out.print(n);\n}\n</code></pre>\n<p>When called like so: <code>write1ToNInOneLine(6)</code>, the output is:</p>\n<pre><code>1,2,3,4,5,6\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 30560,
            "user_id": 1366871,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/b3ec9d9128a25ba6eae8a1d42c2eb04a?s=128&d=identicon&r=PG",
            "display_name": "dreamcrash",
            "link": "https://stackoverflow.com/users/1366871/dreamcrash"
          },
          "comment_count": 0,
          "score": 5,
          "creation_date": 1615145595,
          "answer_id": 66520576,
          "body_markdown": "The problem with your code:\r\n\r\n    public static void write1ToNInOneLine(int n){\r\n        if (n == 0) {\r\n            return;\r\n        } \r\n        else // n is two or more digits long:\r\n        {\r\n            write1ToNInOneLine(n - 1);\r\n            System.out.print(n + &quot;,&quot;);\r\n        }\r\n    }\r\n\r\nis that you are not handling the end-case correctly. \r\n\r\n&gt; single (positive) int argument n and writes the integers 1, 2, . . . ,\r\n&gt; n to the screen.\r\n\r\nIn your case, the end-case is when the `n = 1`. Moreover, you are doing `System.out.print(n + &quot;,&quot;);` which means that the after the last element you will add `&quot;,&quot;`. Because the end case is &quot;1&quot; it is better to do `System.out.print(&quot;,&quot;+ n);` so that the last element (*i.e.,* `n = n`) will not have &quot;,&quot;, and handle the case when `n = 1` so that you do not add `&quot;,&quot;` before 1. Like as follows:\r\n\r\n    public static void write1ToNInOneLine(int n){\r\n        if (n == 1){\r\n            System.out.print(n);\r\n        }\r\n        else if (n &gt; 1){\r\n            write1ToNInOneLine(n - 1);\r\n            System.out.print(&quot;,&quot;+ n);\r\n        }\r\n    }\r\n\r\nOutput:\r\n\r\n    1,2,3,4,5,6,7,8,9,10\r\n\r\nAlternatively:\r\n\r\n    public static String write1ToNInOneLine(final int n) {\r\n        return ((n &gt; 1) ? write1ToNInOneLine(n - 1) + &quot;,&quot; : &quot;&quot;) + n;\r\n    }\r\n\r\nand then:\r\n\r\n    System.out.println(write1ToNInOneLine(10));\r\n",
          "body": "<p>The problem with your code:</p>\n<pre><code>public static void write1ToNInOneLine(int n){\n    if (n == 0) {\n        return;\n    } \n    else // n is two or more digits long:\n    {\n        write1ToNInOneLine(n - 1);\n        System.out.print(n + &quot;,&quot;);\n    }\n}\n</code></pre>\n<p>is that you are not handling the end-case correctly.</p>\n<blockquote>\n<p>single (positive) int argument n and writes the integers 1, 2, . . . ,\nn to the screen.</p>\n</blockquote>\n<p>In your case, the end-case is when the <code>n = 1</code>. Moreover, you are doing <code>System.out.print(n + &quot;,&quot;);</code> which means that the after the last element you will add <code>&quot;,&quot;</code>. Because the end case is &quot;1&quot; it is better to do <code>System.out.print(&quot;,&quot;+ n);</code> so that the last element (<em>i.e.,</em> <code>n = n</code>) will not have &quot;,&quot;, and handle the case when <code>n = 1</code> so that you do not add <code>&quot;,&quot;</code> before 1. Like as follows:</p>\n<pre><code>public static void write1ToNInOneLine(int n){\n    if (n == 1){\n        System.out.print(n);\n    }\n    else if (n &gt; 1){\n        write1ToNInOneLine(n - 1);\n        System.out.print(&quot;,&quot;+ n);\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>1,2,3,4,5,6,7,8,9,10\n</code></pre>\n<p>Alternatively:</p>\n<pre><code>public static String write1ToNInOneLine(final int n) {\n    return ((n &gt; 1) ? write1ToNInOneLine(n - 1) + &quot;,&quot; : &quot;&quot;) + n;\n}\n</code></pre>\n<p>and then:</p>\n<pre><code>System.out.println(write1ToNInOneLine(10));\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 1623,
            "user_id": 1287477,
            "user_type": "registered",
            "accept_rate": 52,
            "profile_image": "https://i.stack.imgur.com/AYraM.jpg?s=128&g=1",
            "display_name": "Continuity8",
            "link": "https://stackoverflow.com/users/1287477/continuity8"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615154279,
          "answer_id": 66521882,
          "body_markdown": "The least code that I can get to achieve this is:\r\n\r\n    public static void write1ToNInTwoLines(int i) {\r\n        if (i &gt; 1) write1ToNInOneLine(i-1);\r\n        System.out.print(i &gt; 1? &quot;,&quot; + i : i);\r\n    }\r\n\r\nThis has a couple of benefits that I can see:\r\n\r\n - it is completely self contained (return type void) - the caller does not have to print\r\n - it does exactly what it needs to and only that (e.g. no use empty speech-marks &quot;&quot;)\r\n\r\nto call you invoke:\r\n\r\n    write1ToNInTwoLines(10);\r\n\r\nand will print: \r\n\r\n&gt; 1,2,3,4,5,6,7,8,9,10\r\n\r\n",
          "body": "<p>The least code that I can get to achieve this is:</p>\n<pre><code>public static void write1ToNInTwoLines(int i) {\n    if (i &gt; 1) write1ToNInOneLine(i-1);\n    System.out.print(i &gt; 1? &quot;,&quot; + i : i);\n}\n</code></pre>\n<p>This has a couple of benefits that I can see:</p>\n<ul>\n<li>it is completely self contained (return type void) - the caller does not have to print</li>\n<li>it does exactly what it needs to and only that (e.g. no use empty speech-marks &quot;&quot;)</li>\n</ul>\n<p>to call you invoke:</p>\n<pre><code>write1ToNInTwoLines(10);\n</code></pre>\n<p>and will print:</p>\n<blockquote>\n<p>1,2,3,4,5,6,7,8,9,10</p>\n</blockquote>\n"
        }
      ],
      "owner": {
        "reputation": 1357,
        "user_id": 2875641,
        "user_type": "registered",
        "accept_rate": 60,
        "profile_image": "https://www.gravatar.com/avatar/813c7c482fbfd9fa478f3a5ee21f6a2f?s=128&d=identicon&r=PG&f=1",
        "display_name": "dushkin",
        "link": "https://stackoverflow.com/users/2875641/dushkin"
      },
      "comment_count": 0,
      "view_count": 76,
      "answer_count": 3,
      "score": 3,
      "creation_date": 1615144773,
      "question_id": 66520434,
      "body_markdown": "I have the following task:\r\n\r\nWrite a ***recursive*** void method that takes a ***single (positive) int argument*** n and writes the integers 1, 2, . . . , n to the screen.\r\n\r\nWhat I tried so far is:\r\n\r\n    public static void write1ToNInOneLine(int n){\r\n        if (n == 0) {\r\n            return;\r\n        } \r\n        else // n is two or more digits long:\r\n        {\r\n            write1ToNInOneLine(n - 1);\r\n            System.out.print(n + &quot;,&quot;);\r\n        }\r\n    }\r\n\r\nbut obviously I have the last redundant comma on output.\r\n\r\nIs there a way to avoid it?",
      "title": "Java Recursion: How to avoid the last comma when write 1..n seperated by commas in one line. See full task description inside",
      "body": "<p>I have the following task:</p>\n<p>Write a <em><strong>recursive</strong></em> void method that takes a <em><strong>single (positive) int argument</strong></em> n and writes the integers 1, 2, . . . , n to the screen.</p>\n<p>What I tried so far is:</p>\n<pre><code>public static void write1ToNInOneLine(int n){\n    if (n == 0) {\n        return;\n    } \n    else // n is two or more digits long:\n    {\n        write1ToNInOneLine(n - 1);\n        System.out.print(n + &quot;,&quot;);\n    }\n}\n</code></pre>\n<p>but obviously I have the last redundant comma on output.</p>\n<p>Is there a way to avoid it?</p>\n"
    },
    {
      "tags": [
        "java",
        "android"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 7762,
            "user_id": 3501958,
            "user_type": "registered",
            "accept_rate": 89,
            "profile_image": "https://i.stack.imgur.com/weWwl.png?s=128&g=1",
            "display_name": "hata",
            "link": "https://stackoverflow.com/users/3501958/hata"
          },
          "score": 1,
          "creation_date": 1615117890,
          "post_id": 66516171,
          "comment_id": 117587357,
          "body_markdown": "You should use *.NoActionBar theme (i.e. `Theme.MaterialComponents.DayNight.NoActionBar`) as parent.",
          "body": "You should use *.NoActionBar theme (i.e. <code>Theme.MaterialComponents.DayNight.NoActionBar</code>) as parent."
        },
        {
          "owner": {
            "reputation": 33,
            "user_id": 15203210,
            "user_type": "registered",
            "profile_image": "https://lh4.googleusercontent.com/-rsybqVWGBs0/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckB96ANkNCQSXLdwI_A_NNmTygZQw/s96-c/photo.jpg?sz=128",
            "display_name": "Владимир Арсенов",
            "link": "https://stackoverflow.com/users/15203210/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%90%d1%80%d1%81%d0%b5%d0%bd%d0%be%d0%b2"
          },
          "score": 0,
          "creation_date": 1615120313,
          "post_id": 66516171,
          "comment_id": 117587939,
          "body_markdown": "After I did what you had adviced me new mistake  was just in typping: reALtive layout instead of reLAtive. everythig is work know, thanks",
          "body": "After I did what you had adviced me new mistake  was just in typping: reALtive layout instead of reLAtive. everythig is work know, thanks"
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 33,
                "user_id": 15203210,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-rsybqVWGBs0/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckB96ANkNCQSXLdwI_A_NNmTygZQw/s96-c/photo.jpg?sz=128",
                "display_name": "Владимир Арсенов",
                "link": "https://stackoverflow.com/users/15203210/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%90%d1%80%d1%81%d0%b5%d0%bd%d0%be%d0%b2"
              },
              "score": 0,
              "creation_date": 1615120163,
              "post_id": 66516342,
              "comment_id": 117587899,
              "body_markdown": "the second one helped me, thanks",
              "body": "the second one helped me, thanks"
            }
          ],
          "owner": {
            "reputation": 1104,
            "user_id": 13600868,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/nBlDV.jpg?s=128&g=1",
            "display_name": "Javad Dehban",
            "link": "https://stackoverflow.com/users/13600868/javad-dehban"
          },
          "comment_count": 1,
          "score": 2,
          "creation_date": 1615118841,
          "answer_id": 66516342,
          "body_markdown": "you can use this:\r\n\r\n    &lt;style name=&quot;NoActionBarTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;\r\n      &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;\r\n      &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;\r\n      &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;\r\n      &lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;\r\n      &lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;\r\n    &lt;/style&gt;\r\n\r\nOR\r\n\r\n    &lt;activity android:name=&quot;.activity.YourActivity&quot;\r\n              android:theme=&quot;@style/AppTheme.NoActionBar&quot;/&gt;\r\n\r\n\r\n\r\n",
          "body": "<p>you can use this:</p>\n<pre><code>&lt;style name=&quot;NoActionBarTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;\n  &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;\n  &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;\n  &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;\n  &lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;\n  &lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;\n&lt;/style&gt;\n</code></pre>\n<p>OR</p>\n<pre><code>&lt;activity android:name=&quot;.activity.YourActivity&quot;\n          android:theme=&quot;@style/AppTheme.NoActionBar&quot;/&gt;\n</code></pre>\n"
        }
      ],
      "owner": {
        "reputation": 33,
        "user_id": 15203210,
        "user_type": "registered",
        "profile_image": "https://lh4.googleusercontent.com/-rsybqVWGBs0/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckB96ANkNCQSXLdwI_A_NNmTygZQw/s96-c/photo.jpg?sz=128",
        "display_name": "Владимир Арсенов",
        "link": "https://stackoverflow.com/users/15203210/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%90%d1%80%d1%81%d0%b5%d0%bd%d0%be%d0%b2"
      },
      "comment_count": 2,
      "view_count": 25,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1615117686,
      "question_id": 66516171,
      "body_markdown": "This is a simple app with a tag navigation. And I can&#39;t open it with getting a mistake. \r\nA part of it is:\r\n\r\n    Caused by: java.lang.IllegalStateException: This Activity already has an action bar supplied by the window decor. Do not request Window.FEATURE_SUPPORT_ACTION_BAR and set windowActionBar to false in your theme to use a Toolbar instead.\r\n        at androidx.appcompat.app.AppCompatDelegateImpl.setSupportActionBar(AppCompatDelegateImpl.java:572)\r\n        at androidx.appcompat.app.AppCompatActivity.setSupportActionBar(AppCompatActivity.java:159)\r\n        at com.example.tabexperiment.MainActivity.onCreate(MainActivity.java:29)\r\n\r\nAnd here is a 28-th and 29-th lines in MainActivity(the message above says mistake is in 29-th line):\r\n\r\n    androidx.appcompat.widget.Toolbar toolbar = findViewById(R.id.toolbar);\r\n    setSupportActionBar(toolbar);\r\n\r\nI tried to cope with the problem but all what I found is that I should add this code in themes file:\r\n\r\n    &lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;\r\n    &lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;\r\nand this line in Manifest:\r\n\r\n    android:theme=&quot;@style/Theme.TabExperiment&quot;\r\nSo, I have that in my code but nothing is still working.\r\nHelp me, please.",
      "title": "Why I see Do not request Window.FEATURE_SUPPORT_ACTION_BAR?",
      "body": "<p>This is a simple app with a tag navigation. And I can't open it with getting a mistake.\nA part of it is:</p>\n<pre><code>Caused by: java.lang.IllegalStateException: This Activity already has an action bar supplied by the window decor. Do not request Window.FEATURE_SUPPORT_ACTION_BAR and set windowActionBar to false in your theme to use a Toolbar instead.\n    at androidx.appcompat.app.AppCompatDelegateImpl.setSupportActionBar(AppCompatDelegateImpl.java:572)\n    at androidx.appcompat.app.AppCompatActivity.setSupportActionBar(AppCompatActivity.java:159)\n    at com.example.tabexperiment.MainActivity.onCreate(MainActivity.java:29)\n</code></pre>\n<p>And here is a 28-th and 29-th lines in MainActivity(the message above says mistake is in 29-th line):</p>\n<pre><code>androidx.appcompat.widget.Toolbar toolbar = findViewById(R.id.toolbar);\nsetSupportActionBar(toolbar);\n</code></pre>\n<p>I tried to cope with the problem but all what I found is that I should add this code in themes file:</p>\n<pre><code>&lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;\n&lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;\n</code></pre>\n<p>and this line in Manifest:</p>\n<pre><code>android:theme=&quot;@style/Theme.TabExperiment&quot;\n</code></pre>\n<p>So, I have that in my code but nothing is still working.\nHelp me, please.</p>\n"
    },
    {
      "tags": [
        "java",
        "linux",
        "processbuilder"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 38622,
            "user_id": 768644,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=128&d=identicon&r=PG",
            "display_name": "rzwitserloot",
            "link": "https://stackoverflow.com/users/768644/rzwitserloot"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615004915,
          "answer_id": 66502369,
          "body_markdown": "Always specify paths, so use `/bin/su`. However, more generally, `su` cannot be used except if you have a full interactive terminal, because it will ask for a password and you can&#39;t provide it, because that is rife with security problems and therefore su just generally won&#39;t allow it.\r\n\r\nThe advised strategy to do such a thing is to use `sudo` instead, and mark the specific script you want to run as owned by root, and marked off especially in your sudoers file as &#39;the user that runs the java process can sudo this specific shell script without a password, but nothing else&#39;. Or, in this case, not root, but `myUser`.\r\n",
          "body": "<p>Always specify paths, so use <code>/bin/su</code>. However, more generally, <code>su</code> cannot be used except if you have a full interactive terminal, because it will ask for a password and you can't provide it, because that is rife with security problems and therefore su just generally won't allow it.</p>\n<p>The advised strategy to do such a thing is to use <code>sudo</code> instead, and mark the specific script you want to run as owned by root, and marked off especially in your sudoers file as 'the user that runs the java process can sudo this specific shell script without a password, but nothing else'. Or, in this case, not root, but <code>myUser</code>.</p>\n"
        }
      ],
      "owner": {
        "reputation": 149,
        "user_id": 1822720,
        "user_type": "registered",
        "accept_rate": 87,
        "profile_image": "https://www.gravatar.com/avatar/3bbc18f70c9829d5e25ff6d7bca8504d?s=128&d=identicon&r=PG",
        "display_name": "rsijaya",
        "link": "https://stackoverflow.com/users/1822720/rsijaya"
      },
      "comment_count": 0,
      "view_count": 26,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1615003656,
      "question_id": 66502257,
      "body_markdown": "How to set specific user to run processBuilder?\r\n\r\n    ProcessBuilder processBuilder = new ProcessBuilder();\r\n\t\t\t\t\t\t\tString[] cmdStr = {&quot;su&quot;, &quot;-s&quot;, &quot;/bin/bash&quot;, &quot;myUser&quot;, &quot;-c&quot;, &quot;/home/myUser/sch.sh&quot;, &quot;argumen&quot;};\r\n\t\t\t\t\t\t\tprocessBuilder.command(cmdStr);\r\n\t\t\t\t\t\t\tProcess process = processBuilder.start();\r\n\r\n\r\nwhen i try this is not working",
      "title": "How to set specific user to run processBuilder?",
      "body": "<p>How to set specific user to run processBuilder?</p>\n<pre><code>ProcessBuilder processBuilder = new ProcessBuilder();\n                        String[] cmdStr = {&quot;su&quot;, &quot;-s&quot;, &quot;/bin/bash&quot;, &quot;myUser&quot;, &quot;-c&quot;, &quot;/home/myUser/sch.sh&quot;, &quot;argumen&quot;};\n                        processBuilder.command(cmdStr);\n                        Process process = processBuilder.start();\n</code></pre>\n<p>when i try this is not working</p>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "spring-boot",
        "oauth-2.0"
      ],
      "answers": [
        {
          "owner": {
            "reputation": 39612,
            "user_id": 1807667,
            "user_type": "registered",
            "accept_rate": 60,
            "profile_image": "https://www.gravatar.com/avatar/976dc9df3ea3d05a18e90f0cd9c29b7a?s=128&d=identicon&r=PG",
            "display_name": "Ortomala Lokni",
            "link": "https://stackoverflow.com/users/1807667/ortomala-lokni"
          },
          "comment_count": 0,
          "score": 1,
          "creation_date": 1615020014,
          "answer_id": 66503871,
          "body_markdown": "You can remove the need to use the [check_token endpoint](https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/endpoint/CheckTokenEndpoint.html), by using signed [JWT](https://tools.ietf.org/html/rfc7519) tokens.\r\n\r\nWhen the resource server receive a JWT token, it verify it&#39;s signature by using a public key, and the expiration date by checking the corresponding field in the JSON object.\r\n\r\nFor this you can use the [JwtAccessTokenConverter](https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/token/store/JwtAccessTokenConverter.html), [JwtTokenStore](https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/token/store/JwtTokenStore.html) and the [nimbus-jose-jwt](https://connect2id.com/products/nimbus-jose-jwt) library.\r\n\r\nThe downside of this approach is that you cannot revoke a token. It&#39;s then preferable to have short lived tokens.",
          "body": "<p>You can remove the need to use the <a href=\"https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/endpoint/CheckTokenEndpoint.html\" rel=\"nofollow noreferrer\">check_token endpoint</a>, by using signed <a href=\"https://tools.ietf.org/html/rfc7519\" rel=\"nofollow noreferrer\">JWT</a> tokens.</p>\n<p>When the resource server receive a JWT token, it verify it's signature by using a public key, and the expiration date by checking the corresponding field in the JSON object.</p>\n<p>For this you can use the <a href=\"https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/token/store/JwtAccessTokenConverter.html\" rel=\"nofollow noreferrer\">JwtAccessTokenConverter</a>, <a href=\"https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/token/store/JwtTokenStore.html\" rel=\"nofollow noreferrer\">JwtTokenStore</a> and the <a href=\"https://connect2id.com/products/nimbus-jose-jwt\" rel=\"nofollow noreferrer\">nimbus-jose-jwt</a> library.</p>\n<p>The downside of this approach is that you cannot revoke a token. It's then preferable to have short lived tokens.</p>\n"
        }
      ],
      "owner": {
        "reputation": 31,
        "user_id": 11204769,
        "user_type": "registered",
        "profile_image": "https://lh5.googleusercontent.com/-v0q2CH5lpMM/AAAAAAAAAAI/AAAAAAAAB8Q/pGY-hvMVl-c/photo.jpg?sz=128",
        "display_name": "Tiago Mumbach",
        "link": "https://stackoverflow.com/users/11204769/tiago-mumbach"
      },
      "comment_count": 0,
      "view_count": 38,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1614978511,
      "question_id": 66499647,
      "body_markdown": "I`m developing a microservice structure using spring-boot, this structure has an external oauth2 Authorization Server and multiples Resource Servers.\r\n\r\nMy problem is, each http request to my resources, calls a url to my Authorization Server, to validate the token ( `.../oauth/check_token/`). This way there is a lot of requests.  There is a way to validate/check this token only when it is expired?\r\n\r\nMy Resource servers:\r\n\r\n```\r\n@Configuration\r\n@EnableResourceServer\r\npublic class ResourceServerConfig extends ResourceServerConfigurerAdapter {\r\n\t\r\n\t@Value(&quot;${security.oauth2.client.client-id}&quot;)\r\n\tprivate String clientId;\r\n\t\r\n\t@Value(&quot;${security.oauth2.client.client-secret}&quot;)\r\n\tprivate String clientSecret;\r\n\t\r\n\t@Value(&quot;${security.oauth2.resource.id}&quot;)\r\n\tprivate String resourceId;\r\n\t\r\n\t@Value(&quot;${security.oauth2.resource.token-info-uri}&quot;)\r\n\tprivate String tokenInfoUri;\r\n\r\n    @Override\r\n    public void configure(HttpSecurity http) throws Exception {\r\n    \thttp\r\n\t        .authorizeRequests()\r\n\t        .antMatchers(ADMIN_ANT_MATCHER).hasRole(&quot;ADMIN&quot;)\r\n\t        .antMatchers(PROTECTED_ANT_MATCHER).hasRole(&quot;USER&quot;)\r\n\t        .and()\r\n\t        .csrf().disable();\r\n    }\r\n    \r\n    @Override\r\n    public void configure(ResourceServerSecurityConfigurer resources) throws Exception {\r\n         resources.tokenServices(tokenService()).resourceId(resourceId).stateless(true);\r\n    }\r\n    \r\n    @Bean\r\n    @Primary\r\n    public RemoteTokenServices tokenService() {\r\n        RemoteTokenServices tokenService = new RemoteTokenServices();\r\n        tokenService.setCheckTokenEndpointUrl(tokenInfoUri);\r\n        tokenService.setClientId(clientId);\r\n        tokenService.setClientSecret(clientSecret);\r\n        return tokenService;\r\n    }\r\n}\r\n```\r\n\r\nAuthorization Server:\r\n\r\n```\r\n@Configuration\r\n@EnableAuthorizationServer\r\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\r\n\r\n    @Value(&quot;${security.oauth2.client.client-id}&quot;)\r\n    private String clientId;\r\n\r\n    @Value(&quot;${security.oauth2.client.client-secret}&quot;)\r\n    private String clientSecret;\r\n\r\n    @Value(&quot;${security.oauth2.resource.id}&quot;)\r\n    private String resourceId;\r\n\r\n    @Value(&quot;${security.oauth2.client.access-token-validity-seconds}&quot;)\r\n    private Integer tokenValidateSeconds;\r\n\r\n    @Value(&quot;${security.oauth2.client.token-secret}&quot;)\r\n    private String tokenSecret;\r\n\r\n    @Autowired\r\n    private AuthenticationManager authenticationManager;\r\n\r\n    @Autowired\r\n    private TokenStore tokenStore;\r\n\r\n    @Autowired\r\n    private UserDetailsService userDetailsService;\r\n\r\n    @Autowired\r\n    private OauthAccessTokenRepository oauthAccessTokenRepository;\r\n\r\n    @Autowired\r\n    private OauthRefreshTokenRepository oauthRefreshTokenRepository;\r\n\r\n\r\n    @Override\r\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {\r\n        endpoints\r\n                .tokenStore(this.tokenStore)\r\n                .tokenEnhancer(tokenEnhancer())\r\n                .authenticationManager(this.authenticationManager)\r\n                .userDetailsService(userDetailsService);\r\n    }\r\n\r\n    @Override\r\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\r\n        clients\r\n                .inMemory()\r\n                .withClient(clientId)\r\n                .authorizedGrantTypes(&quot;client_credentials&quot;, &quot;password&quot;, &quot;refresh_token&quot;)\r\n                .authorities(&quot;ROLE_USER&quot;,&quot;ROLE_ADMIN&quot;)\r\n                .scopes(&quot;read&quot;,&quot;write&quot;,&quot;trust&quot;)\r\n                .resourceIds(resourceId)\r\n                .accessTokenValiditySeconds(tokenValidateSeconds)\r\n                .secret(bCryptPasswordEncoder().encode(clientSecret));\r\n    }\r\n\r\n    @Override\r\n    public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {\r\n        security.checkTokenAccess(&quot;isAuthenticated()&quot;);\r\n    }\r\n\r\n    @Bean\r\n    public BCryptPasswordEncoder bCryptPasswordEncoder(){\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n\r\n    @Bean\r\n    @Primary\r\n    public DefaultTokenServices tokenServices() {\r\n        DefaultTokenServices tokenServices = new DefaultTokenServices();\r\n        tokenServices.setSupportRefreshToken(true);\r\n        tokenServices.setTokenStore(this.tokenStore);\r\n        return tokenServices;\r\n    }\r\n\r\n    @Bean\r\n    public TokenEnhancer tokenEnhancer() {\r\n        return new TokenEnhancer() {\r\n            @Override\r\n            public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {\r\n                CustomUser user = (CustomUser) authentication.getPrincipal();\r\n\r\n                String token = JwtTokenHelper.generateToken(\r\n                        user.getIdUser(),\r\n                        user.getTenantID(),\r\n                        user.getIdEntity(),\r\n                        user.getIdBusinessUnit(),\r\n                        user.getProfile(),\r\n                        tokenValidateSeconds,\r\n                        tokenSecret\r\n                );\r\n\r\n                ((DefaultOAuth2AccessToken) accessToken).setValue(token);\r\n\r\n                return accessToken;\r\n            }\r\n        };\r\n\r\n    }\r\n}\r\n```\r\n\r\n",
      "title": "Spring-boot Resource server validate token only when expired",
      "body": "<p>I`m developing a microservice structure using spring-boot, this structure has an external oauth2 Authorization Server and multiples Resource Servers.</p>\n<p>My problem is, each http request to my resources, calls a url to my Authorization Server, to validate the token ( <code>.../oauth/check_token/</code>). This way there is a lot of requests.  There is a way to validate/check this token only when it is expired?</p>\n<p>My Resource servers:</p>\n<pre><code>@Configuration\n@EnableResourceServer\npublic class ResourceServerConfig extends ResourceServerConfigurerAdapter {\n    \n    @Value(&quot;${security.oauth2.client.client-id}&quot;)\n    private String clientId;\n    \n    @Value(&quot;${security.oauth2.client.client-secret}&quot;)\n    private String clientSecret;\n    \n    @Value(&quot;${security.oauth2.resource.id}&quot;)\n    private String resourceId;\n    \n    @Value(&quot;${security.oauth2.resource.token-info-uri}&quot;)\n    private String tokenInfoUri;\n\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n        http\n            .authorizeRequests()\n            .antMatchers(ADMIN_ANT_MATCHER).hasRole(&quot;ADMIN&quot;)\n            .antMatchers(PROTECTED_ANT_MATCHER).hasRole(&quot;USER&quot;)\n            .and()\n            .csrf().disable();\n    }\n    \n    @Override\n    public void configure(ResourceServerSecurityConfigurer resources) throws Exception {\n         resources.tokenServices(tokenService()).resourceId(resourceId).stateless(true);\n    }\n    \n    @Bean\n    @Primary\n    public RemoteTokenServices tokenService() {\n        RemoteTokenServices tokenService = new RemoteTokenServices();\n        tokenService.setCheckTokenEndpointUrl(tokenInfoUri);\n        tokenService.setClientId(clientId);\n        tokenService.setClientSecret(clientSecret);\n        return tokenService;\n    }\n}\n</code></pre>\n<p>Authorization Server:</p>\n<pre><code>@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {\n\n    @Value(&quot;${security.oauth2.client.client-id}&quot;)\n    private String clientId;\n\n    @Value(&quot;${security.oauth2.client.client-secret}&quot;)\n    private String clientSecret;\n\n    @Value(&quot;${security.oauth2.resource.id}&quot;)\n    private String resourceId;\n\n    @Value(&quot;${security.oauth2.client.access-token-validity-seconds}&quot;)\n    private Integer tokenValidateSeconds;\n\n    @Value(&quot;${security.oauth2.client.token-secret}&quot;)\n    private String tokenSecret;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private TokenStore tokenStore;\n\n    @Autowired\n    private UserDetailsService userDetailsService;\n\n    @Autowired\n    private OauthAccessTokenRepository oauthAccessTokenRepository;\n\n    @Autowired\n    private OauthRefreshTokenRepository oauthRefreshTokenRepository;\n\n\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {\n        endpoints\n                .tokenStore(this.tokenStore)\n                .tokenEnhancer(tokenEnhancer())\n                .authenticationManager(this.authenticationManager)\n                .userDetailsService(userDetailsService);\n    }\n\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients\n                .inMemory()\n                .withClient(clientId)\n                .authorizedGrantTypes(&quot;client_credentials&quot;, &quot;password&quot;, &quot;refresh_token&quot;)\n                .authorities(&quot;ROLE_USER&quot;,&quot;ROLE_ADMIN&quot;)\n                .scopes(&quot;read&quot;,&quot;write&quot;,&quot;trust&quot;)\n                .resourceIds(resourceId)\n                .accessTokenValiditySeconds(tokenValidateSeconds)\n                .secret(bCryptPasswordEncoder().encode(clientSecret));\n    }\n\n    @Override\n    public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {\n        security.checkTokenAccess(&quot;isAuthenticated()&quot;);\n    }\n\n    @Bean\n    public BCryptPasswordEncoder bCryptPasswordEncoder(){\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    @Primary\n    public DefaultTokenServices tokenServices() {\n        DefaultTokenServices tokenServices = new DefaultTokenServices();\n        tokenServices.setSupportRefreshToken(true);\n        tokenServices.setTokenStore(this.tokenStore);\n        return tokenServices;\n    }\n\n    @Bean\n    public TokenEnhancer tokenEnhancer() {\n        return new TokenEnhancer() {\n            @Override\n            public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {\n                CustomUser user = (CustomUser) authentication.getPrincipal();\n\n                String token = JwtTokenHelper.generateToken(\n                        user.getIdUser(),\n                        user.getTenantID(),\n                        user.getIdEntity(),\n                        user.getIdBusinessUnit(),\n                        user.getProfile(),\n                        tokenValidateSeconds,\n                        tokenSecret\n                );\n\n                ((DefaultOAuth2AccessToken) accessToken).setValue(token);\n\n                return accessToken;\n            }\n        };\n\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "exception",
        "jdbc",
        "project",
        "resultset"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 9598,
            "user_id": 2044302,
            "user_type": "registered",
            "accept_rate": 74,
            "profile_image": "https://i.stack.imgur.com/JDKSu.jpg?s=128&g=1",
            "display_name": "Alexander Petrov",
            "link": "https://stackoverflow.com/users/2044302/alexander-petrov"
          },
          "score": 0,
          "creation_date": 1614977507,
          "post_id": 66499431,
          "comment_id": 117559644,
          "body_markdown": "I the stacktrace there should be the line number of the code that has thown the exception. Why dont you post the stacktrce ?",
          "body": "I the stacktrace there should be the line number of the code that has thown the exception. Why dont you post the stacktrce ?"
        },
        {
          "owner": {
            "reputation": 31,
            "user_id": 15196929,
            "user_type": "registered",
            "profile_image": "https://lh6.googleusercontent.com/--yklJ5Oriso/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucn6J8C7erZ4nhjd2NdexFgwYYV-DQ/s96-c/photo.jpg?sz=128",
            "display_name": "Shai Ace",
            "link": "https://stackoverflow.com/users/15196929/shai-ace"
          },
          "score": 0,
          "creation_date": 1614977958,
          "post_id": 66499431,
          "comment_id": 117559805,
          "body_markdown": "@AlexanderPetrov Here I just edited my question.",
          "body": "@AlexanderPetrov Here I just edited my question."
        },
        {
          "owner": {
            "reputation": 9598,
            "user_id": 2044302,
            "user_type": "registered",
            "accept_rate": 74,
            "profile_image": "https://i.stack.imgur.com/JDKSu.jpg?s=128&g=1",
            "display_name": "Alexander Petrov",
            "link": "https://stackoverflow.com/users/2044302/alexander-petrov"
          },
          "score": 0,
          "creation_date": 1614979343,
          "post_id": 66499431,
          "comment_id": 117560277,
          "body_markdown": "Post the code of getOneCoupon for more details.",
          "body": "Post the code of getOneCoupon for more details."
        },
        {
          "owner": {
            "reputation": 31,
            "user_id": 15196929,
            "user_type": "registered",
            "profile_image": "https://lh6.googleusercontent.com/--yklJ5Oriso/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucn6J8C7erZ4nhjd2NdexFgwYYV-DQ/s96-c/photo.jpg?sz=128",
            "display_name": "Shai Ace",
            "link": "https://stackoverflow.com/users/15196929/shai-ace"
          },
          "score": 0,
          "creation_date": 1614980212,
          "post_id": 66499431,
          "comment_id": 117560555,
          "body_markdown": "@AlexanderPetrov Added. I can add more code if required.",
          "body": "@AlexanderPetrov Added. I can add more code if required."
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 31,
                "user_id": 15196929,
                "user_type": "registered",
                "profile_image": "https://lh6.googleusercontent.com/--yklJ5Oriso/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucn6J8C7erZ4nhjd2NdexFgwYYV-DQ/s96-c/photo.jpg?sz=128",
                "display_name": "Shai Ace",
                "link": "https://stackoverflow.com/users/15196929/shai-ace"
              },
              "score": 0,
              "creation_date": 1614980359,
              "post_id": 66499761,
              "comment_id": 117560602,
              "body_markdown": "How would you recommend me to fix this issue if I cannot use any validation on DBDAO class? I use validations on the facade.",
              "body": "How would you recommend me to fix this issue if I cannot use any validation on DBDAO class? I use validations on the facade."
            },
            {
              "owner": {
                "reputation": 9598,
                "user_id": 2044302,
                "user_type": "registered",
                "accept_rate": 74,
                "profile_image": "https://i.stack.imgur.com/JDKSu.jpg?s=128&g=1",
                "display_name": "Alexander Petrov",
                "link": "https://stackoverflow.com/users/2044302/alexander-petrov"
              },
              "score": 0,
              "creation_date": 1614980672,
              "post_id": 66499761,
              "comment_id": 117560699,
              "body_markdown": "wrap it in try catch if you can not modify code",
              "body": "wrap it in try catch if you can not modify code"
            },
            {
              "owner": {
                "reputation": 31,
                "user_id": 15196929,
                "user_type": "registered",
                "profile_image": "https://lh6.googleusercontent.com/--yklJ5Oriso/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucn6J8C7erZ4nhjd2NdexFgwYYV-DQ/s96-c/photo.jpg?sz=128",
                "display_name": "Shai Ace",
                "link": "https://stackoverflow.com/users/15196929/shai-ace"
              },
              "score": 0,
              "creation_date": 1614981139,
              "post_id": 66499761,
              "comment_id": 117560832,
              "body_markdown": "Thanks again for the quick answer. Now, after I have edited my method and surrounded my code with try catch clause. I get a &#39;NullPointerException&#39;.",
              "body": "Thanks again for the quick answer. Now, after I have edited my method and surrounded my code with try catch clause. I get a &#39;NullPointerException&#39;."
            },
            {
              "owner": {
                "reputation": 9598,
                "user_id": 2044302,
                "user_type": "registered",
                "accept_rate": 74,
                "profile_image": "https://i.stack.imgur.com/JDKSu.jpg?s=128&g=1",
                "display_name": "Alexander Petrov",
                "link": "https://stackoverflow.com/users/2044302/alexander-petrov"
              },
              "score": 0,
              "creation_date": 1614981571,
              "post_id": 66499761,
              "comment_id": 117560931,
              "body_markdown": "Yeah because your getOneCoupon  method is returning null. You either do a null check or you put one else block in case resultSet.next() returns false and then throw the exception you want.",
              "body": "Yeah because your getOneCoupon  method is returning null. You either do a null check or you put one else block in case resultSet.next() returns false and then throw the exception you want."
            }
          ],
          "owner": {
            "reputation": 9598,
            "user_id": 2044302,
            "user_type": "registered",
            "accept_rate": 74,
            "profile_image": "https://i.stack.imgur.com/JDKSu.jpg?s=128&g=1",
            "display_name": "Alexander Petrov",
            "link": "https://stackoverflow.com/users/2044302/alexander-petrov"
          },
          "comment_count": 4,
          "score": 2,
          "creation_date": 1614979087,
          "answer_id": 66499761,
          "body_markdown": "You are looking for the problem at the wrong place it does not originate from  isCouponExist but it originates from getOneCoupon method.\r\n\r\n&gt;  at coupon.dbdao.CouponsDBDAO.getOneCoupon(CouponsDBDAO.java:155)\r\n\r\nThe problem is that your code in the getOneCoupon does not take into account that the record may not exist into the database.\r\n\r\nAfter reading through the code the problem in getOneMethod is that you dont take into account that the\r\n\r\nresultSet.next(); may be false\r\n\r\nit should be\r\n\r\n    if  (resultSet.next()) {\r\n            result = new Coupon(resultSet.getInt(1), resultSet.getInt(2), Category.categoryFor(resultSet.getInt(3)),\r\n                    resultSet.getString(4), resultSet.getString(5), resultSet.getDate(6), resultSet.getDate(7),\r\n                    resultSet.getInt(8), resultSet.getDouble(9), resultSet.getString(10));\r\n    }\r\n\r\nWith regards to your original question about throwing custom exception you should wrap your code with try catch clause for SQLException.\r\n\r\nStill in this particular case your code should take into account the possibility that there is no result.",
          "body": "<p>You are looking for the problem at the wrong place it does not originate from  isCouponExist but it originates from getOneCoupon method.</p>\n<blockquote>\n<p>at coupon.dbdao.CouponsDBDAO.getOneCoupon(CouponsDBDAO.java:155)</p>\n</blockquote>\n<p>The problem is that your code in the getOneCoupon does not take into account that the record may not exist into the database.</p>\n<p>After reading through the code the problem in getOneMethod is that you dont take into account that the</p>\n<p>resultSet.next(); may be false</p>\n<p>it should be</p>\n<pre><code>if  (resultSet.next()) {\n        result = new Coupon(resultSet.getInt(1), resultSet.getInt(2), Category.categoryFor(resultSet.getInt(3)),\n                resultSet.getString(4), resultSet.getString(5), resultSet.getDate(6), resultSet.getDate(7),\n                resultSet.getInt(8), resultSet.getDouble(9), resultSet.getString(10));\n}\n</code></pre>\n<p>With regards to your original question about throwing custom exception you should wrap your code with try catch clause for SQLException.</p>\n<p>Still in this particular case your code should take into account the possibility that there is no result.</p>\n"
        }
      ],
      "owner": {
        "reputation": 31,
        "user_id": 15196929,
        "user_type": "registered",
        "profile_image": "https://lh6.googleusercontent.com/--yklJ5Oriso/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucn6J8C7erZ4nhjd2NdexFgwYYV-DQ/s96-c/photo.jpg?sz=128",
        "display_name": "Shai Ace",
        "link": "https://stackoverflow.com/users/15196929/shai-ace"
      },
      "comment_count": 4,
      "view_count": 56,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1614977188,
      "question_id": 66499431,
      "body_markdown": "I have an issue with a boolean statement while trying to use a custom exception.\r\nwhen using my code to check if a coupons exists in the db, it returns true when it exists. however, when\r\ncoupon does not exist it throws me an sql exception: &quot;Illegal operation on empty result set.&quot; instead of my custom one.\r\n\r\n\r\n**My boolean Method:**\r\n\r\n    @Override\r\n    public boolean isCouponExist(int couponID) throws SQLException {\r\n    \tConnection connection = pool.getConnection();\r\n    \r\n    \ttry {\r\n    \t\tPreparedStatement statement = connection.prepareStatement(CHECK_EXISTS);\r\n    \t\tstatement.setInt(1, couponID);\r\n    \t\tResultSet rs = statement.executeQuery();\r\n    \r\n    \t\treturn rs.next();\r\n    \r\n    \t} finally {\r\n    \t\tpool.restoreConnection(connection);\r\n    \r\n    \t}\r\n    \r\n    }\r\n\r\n**Method to get One Coupon:**\r\n\r\n    @Override\r\n    public Coupon getOneCoupon(int couponID) throws SQLException {\r\n    \tConnection connection = pool.getConnection();\r\n    \r\n    \tCoupon result = null;\r\n    \r\n    \ttry {\r\n    \r\n    \t\tPreparedStatement statement = connection.prepareStatement(GET_ONE_COUPON);\r\n    \t\tstatement.setInt(1, couponID);\r\n    \t\tResultSet resultSet = statement.executeQuery();\r\n    \t\tresultSet.next();\r\n    \t\tresult = new Coupon(resultSet.getInt(1), resultSet.getInt(2), Category.categoryFor(resultSet.getInt(3)),\r\n    \t\t\t\tresultSet.getString(4), resultSet.getString(5), resultSet.getDate(6), resultSet.getDate(7),\r\n    \t\t\t\tresultSet.getInt(8), resultSet.getDouble(9), resultSet.getString(10));\r\n    \r\n    \t} finally {\r\n    \t\tpool.restoreConnection(connection);\r\n    \t}\r\n    \r\n    \treturn result;\r\n    \r\n    }\r\n\r\n**Method used in the facade for validation:**\r\n\r\n    public void purchaseCoupon(Coupon coupon) throws CouponExceptions, SQLException {\r\n    \r\n    \r\n    \t\tif(!coup.isCouponExist(coupon.getId())) {\r\n    \t\t\tthrow new CouponExceptions(&quot;ERROR: Coupon &quot; + coupon.getId() + &quot; does not exist.&quot;);\r\n    \t\t} \r\n    \t\r\n    \t}\r\n\r\n**Running the code:**\r\n\r\n\t\tCustomerFacade customer = (CustomerFacade) login.login(&quot;rotemb@gmail.com&quot;, &quot;1378&quot;, ClientType.CUSTOMER);\r\n\r\n\t\tCoupon p1 = coupDAO.getOneCoupon(55);\r\n\t\tcustomer.purchaseCoupon(p1);\r\n\r\nas you can see I gave it a non-existing ID number in order to get an exception.\r\n\r\n**StackTrace:**\r\n\r\n    Exception in thread &quot;main&quot; java.sql.SQLException: Illegal operation on empty result set.\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:89)\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:63)\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.result.ResultSetImpl.checkRowPos(ResultSetImpl.java:484)\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.result.ResultSetImpl.getObject(ResultSetImpl.java:1283)\r\n    \tat mysql.connector.java@8.0.18/com.mysql.cj.jdbc.result.ResultSetImpl.getInt(ResultSetImpl.java:786)\r\n    \tat coupon.dbdao.CouponsDBDAO.getOneCoupon(CouponsDBDAO.java:155)\r\n    \tat coupon.Program.main(Program.java:49)\r\n\r\n\r\n\r\n\r\n\r\nwhen trying to give a legal coupon ID I have no issues.\r\nwhen trying to give an illegal coupon ID instead of my custom exception I get SQLException:\r\n**&quot;Illegal operation on empty result set.&quot;**\r\n\r\nStill new to this.\r\n\r\n\r\n",
      "title": "Throwing custom exception on an empty ResultSet on JDBC",
      "body": "<p>I have an issue with a boolean statement while trying to use a custom exception.\nwhen using my code to check if a coupons exists in the db, it returns true when it exists. however, when\ncoupon does not exist it throws me an sql exception: &quot;Illegal operation on empty result set.&quot; instead of my custom one.</p>\n<p><strong>My boolean Method:</strong></p>\n<pre><code>@Override\npublic boolean isCouponExist(int couponID) throws SQLException {\n    Connection connection = pool.getConnection();\n\n    try {\n        PreparedStatement statement = connection.prepareStatement(CHECK_EXISTS);\n        statement.setInt(1, couponID);\n        ResultSet rs = statement.executeQuery();\n\n        return rs.next();\n\n    } finally {\n        pool.restoreConnection(connection);\n\n    }\n\n}\n</code></pre>\n<p><strong>Method to get One Coupon:</strong></p>\n<pre><code>@Override\npublic Coupon getOneCoupon(int couponID) throws SQLException {\n    Connection connection = pool.getConnection();\n\n    Coupon result = null;\n\n    try {\n\n        PreparedStatement statement = connection.prepareStatement(GET_ONE_COUPON);\n        statement.setInt(1, couponID);\n        ResultSet resultSet = statement.executeQuery();\n        resultSet.next();\n        result = new Coupon(resultSet.getInt(1), resultSet.getInt(2), Category.categoryFor(resultSet.getInt(3)),\n                resultSet.getString(4), resultSet.getString(5), resultSet.getDate(6), resultSet.getDate(7),\n                resultSet.getInt(8), resultSet.getDouble(9), resultSet.getString(10));\n\n    } finally {\n        pool.restoreConnection(connection);\n    }\n\n    return result;\n\n}\n</code></pre>\n<p><strong>Method used in the facade for validation:</strong></p>\n<pre><code>public void purchaseCoupon(Coupon coupon) throws CouponExceptions, SQLException {\n\n\n        if(!coup.isCouponExist(coupon.getId())) {\n            throw new CouponExceptions(&quot;ERROR: Coupon &quot; + coupon.getId() + &quot; does not exist.&quot;);\n        } \n    \n    }\n</code></pre>\n<p><strong>Running the code:</strong></p>\n<pre><code>    CustomerFacade customer = (CustomerFacade) login.login(&quot;rotemb@gmail.com&quot;, &quot;1378&quot;, ClientType.CUSTOMER);\n\n    Coupon p1 = coupDAO.getOneCoupon(55);\n    customer.purchaseCoupon(p1);\n</code></pre>\n<p>as you can see I gave it a non-existing ID number in order to get an exception.</p>\n<p><strong>StackTrace:</strong></p>\n<pre><code>Exception in thread &quot;main&quot; java.sql.SQLException: Illegal operation on empty result set.\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:89)\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:63)\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.result.ResultSetImpl.checkRowPos(ResultSetImpl.java:484)\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.result.ResultSetImpl.getObject(ResultSetImpl.java:1283)\n    at mysql.connector.java@8.0.18/com.mysql.cj.jdbc.result.ResultSetImpl.getInt(ResultSetImpl.java:786)\n    at coupon.dbdao.CouponsDBDAO.getOneCoupon(CouponsDBDAO.java:155)\n    at coupon.Program.main(Program.java:49)\n</code></pre>\n<p>when trying to give a legal coupon ID I have no issues.\nwhen trying to give an illegal coupon ID instead of my custom exception I get SQLException:\n<strong>&quot;Illegal operation on empty result set.&quot;</strong></p>\n<p>Still new to this.</p>\n"
    },
    {
      "tags": [
        "java",
        "opencv",
        "javacv"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 4779,
            "user_id": 523744,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/2c48446db0f9d0ead468326a8ca5f791?s=128&d=identicon&r=PG",
            "display_name": "Samuel Audet",
            "link": "https://stackoverflow.com/users/523744/samuel-audet"
          },
          "score": 1,
          "creation_date": 1615339313,
          "post_id": 66495333,
          "comment_id": 117659130,
          "body_markdown": "Unfortunately, the opencv_traincascade application has been deprecated, so it&#39;s no longer possible to train new cascade classifiers, see https://github.com/opencv/opencv/issues/13231",
          "body": "Unfortunately, the opencv_traincascade application has been deprecated, so it&#39;s no longer possible to train new cascade classifiers, see <a href=\"https://github.com/opencv/opencv/issues/13231\" rel=\"nofollow noreferrer\">github.com/opencv/opencv/issues/13231</a>"
        },
        {
          "owner": {
            "reputation": 31,
            "user_id": 15337550,
            "user_type": "registered",
            "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiAKpT5UDvBo2N-8CQIODgIBqp2spfhFt70DxNv=k-s128",
            "display_name": "FarshiD Naqizadeh",
            "link": "https://stackoverflow.com/users/15337550/farshid-naqizadeh"
          },
          "score": 0,
          "creation_date": 1615394128,
          "post_id": 66495333,
          "comment_id": 117678571,
          "body_markdown": "What can I do , and what replace method can do the same for me? @SamuelAudet",
          "body": "What can I do , and what replace method can do the same for me? @SamuelAudet"
        },
        {
          "owner": {
            "reputation": 4779,
            "user_id": 523744,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/2c48446db0f9d0ead468326a8ca5f791?s=128&d=identicon&r=PG",
            "display_name": "Samuel Audet",
            "link": "https://stackoverflow.com/users/523744/samuel-audet"
          },
          "score": 0,
          "creation_date": 1615444457,
          "post_id": 66495333,
          "comment_id": 117693779,
          "body_markdown": "I would try use the DNN module as suggested here: https://github.com/opencv/opencv/issues/13231#issuecomment-440577461",
          "body": "I would try use the DNN module as suggested here: <a href=\"https://github.com/opencv/opencv/issues/13231#issuecomment-440577461\" rel=\"nofollow noreferrer\">github.com/opencv/opencv/issues/13231#issuecomment-440577461</a>"
        }
      ],
      "owner": {
        "reputation": 31,
        "user_id": 15337550,
        "user_type": "registered",
        "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiAKpT5UDvBo2N-8CQIODgIBqp2spfhFt70DxNv=k-s128",
        "display_name": "FarshiD Naqizadeh",
        "link": "https://stackoverflow.com/users/15337550/farshid-naqizadeh"
      },
      "comment_count": 3,
      "view_count": 31,
      "answer_count": 0,
      "score": 3,
      "creation_date": 1614958358,
      "question_id": 66495333,
      "body_markdown": "I use some tutorial From Python and C++ to create my own code for Guess the feeling in images , already found some code and created some code but for use some file , I don&#39;t know what it is and what must to do for using it in java Like [emotion_classifier_model.xml][1]\r\n\r\n\r\nanyone can help me to share a code for using this file in JavaCv I will be grateful.(Need code to put image on it and guess the feeling with this xml file.)\r\n[link to github from tutorial  I use][2]\r\n\r\n\r\n  [1]: https://github.com/rionaldichandraseta/facifier/blob/master/src/models/emotion_classifier_model.xml\r\n  [2]: https://github.com/rionaldichandraseta/facifier\r\n\r\nI use CascadeClassifier From the package org.opencv.objdetect.CascadeClassifier and I think miss some point.\r\nif you know some tutorial in java that use opencv or javacv that tutorial the train and use the trained data I will be grateful too , for sharing it with me.",
      "title": "JavaCv - Use classifier file in javacv",
      "body": "<p>I use some tutorial From Python and C++ to create my own code for Guess the feeling in images , already found some code and created some code but for use some file , I don't know what it is and what must to do for using it in java Like <a href=\"https://github.com/rionaldichandraseta/facifier/blob/master/src/models/emotion_classifier_model.xml\" rel=\"nofollow noreferrer\">emotion_classifier_model.xml</a></p>\n<p>anyone can help me to share a code for using this file in JavaCv I will be grateful.(Need code to put image on it and guess the feeling with this xml file.)\n<a href=\"https://github.com/rionaldichandraseta/facifier\" rel=\"nofollow noreferrer\">link to github from tutorial  I use</a></p>\n<p>I use CascadeClassifier From the package org.opencv.objdetect.CascadeClassifier and I think miss some point.\nif you know some tutorial in java that use opencv or javacv that tutorial the train and use the trained data I will be grateful too , for sharing it with me.</p>\n"
    },
    {
      "tags": [
        "java",
        "google-bigquery",
        "google-cloud-dataflow",
        "apache-beam"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 596,
            "user_id": 11337033,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/09eb4b26112379d053993eafd56940c0?s=128&d=identicon&r=PG&f=1",
            "display_name": "Daniel Oliveira",
            "link": "https://stackoverflow.com/users/11337033/daniel-oliveira"
          },
          "score": 0,
          "creation_date": 1614998467,
          "post_id": 66495050,
          "comment_id": 117563836,
          "body_markdown": "That error message seems likely to be because of attempting to set EMAIL to an incorrect value. Is the dataString example you have accurate? Because if I&#39;m interpreting it correctly, it&#39;s an array with two `JSONObjects`, the first with only the `EMAIL` field defined, and the second with only the `ValidFrom` field defined. I could see problems coming up if the `EMAIL` field is getting set to NULL when writing to BQ.",
          "body": "That error message seems likely to be because of attempting to set EMAIL to an incorrect value. Is the dataString example you have accurate? Because if I&#39;m interpreting it correctly, it&#39;s an array with two <code>JSONObjects</code>, the first with only the <code>EMAIL</code> field defined, and the second with only the <code>ValidFrom</code> field defined. I could see problems coming up if the <code>EMAIL</code> field is getting set to NULL when writing to BQ."
        },
        {
          "owner": {
            "reputation": 585,
            "user_id": 1818286,
            "user_type": "registered",
            "accept_rate": 75,
            "profile_image": "https://www.gravatar.com/avatar/916fb757710228083e99c680800aec52?s=128&d=identicon&r=PG&f=1",
            "display_name": "moirK",
            "link": "https://stackoverflow.com/users/1818286/moirk"
          },
          "score": 0,
          "creation_date": 1615108494,
          "post_id": 66495050,
          "comment_id": 117585069,
          "body_markdown": "The data string is accurate, yes, Daniel. But pardon my mistake in not checking the type of element anywhere. Since I am checking the data types in my original code, I removed the unnecessary code in the snippet above.",
          "body": "The data string is accurate, yes, Daniel. But pardon my mistake in not checking the type of element anywhere. Since I am checking the data types in my original code, I removed the unnecessary code in the snippet above."
        }
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 585,
                "user_id": 1818286,
                "user_type": "registered",
                "accept_rate": 75,
                "profile_image": "https://www.gravatar.com/avatar/916fb757710228083e99c680800aec52?s=128&d=identicon&r=PG&f=1",
                "display_name": "moirK",
                "link": "https://stackoverflow.com/users/1818286/moirk"
              },
              "score": 1,
              "creation_date": 1615196210,
              "post_id": 66515934,
              "comment_id": 117606867,
              "body_markdown": "Thank you very much, @Jonny5, for the detailed answer. I used Solution 3 and successfully managed to write the repeated Strings to BigQuery. Appreciate your help.",
              "body": "Thank you very much, @Jonny5, for the detailed answer. I used Solution 3 and successfully managed to write the repeated Strings to BigQuery. Appreciate your help."
            }
          ],
          "owner": {
            "reputation": 1001,
            "user_id": 787036,
            "user_type": "registered",
            "accept_rate": 58,
            "profile_image": "https://www.gravatar.com/avatar/12c59376bcfadffc5ed7266d4c8337bd?s=128&d=identicon&r=PG",
            "display_name": "Jonny5",
            "link": "https://stackoverflow.com/users/787036/jonny5"
          },
          "comment_count": 1,
          "score": 2,
          "creation_date": 1615116207,
          "answer_id": 66515934,
          "body_markdown": "It seems you want to create\r\n\r\n1. one row with a **concatenated String** of email addresses, or\r\n1. a **row per email**, or \r\n1. one row with a repeated field.\r\n\r\nNote that is seems your `ValidFrom` field is of type `STRING`, *not* a repeated field, unless it is wrapped in a repeated field in a hierarchical schema.\r\n\r\nIn the example code you provided, you are creating a `JSONArray` and putting it into the `STRING` field, which I think cause issues as the types are incompatible. If you want to keep it as a plain `STRING` field, you can use Solution 1 below.\r\n\r\nAlso make sure that the name of your column in BigQuery matches the one in your code, I see you use both `ValidFrom` and `EMAIL` (might be a mistake in your posted code though).\r\n\r\n\r\n\r\n## Solution 1: One row with String field\r\n\r\nIn case you want to add **one row** with a **concatenated** `String` field in BigQuery, you can use the following:\r\n\r\n```java\r\n// Initialize your final row\r\nTableRow tableRow = new TableRow();\r\n\r\n// Find email addresses\r\nString [] emails = ... // your extraction logic\r\n\r\n// Build a concatenated string of emails\r\nString allEmails = String.join(&quot;;&quot;, emails);\r\n\r\n// Add the string field to the row\r\ntableRow.set(&#39;EMAILS&#39;, allEmails);\r\n\r\n```\r\n\r\n## Solution 2: Multiple rows with String field\r\n\r\nIn case you want to insert **multiple rows**, you your create multiple table rows:\r\n\r\n```java\r\n// Find email addresses\r\nString [] emails = ... // your extraction logic\r\n\r\n// Build a row per email\r\nfor(String email: emails) {\r\n    // Initialize your final row\r\n    TableRow tableRow = new TableRow();\r\n    tableRow.set(&#39;EMAIL&#39;, email);\r\n    \r\n    // TODO: do something with the row (add to list, or ...)\r\n}\r\n\r\n```\r\n\r\n## Solution 3: One row with REPEATED field\r\n\r\nIn case you want to add **one row** with a `REPEATED STRING` field in BigQuery, you can use the following:\r\n\r\n```java\r\n// Initialize your final row\r\nTableRow tableRow = new TableRow();\r\n\r\n// Find email addresses\r\nString [] emails = ... // your extraction logic\r\n\r\n// Build the repeated field\r\nList&lt;String&gt; emailCells = new ArrayList&lt;&gt;();\r\nfor(String email: emails) {\r\n    emailCells.add(email);\r\n}\r\n\r\n// Add the repeated field to the row\r\ntableRow.set(&#39;EMAILS&#39;, emailCells);\r\n```\r\n\r\n\r\nIf this is not what you&#39;re aiming for, please provide some more details.",
          "body": "<p>It seems you want to create</p>\n<ol>\n<li>one row with a <strong>concatenated String</strong> of email addresses, or</li>\n<li>a <strong>row per email</strong>, or</li>\n<li>one row with a repeated field.</li>\n</ol>\n<p>Note that is seems your <code>ValidFrom</code> field is of type <code>STRING</code>, <em>not</em> a repeated field, unless it is wrapped in a repeated field in a hierarchical schema.</p>\n<p>In the example code you provided, you are creating a <code>JSONArray</code> and putting it into the <code>STRING</code> field, which I think cause issues as the types are incompatible. If you want to keep it as a plain <code>STRING</code> field, you can use Solution 1 below.</p>\n<p>Also make sure that the name of your column in BigQuery matches the one in your code, I see you use both <code>ValidFrom</code> and <code>EMAIL</code> (might be a mistake in your posted code though).</p>\n<h2>Solution 1: One row with String field</h2>\n<p>In case you want to add <strong>one row</strong> with a <strong>concatenated</strong> <code>String</code> field in BigQuery, you can use the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// Initialize your final row\nTableRow tableRow = new TableRow();\n\n// Find email addresses\nString [] emails = ... // your extraction logic\n\n// Build a concatenated string of emails\nString allEmails = String.join(&quot;;&quot;, emails);\n\n// Add the string field to the row\ntableRow.set('EMAILS', allEmails);\n\n</code></pre>\n<h2>Solution 2: Multiple rows with String field</h2>\n<p>In case you want to insert <strong>multiple rows</strong>, you your create multiple table rows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// Find email addresses\nString [] emails = ... // your extraction logic\n\n// Build a row per email\nfor(String email: emails) {\n    // Initialize your final row\n    TableRow tableRow = new TableRow();\n    tableRow.set('EMAIL', email);\n    \n    // TODO: do something with the row (add to list, or ...)\n}\n\n</code></pre>\n<h2>Solution 3: One row with REPEATED field</h2>\n<p>In case you want to add <strong>one row</strong> with a <code>REPEATED STRING</code> field in BigQuery, you can use the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// Initialize your final row\nTableRow tableRow = new TableRow();\n\n// Find email addresses\nString [] emails = ... // your extraction logic\n\n// Build the repeated field\nList&lt;String&gt; emailCells = new ArrayList&lt;&gt;();\nfor(String email: emails) {\n    emailCells.add(email);\n}\n\n// Add the repeated field to the row\ntableRow.set('EMAILS', emailCells);\n</code></pre>\n<p>If this is not what you're aiming for, please provide some more details.</p>\n"
        }
      ],
      "owner": {
        "reputation": 585,
        "user_id": 1818286,
        "user_type": "registered",
        "accept_rate": 75,
        "profile_image": "https://www.gravatar.com/avatar/916fb757710228083e99c680800aec52?s=128&d=identicon&r=PG&f=1",
        "display_name": "moirK",
        "link": "https://stackoverflow.com/users/1818286/moirk"
      },
      "comment_count": 2,
      "view_count": 44,
      "answer_count": 1,
      "score": 3,
      "creation_date": 1614957267,
      "question_id": 66495050,
      "body_markdown": "I have a data stream containing `Strings` which look like `JSONArrays`. I want to parse those Strings and write to BigQuery table using Apache Beam but am getting an error while writing repeated Strings. \r\n\r\nHere&#180;s how I convert my string to `TableRow`:\r\n\r\n        String dataString = &quot;[{\\&quot;EMAIL\\&quot;: [\\&quot;zog@yahoo.com\\&quot;]}]&quot;;\r\n    \r\n        JSONArray jsonArray = new JSONArray(dataString);\r\n        TableRow tableRow = new TableRow();\r\n    \r\n        for (int i = 0; i &lt; jsonArray.length(); i++) {\r\n          JSONArray emailArray = new JSONArray(jsonArray.getJSONObject(i).get(&quot;EMAIL&quot;).toString());\r\n    \r\n          tableRow.set(&quot;EMAIL&quot;, emailArray); //Results in error\r\n        }\r\n\r\nHere&#180;s what my BigQuery schema looks like:\r\n\r\n    [\r\n      {\r\n        &quot;name&quot;: &quot;EMAIL&quot;,\r\n        &quot;type&quot;: &quot;STRING&quot;,\r\n        &quot;mode&quot;: &quot;REPEATED&quot;\r\n      }\r\n    ]\r\n\r\nI have managed to write a similar repeated String to BigQuery table using Python but unable to do it using Apache Beam. I suppose I am not saving the right key-value pair in `TableRow`. The error I am getting now is: \r\n\r\n\r\n    java.io.IOException: Insert failed: [{&quot;errors&quot;:[{&quot;debugInfo&quot;:&quot;&quot;,&quot;location&quot;:&quot;email&quot;,&quot;message&quot;:&quot;This field is not a record.&quot;,&quot;reason&quot;:&quot;invalid&quot;}],&quot;index&quot;:0}]\r\n\r\nI need help regarding how to save a similar repeated String to BigQuery without creating a record and would appreciate any advice or suggestions. Thanks in advance.\r\n",
      "title": "Write repeated Strings to BigQuery using Apache Beam",
      "body": "<p>I have a data stream containing <code>Strings</code> which look like <code>JSONArrays</code>. I want to parse those Strings and write to BigQuery table using Apache Beam but am getting an error while writing repeated Strings.</p>\n<p>Here´s how I convert my string to <code>TableRow</code>:</p>\n<pre><code>    String dataString = &quot;[{\\&quot;EMAIL\\&quot;: [\\&quot;zog@yahoo.com\\&quot;]}]&quot;;\n\n    JSONArray jsonArray = new JSONArray(dataString);\n    TableRow tableRow = new TableRow();\n\n    for (int i = 0; i &lt; jsonArray.length(); i++) {\n      JSONArray emailArray = new JSONArray(jsonArray.getJSONObject(i).get(&quot;EMAIL&quot;).toString());\n\n      tableRow.set(&quot;EMAIL&quot;, emailArray); //Results in error\n    }\n</code></pre>\n<p>Here´s what my BigQuery schema looks like:</p>\n<pre><code>[\n  {\n    &quot;name&quot;: &quot;EMAIL&quot;,\n    &quot;type&quot;: &quot;STRING&quot;,\n    &quot;mode&quot;: &quot;REPEATED&quot;\n  }\n]\n</code></pre>\n<p>I have managed to write a similar repeated String to BigQuery table using Python but unable to do it using Apache Beam. I suppose I am not saving the right key-value pair in <code>TableRow</code>. The error I am getting now is:</p>\n<pre><code>java.io.IOException: Insert failed: [{&quot;errors&quot;:[{&quot;debugInfo&quot;:&quot;&quot;,&quot;location&quot;:&quot;email&quot;,&quot;message&quot;:&quot;This field is not a record.&quot;,&quot;reason&quot;:&quot;invalid&quot;}],&quot;index&quot;:0}]\n</code></pre>\n<p>I need help regarding how to save a similar repeated String to BigQuery without creating a record and would appreciate any advice or suggestions. Thanks in advance.</p>\n"
    },
    {
      "tags": [
        "java"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 630,
            "user_id": 9630366,
            "user_type": "registered",
            "profile_image": "https://i.stack.imgur.com/JG9mq.png?s=128&g=1",
            "display_name": "salazarin",
            "link": "https://stackoverflow.com/users/9630366/salazarin"
          },
          "score": 0,
          "creation_date": 1614936504,
          "post_id": 66489940,
          "comment_id": 117542990,
          "body_markdown": "You are using `b` before declaring it which is why it doesn&#39;t compile when you print `b`. Line 8 compiles fine because you&#39;ve declared both `a` and `b` before using them in `println()` statement.",
          "body": "You are using <code>b</code> before declaring it which is why it doesn&#39;t compile when you print <code>b</code>. Line 8 compiles fine because you&#39;ve declared both <code>a</code> and <code>b</code> before using them in <code>println()</code> statement."
        },
        {
          "owner": {
            "reputation": 61,
            "user_id": 2611716,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/0d6c6938bee08c9abc4a36a1a8fe2761?s=128&d=identicon&r=PG",
            "display_name": "jarek",
            "link": "https://stackoverflow.com/users/2611716/jarek"
          },
          "score": 1,
          "creation_date": 1614936707,
          "post_id": 66489940,
          "comment_id": 117543064,
          "body_markdown": "but if comment the line 8 it this will compiled well, and there is also usage of b. (b = 3)",
          "body": "but if comment the line 8 it this will compiled well, and there is also usage of b. (b = 3)"
        },
        {
          "owner": {
            "reputation": 20120,
            "user_id": 1321564,
            "user_type": "registered",
            "accept_rate": 71,
            "profile_image": "https://www.gravatar.com/avatar/f61fbcc7c59e134d888f2e34cd216658?s=128&d=identicon&r=PG",
            "display_name": "Benjamin M",
            "link": "https://stackoverflow.com/users/1321564/benjamin-m"
          },
          "score": 1,
          "creation_date": 1614936844,
          "post_id": 66489940,
          "comment_id": 117543105,
          "body_markdown": "But you still can&#39;t &quot;use&quot; b. Try `a = b`. Doesn&#39;t work for the same reason. Not sure why the compiler lets you assign some value to `b`. But as soon as you try to access `b` it will blow up. And that&#39;s the most important part.",
          "body": "But you still can&#39;t &quot;use&quot; b. Try <code>a = b</code>. Doesn&#39;t work for the same reason. Not sure why the compiler lets you assign some value to <code>b</code>. But as soon as you try to access <code>b</code> it will blow up. And that&#39;s the most important part."
        },
        {
          "owner": {
            "reputation": 61,
            "user_id": 2611716,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/0d6c6938bee08c9abc4a36a1a8fe2761?s=128&d=identicon&r=PG",
            "display_name": "jarek",
            "link": "https://stackoverflow.com/users/2611716/jarek"
          },
          "score": 0,
          "creation_date": 1614937270,
          "post_id": 66489940,
          "comment_id": 117543278,
          "body_markdown": "Then the rule: the variable can be assigned before declaration but cannot be &quot;used&quot;.",
          "body": "Then the rule: the variable can be assigned before declaration but cannot be &quot;used&quot;."
        }
      ],
      "answers": [
        {
          "owner": {
            "reputation": 20120,
            "user_id": 1321564,
            "user_type": "registered",
            "accept_rate": 71,
            "profile_image": "https://www.gravatar.com/avatar/f61fbcc7c59e134d888f2e34cd216658?s=128&d=identicon&r=PG",
            "display_name": "Benjamin M",
            "link": "https://stackoverflow.com/users/1321564/benjamin-m"
          },
          "comment_count": 0,
          "score": 0,
          "creation_date": 1614936716,
          "answer_id": 66490007,
          "body_markdown": "In Eclipse I get a better Error message:\r\n\r\n```\r\nCannot reference a field before it is defined\r\n```\r\n\r\nNow it should be pretty obvious why you get the error.",
          "body": "<p>In Eclipse I get a better Error message:</p>\n<pre><code>Cannot reference a field before it is defined\n</code></pre>\n<p>Now it should be pretty obvious why you get the error.</p>\n"
        },
        {
          "comments": [
            {
              "owner": {
                "reputation": 25842,
                "user_id": 897024,
                "user_type": "registered",
                "accept_rate": 100,
                "profile_image": "https://www.gravatar.com/avatar/411289c9e255e94b67eb723e3f4ef18b?s=128&d=identicon&r=PG",
                "display_name": "kapex",
                "link": "https://stackoverflow.com/users/897024/kapex"
              },
              "score": 0,
              "creation_date": 1614937395,
              "post_id": 66490077,
              "comment_id": 117543329,
              "body_markdown": "Is there any use case for allowing assignment before declaration?",
              "body": "Is there any use case for allowing assignment before declaration?"
            },
            {
              "owner": {
                "reputation": 62653,
                "user_id": 1064245,
                "user_type": "registered",
                "accept_rate": 82,
                "profile_image": "https://www.gravatar.com/avatar/9e1ed9c48a989a39ff2a14b1d36c177a?s=128&d=identicon&r=PG&f=1",
                "display_name": "M A",
                "link": "https://stackoverflow.com/users/1064245/m-a"
              },
              "score": 0,
              "creation_date": 1614937698,
              "post_id": 66490077,
              "comment_id": 117543453,
              "body_markdown": "@kapex if the declaration contains an initializer then I don&#39;t see a use case for it.",
              "body": "@kapex if the declaration contains an initializer then I don&#39;t see a use case for it."
            },
            {
              "owner": {
                "reputation": 61,
                "user_id": 2611716,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0d6c6938bee08c9abc4a36a1a8fe2761?s=128&d=identicon&r=PG",
                "display_name": "jarek",
                "link": "https://stackoverflow.com/users/2611716/jarek"
              },
              "score": 0,
              "creation_date": 1614937897,
              "post_id": 66490077,
              "comment_id": 117543526,
              "body_markdown": "Integer a = 1;\n    {\n        a = 2;\n        b = 3;\n    }\n    Integer b;\n\nthis can be the use case. Output is: &quot;2 3&quot;.",
              "body": "Integer a = 1;     {         a = 2;         b = 3;     }     Integer b;  this can be the use case. Output is: &quot;2 3&quot;."
            },
            {
              "owner": {
                "reputation": 173,
                "user_id": 15244370,
                "user_type": "unregistered",
                "profile_image": "https://www.gravatar.com/avatar/79808e8e9014913770d0990794a7445a?s=128&d=identicon&r=PG",
                "display_name": "user15244370",
                "link": "https://stackoverflow.com/users/15244370/user15244370"
              },
              "score": 0,
              "creation_date": 1614938399,
              "post_id": 66490077,
              "comment_id": 117543718,
              "body_markdown": "@jarek maybe an example, but not a real use case; why would I not just do `Integer a = 2; Integer b = 3;`? (unless I want to do code harder to read; or test developers knowledge)",
              "body": "@jarek maybe an example, but not a real use case; why would I not just do <code>Integer a = 2; Integer b = 3;</code>? (unless I want to do code harder to read; or test developers knowledge)"
            },
            {
              "owner": {
                "reputation": 61,
                "user_id": 2611716,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0d6c6938bee08c9abc4a36a1a8fe2761?s=128&d=identicon&r=PG",
                "display_name": "jarek",
                "link": "https://stackoverflow.com/users/2611716/jarek"
              },
              "score": 0,
              "creation_date": 1614938578,
              "post_id": 66490077,
              "comment_id": 117543792,
              "body_markdown": "Yes, I agree that it isn&#39;t real use case, only for fun.",
              "body": "Yes, I agree that it isn&#39;t real use case, only for fun."
            },
            {
              "owner": {
                "reputation": 61,
                "user_id": 2611716,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0d6c6938bee08c9abc4a36a1a8fe2761?s=128&d=identicon&r=PG",
                "display_name": "jarek",
                "link": "https://stackoverflow.com/users/2611716/jarek"
              },
              "score": 0,
              "creation_date": 1614940260,
              "post_id": 66490077,
              "comment_id": 117544529,
              "body_markdown": "&quot;The reference is not on the left hand side of an assignment expression (&#167;15.26);&quot;\n\nThis is the answer to my question. Thanks.\n\n&quot;The reference appears either in an instance variable initializer of C or in an instance initializer of C (&#167;8.6);&quot;\n\nbut still into an instance initializer, hmm...",
              "body": "&quot;The reference is not on the left hand side of an assignment expression (&#167;15.26);&quot;  This is the answer to my question. Thanks.  &quot;The reference appears either in an instance variable initializer of C or in an instance initializer of C (&#167;8.6);&quot;  but still into an instance initializer, hmm..."
            }
          ],
          "owner": {
            "reputation": 62653,
            "user_id": 1064245,
            "user_type": "registered",
            "accept_rate": 82,
            "profile_image": "https://www.gravatar.com/avatar/9e1ed9c48a989a39ff2a14b1d36c177a?s=128&d=identicon&r=PG&f=1",
            "display_name": "M A",
            "link": "https://stackoverflow.com/users/1064245/m-a"
          },
          "comment_count": 6,
          "score": 4,
          "creation_date": 1614937025,
          "answer_id": 66490077,
          "body_markdown": "This is part of the restrictions on field references in initializers as documented by the [Java Language Specification](https://docs.oracle.com/javase/specs/jls/se15/html/jls-8.html#jls-8.3.3):\r\n\r\n&gt;References to a field are sometimes restricted, even through the field is in scope. The following rules constrain forward references to a field (where the use textually precedes the field declaration) as well as self-reference (where the field is used in its own initializer).\r\n\r\n\r\n&gt;...\r\n\r\n&gt;**For a reference by simple name to an instance variable f declared in class C, it is a compile-time error if:**\r\n&gt;- The reference appears either in an instance variable initializer of C or in an instance initializer of C (&#167;8.6); and\r\n&gt;- The reference appears in the initializer of f&#39;s own declarator or at a point to the left of f&#39;s declarator; and\r\n&gt;- The reference is not on the left hand side of an assignment expression (&#167;15.26); and\r\n&gt;- The innermost class enclosing the reference is C.\r\n\r\n\r\nThe JLS describes why these restrictions apply:\r\n\r\n&gt;The restrictions above are designed to catch, at compile time, circular or otherwise malformed initializations.\r\n\r\nSo basically to avoid scenarios like:\r\n\r\n    class Test {\r\n        int i = j;\r\n        int j = i;\r\n    }\r\n\r\n(even though in your case printing the field may not be a dangerous thing to do)",
          "body": "<p>This is part of the restrictions on field references in initializers as documented by the <a href=\"https://docs.oracle.com/javase/specs/jls/se15/html/jls-8.html#jls-8.3.3\" rel=\"nofollow noreferrer\">Java Language Specification</a>:</p>\n<blockquote>\n<p>References to a field are sometimes restricted, even through the field is in scope. The following rules constrain forward references to a field (where the use textually precedes the field declaration) as well as self-reference (where the field is used in its own initializer).</p>\n</blockquote>\n<blockquote>\n<p>...</p>\n</blockquote>\n<blockquote>\n<p><strong>For a reference by simple name to an instance variable f declared in class C, it is a compile-time error if:</strong></p>\n<ul>\n<li>The reference appears either in an instance variable initializer of C or in an instance initializer of C (§8.6); and</li>\n<li>The reference appears in the initializer of f's own declarator or at a point to the left of f's declarator; and</li>\n<li>The reference is not on the left hand side of an assignment expression (§15.26); and</li>\n<li>The innermost class enclosing the reference is C.</li>\n</ul>\n</blockquote>\n<p>The JLS describes why these restrictions apply:</p>\n<blockquote>\n<p>The restrictions above are designed to catch, at compile time, circular or otherwise malformed initializations.</p>\n</blockquote>\n<p>So basically to avoid scenarios like:</p>\n<pre><code>class Test {\n    int i = j;\n    int j = i;\n}\n</code></pre>\n<p>(even though in your case printing the field may not be a dangerous thing to do)</p>\n"
        }
      ],
      "owner": {
        "reputation": 61,
        "user_id": 2611716,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/0d6c6938bee08c9abc4a36a1a8fe2761?s=128&d=identicon&r=PG",
        "display_name": "jarek",
        "link": "https://stackoverflow.com/users/2611716/jarek"
      },
      "comment_count": 4,
      "view_count": 82,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1614936402,
      "question_id": 66489940,
      "body_markdown": "I&#39;m plaing with the initialization order and cannot explain why line 7 is compiled `b = 3;` but the next line 8 `System.out.println(&quot;b: &quot; + b);` isn&#39;t. Can somebody explain this and fill up this knowledge gap?\r\n\r\nWithout line 8 the code compiles well and print &quot;2 4&quot;.\r\n\r\n~~~ lang-java\r\npublic class InitializationOrder {\r\n\r\n    Integer a = 1;\r\n\r\n    {\r\n        a = 2;\r\n        b = 3;\r\n        System.out.println(&quot;b: &quot; + b); // DOES NOT COMPILE\r\n// InitializationOrder.java:8: error: illegal forward reference\r\n//         System.out.println(&quot;b: &quot; + b);\r\n//                                    ^\r\n// 1 error\r\n// error: compilation failed\r\n    }\r\n\r\n    Integer b = 4;\r\n\r\n    public InitializationOrder() {\r\n        System.out.println(a + &quot; &quot; + b); // 2 4 - when line 8 is commented\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        InitializationOrder obj = new InitializationOrder();\r\n    }\r\n}\r\n~~~",
      "title": "Why can I assign to a variable declared after the initalizer, but not print it?",
      "body": "<p>I'm plaing with the initialization order and cannot explain why line 7 is compiled <code>b = 3;</code> but the next line 8 <code>System.out.println(&quot;b: &quot; + b);</code> isn't. Can somebody explain this and fill up this knowledge gap?</p>\n<p>Without line 8 the code compiles well and print &quot;2 4&quot;.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class InitializationOrder {\n\n    Integer a = 1;\n\n    {\n        a = 2;\n        b = 3;\n        System.out.println(&quot;b: &quot; + b); // DOES NOT COMPILE\n// InitializationOrder.java:8: error: illegal forward reference\n//         System.out.println(&quot;b: &quot; + b);\n//                                    ^\n// 1 error\n// error: compilation failed\n    }\n\n    Integer b = 4;\n\n    public InitializationOrder() {\n        System.out.println(a + &quot; &quot; + b); // 2 4 - when line 8 is commented\n    }\n\n    public static void main(String[] args) {\n        InitializationOrder obj = new InitializationOrder();\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "arrays",
        "algorithm",
        "recursion",
        "integer"
      ],
      "comments": [
        {
          "owner": {
            "reputation": 36023,
            "user_id": 1243641,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/a70aa9d494bf438c8b56aced999e897f?s=128&d=identicon&r=PG",
            "display_name": "Scott Sauyet",
            "link": "https://stackoverflow.com/users/1243641/scott-sauyet"
          },
          "score": 1,
          "creation_date": 1614897038,
          "post_id": 66483400,
          "comment_id": 117533395,
          "body_markdown": "If it weren&#39;t for the pruning, for 50,000 primes and five exponents, you would have to check 50000 * 49999 * 49998 * 49997 * 49996 (over 3.1 * 10^23) products.  That might take some time.",
          "body": "If it weren&#39;t for the pruning, for 50,000 primes and five exponents, you would have to check 50000 * 49999 * 49998 * 49997 * 49996 (over 3.1 * 10^23) products.  That might take some time."
        },
        {
          "owner": {
            "reputation": 36023,
            "user_id": 1243641,
            "user_type": "registered",
            "accept_rate": 100,
            "profile_image": "https://www.gravatar.com/avatar/a70aa9d494bf438c8b56aced999e897f?s=128&d=identicon&r=PG",
            "display_name": "Scott Sauyet",
            "link": "https://stackoverflow.com/users/1243641/scott-sauyet"
          },
          "score": 0,
          "creation_date": 1614897409,
          "post_id": 66483400,
          "comment_id": 117533495,
          "body_markdown": "If you read Javascript, I wrote  [an implementation](http://link.fourwindssoft.com/15) of this idea, recursively choosing an exponent, then mapping the primes to the result of using that prime with that exponent and a reduced target, removing duplicates at every stage.  The technique might or might not help with your larger data sets.  My Java is too rusty to tell.",
          "body": "If you read Javascript, I wrote  <a href=\"http://link.fourwindssoft.com/15\" rel=\"nofollow noreferrer\">an implementation</a> of this idea, recursively choosing an exponent, then mapping the primes to the result of using that prime with that exponent and a reduced target, removing duplicates at every stage.  The technique might or might not help with your larger data sets.  My Java is too rusty to tell."
        },
        {
          "owner": {
            "reputation": 283,
            "user_id": 11428287,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/31c487dd96cb2a9da639598bd2dd8124?s=128&d=identicon&r=PG&f=1",
            "display_name": "MC From Scratch",
            "link": "https://stackoverflow.com/users/11428287/mc-from-scratch"
          },
          "score": 0,
          "creation_date": 1614897477,
          "post_id": 66483400,
          "comment_id": 117533512,
          "body_markdown": "@ScottSauyet Yes, I agree with you. The main speed-up has to come from the pruning. a relatively small amount of primes even with small exponents would already surpass the `N` I am aiming for. So smart pruning could reduce more than 99% (perhaps) of the computation I assume.",
          "body": "@ScottSauyet Yes, I agree with you. The main speed-up has to come from the pruning. a relatively small amount of primes even with small exponents would already surpass the <code>N</code> I am aiming for. So smart pruning could reduce more than 99% (perhaps) of the computation I assume."
        },
        {
          "owner": {
            "reputation": 34767,
            "user_id": 585411,
            "user_type": "registered",
            "accept_rate": 60,
            "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1",
            "display_name": "btilly",
            "link": "https://stackoverflow.com/users/585411/btilly"
          },
          "score": 0,
          "creation_date": 1614918589,
          "post_id": 66483400,
          "comment_id": 117537637,
          "body_markdown": "Do you need the count, or the absolute solutions?  It is possible to use dynamic programming to generate a data structure from which you can count or generate solutions at will.  But doing so is more of a win if the count is the main thing that you want.",
          "body": "Do you need the count, or the absolute solutions?  It is possible to use dynamic programming to generate a data structure from which you can count or generate solutions at will.  But doing so is more of a win if the count is the main thing that you want."
        },
        {
          "owner": {
            "reputation": 283,
            "user_id": 11428287,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/31c487dd96cb2a9da639598bd2dd8124?s=128&d=identicon&r=PG&f=1",
            "display_name": "MC From Scratch",
            "link": "https://stackoverflow.com/users/11428287/mc-from-scratch"
          },
          "score": 0,
          "creation_date": 1614929110,
          "post_id": 66483400,
          "comment_id": 117540194,
          "body_markdown": "@btilly The count itself could be very useful indeed as well!",
          "body": "@btilly The count itself could be very useful indeed as well!"
        }
      ],
      "owner": {
        "reputation": 283,
        "user_id": 11428287,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/31c487dd96cb2a9da639598bd2dd8124?s=128&d=identicon&r=PG&f=1",
        "display_name": "MC From Scratch",
        "link": "https://stackoverflow.com/users/11428287/mc-from-scratch"
      },
      "comment_count": 5,
      "view_count": 53,
      "answer_count": 0,
      "score": 3,
      "creation_date": 1614893763,
      "question_id": 66483400,
      "body_markdown": "I am looking to write a function that, given a set of exponents and a set of primes, it would generate all possible integers that may be formed using primes from the given set, and raising them to exponents found in the given set of exponents, with the restriction that the integers may not exceed a limit `N`. The set of primes contains a number of elements not less than the number of elements in the exponents&#39; set. All exponents have to be used, and they are not necessarily distinct. The set of primes is sorted, and so is the list of exponents, from lowest to biggest. \r\n\r\nFor example, say our set of primes is `{11,19,29,31}`. The set of exponents is `{1,4}`, and `N = 20,000,000`. So, we&#39;re talking about products satisying `P = a^1*b^4`.\r\n\r\n`P = 11^1 * 19^4 = 1,433,531`\r\n\r\n`P = 11^1 * 29^4 = 7,780,091`\r\n\r\n`P = 11^1 * 31^4 = 10,158,731`\r\n\r\n`P = 19^1 * 29^4 = 13,438,339`\r\n\r\n`P = 19^1 * 31^4 = 17,546,899`\r\n\r\n`P = 29^1 * 31^4 = 26,782,109` ---- discarded due to limit restriction\r\n\r\n`P = 19^1 * 11^4 = 278,179`\r\n\r\n`P = 29^1 * 11^4 = 424,589`\r\n\r\n`P = 29^1 * 19^4 = 3,779,309`\r\n\r\n`P = 31^1 * 11^4 = 453,871`\r\n\r\n`P = 31^1 * 19^4 = 4,039,951`\r\n\r\n`P = 31^1 * 29^4 = 21,925,711` ---- discarded due to limit restriction\r\n\r\nNote that every prime may have any exponent, and it is not necessary for example that the lower prime would have the lower exponent, because exchanging the exponents between the primes would result in different integers. This is not the case however if the set of exponents were `{1,1}` because then exchanging them between any 2 primes would not change the result, I.E `11^1 * 31^1 = 31^1 * 11^1`.\r\n\r\nFor my purposes, the set of exponents contains very few elements, about `5`, but `N` is very large, more than `10^13`, and the set of primes contains many primes, over `50,000` say. It is therefore challenging to create all possible integers efficiently. \r\n\r\nThe code I have come up with uses recursion. It generates all possible such integers, keeping track of: an arraylist which represents the set of exponents, called `partition` , `used`=number of exponents used in our current product, `partitionIndex` = the index of the exponent we&#39;re going to use in the current function call, an arraylist of the primes we have used thus far - `primesUsed` (to avoid using the same prime twice in the product) and finally, `prod` = our current product. The recursion will stop when `used` is as big as our exponents list, meaning we have used all the exponents and our product is viable. Pruning is done when our current product is too big to multiply by any other prime number. Every viable integer is added to an arraylist of `products`. Here&#39;s the code: \r\n\r\n```\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.HashSet;\r\nimport java.util.List;\r\nimport java.util.Set;\r\n\r\npublic class test3 {\r\n\r\n\tpublic static long N;\r\n\tpublic static long [] primes;\r\n\tpublic static ArrayList &lt;Long&gt; products;\r\n\t\r\n\tpublic static void main(String[] args) \r\n\t{\r\n\t\tN = 20000000;\r\n\t\tprimes = new long [] {11,19,29,31};\r\n\t\tproducts = new ArrayList &lt;Long&gt;();\r\n\t\t\r\n\t\tArrayList &lt;Long&gt; partition = new ArrayList &lt;Long&gt;();\r\n\t\tpartition.add(1L);\r\n\t\tpartition.add(4L);\r\n\t\t\r\n\t\tgenerateProducts(partition , 0 , 0 , new ArrayList &lt;Long&gt;() , 1);\r\n\t\t\r\n\t\t//Set &lt;Long&gt; discardDups = new HashSet&lt;&gt;(products);   --- for list {1,4}, can be skipped.\r\n\t\t//products.clear();                                   --- but for {1,1} has to be used, otherwise there are duplicates\r\n\t\t//products.addAll(discardDups);\r\n\t\t\r\n\t\tCollections.sort(products);\r\n\t\t\r\n\t\tSystem.out.println(products);\r\n\t\tSystem.out.println(products.size());\r\n\t}\r\n\t\r\n\tpublic static void generateProducts (List &lt;Long&gt; partition , int used , int partitionIndex , ArrayList &lt;Long&gt; primesUsed , long prod)\r\n    {\r\n        if (used == partition.size())\r\n        {\r\n            products.add(prod);\r\n            return;\r\n        }\r\n\r\n        for (int i = 0 ; i &lt; primes.length &amp;&amp; primes.length - i + 1 &gt;= partition.size() - partitionIndex &amp;&amp; prod * Math.pow(primes[i], partition.get(partitionIndex)) &lt;= N ; i++)\r\n        {\r\n            if (!primesUsed.contains(primes[i]))\r\n            {\r\n                primesUsed.add(primes[i]);\r\n                generateProducts(partition , used + 1 , partitionIndex + 1 , primesUsed , (long) (prod * Math.pow(primes[i], partition.get(partitionIndex))));\r\n                primesUsed.remove(primesUsed.size() - 1);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\nThe drawbacks of this function are:\r\n\r\n1. It generates many duplicates. Because the counter in the function starts from `0` everytime, and it checks we&#39;re not reusing any prime, then when the exponents are the same, it generates a duplicate, I.E it treats `11^1 * 31^1` and `31^1 * 11^1` differently. \r\n\r\n2. The algorithm overall takes a very long time. Again, I assume, because the counter starts from 0 over and over. \r\n\r\nI am well aware I can get rid of the duplicates using a `Set` but this is extremely time consuming. Also, keeping track of the highest prime index used and starting from it with every function call makes the algorithm faster, but then products with the bigger prime having the lower exponent are not generated. \r\n\r\nWhat I am interested in is a way to generate all such products efficiently. I am not sure if my code can be altered to it. If it can, then it should be able to generate all possible such integers, it should avoid generating duplicates in the first place, and the &quot;stopping&quot; conditions, or pruning, should be better to spare as many redundant function calls as possible.\r\n\r\nPerhaps another approach altogether is necessary, but the goal remains the same. I would appreciate any direction as to how to change my code to avoid duplicates in the first place without skipping any possible integer, and making it faster. If duplicates cannot be avoided, then atleast a direction how to reduce the amount of function calls. Any other approach to achieve the same goal is most welcome!",
      "title": "Given primes and exponents, generating all possible integers smaller than N",
      "body": "<p>I am looking to write a function that, given a set of exponents and a set of primes, it would generate all possible integers that may be formed using primes from the given set, and raising them to exponents found in the given set of exponents, with the restriction that the integers may not exceed a limit <code>N</code>. The set of primes contains a number of elements not less than the number of elements in the exponents' set. All exponents have to be used, and they are not necessarily distinct. The set of primes is sorted, and so is the list of exponents, from lowest to biggest.</p>\n<p>For example, say our set of primes is <code>{11,19,29,31}</code>. The set of exponents is <code>{1,4}</code>, and <code>N = 20,000,000</code>. So, we're talking about products satisying <code>P = a^1*b^4</code>.</p>\n<p><code>P = 11^1 * 19^4 = 1,433,531</code></p>\n<p><code>P = 11^1 * 29^4 = 7,780,091</code></p>\n<p><code>P = 11^1 * 31^4 = 10,158,731</code></p>\n<p><code>P = 19^1 * 29^4 = 13,438,339</code></p>\n<p><code>P = 19^1 * 31^4 = 17,546,899</code></p>\n<p><code>P = 29^1 * 31^4 = 26,782,109</code> ---- discarded due to limit restriction</p>\n<p><code>P = 19^1 * 11^4 = 278,179</code></p>\n<p><code>P = 29^1 * 11^4 = 424,589</code></p>\n<p><code>P = 29^1 * 19^4 = 3,779,309</code></p>\n<p><code>P = 31^1 * 11^4 = 453,871</code></p>\n<p><code>P = 31^1 * 19^4 = 4,039,951</code></p>\n<p><code>P = 31^1 * 29^4 = 21,925,711</code> ---- discarded due to limit restriction</p>\n<p>Note that every prime may have any exponent, and it is not necessary for example that the lower prime would have the lower exponent, because exchanging the exponents between the primes would result in different integers. This is not the case however if the set of exponents were <code>{1,1}</code> because then exchanging them between any 2 primes would not change the result, I.E <code>11^1 * 31^1 = 31^1 * 11^1</code>.</p>\n<p>For my purposes, the set of exponents contains very few elements, about <code>5</code>, but <code>N</code> is very large, more than <code>10^13</code>, and the set of primes contains many primes, over <code>50,000</code> say. It is therefore challenging to create all possible integers efficiently.</p>\n<p>The code I have come up with uses recursion. It generates all possible such integers, keeping track of: an arraylist which represents the set of exponents, called <code>partition</code> , <code>used</code>=number of exponents used in our current product, <code>partitionIndex</code> = the index of the exponent we're going to use in the current function call, an arraylist of the primes we have used thus far - <code>primesUsed</code> (to avoid using the same prime twice in the product) and finally, <code>prod</code> = our current product. The recursion will stop when <code>used</code> is as big as our exponents list, meaning we have used all the exponents and our product is viable. Pruning is done when our current product is too big to multiply by any other prime number. Every viable integer is added to an arraylist of <code>products</code>. Here's the code:</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Set;\n\npublic class test3 {\n\n    public static long N;\n    public static long [] primes;\n    public static ArrayList &lt;Long&gt; products;\n    \n    public static void main(String[] args) \n    {\n        N = 20000000;\n        primes = new long [] {11,19,29,31};\n        products = new ArrayList &lt;Long&gt;();\n        \n        ArrayList &lt;Long&gt; partition = new ArrayList &lt;Long&gt;();\n        partition.add(1L);\n        partition.add(4L);\n        \n        generateProducts(partition , 0 , 0 , new ArrayList &lt;Long&gt;() , 1);\n        \n        //Set &lt;Long&gt; discardDups = new HashSet&lt;&gt;(products);   --- for list {1,4}, can be skipped.\n        //products.clear();                                   --- but for {1,1} has to be used, otherwise there are duplicates\n        //products.addAll(discardDups);\n        \n        Collections.sort(products);\n        \n        System.out.println(products);\n        System.out.println(products.size());\n    }\n    \n    public static void generateProducts (List &lt;Long&gt; partition , int used , int partitionIndex , ArrayList &lt;Long&gt; primesUsed , long prod)\n    {\n        if (used == partition.size())\n        {\n            products.add(prod);\n            return;\n        }\n\n        for (int i = 0 ; i &lt; primes.length &amp;&amp; primes.length - i + 1 &gt;= partition.size() - partitionIndex &amp;&amp; prod * Math.pow(primes[i], partition.get(partitionIndex)) &lt;= N ; i++)\n        {\n            if (!primesUsed.contains(primes[i]))\n            {\n                primesUsed.add(primes[i]);\n                generateProducts(partition , used + 1 , partitionIndex + 1 , primesUsed , (long) (prod * Math.pow(primes[i], partition.get(partitionIndex))));\n                primesUsed.remove(primesUsed.size() - 1);\n            }\n        }\n    }\n\n}\n\n</code></pre>\n<p>The drawbacks of this function are:</p>\n<ol>\n<li><p>It generates many duplicates. Because the counter in the function starts from <code>0</code> everytime, and it checks we're not reusing any prime, then when the exponents are the same, it generates a duplicate, I.E it treats <code>11^1 * 31^1</code> and <code>31^1 * 11^1</code> differently.</p>\n</li>\n<li><p>The algorithm overall takes a very long time. Again, I assume, because the counter starts from 0 over and over.</p>\n</li>\n</ol>\n<p>I am well aware I can get rid of the duplicates using a <code>Set</code> but this is extremely time consuming. Also, keeping track of the highest prime index used and starting from it with every function call makes the algorithm faster, but then products with the bigger prime having the lower exponent are not generated.</p>\n<p>What I am interested in is a way to generate all such products efficiently. I am not sure if my code can be altered to it. If it can, then it should be able to generate all possible such integers, it should avoid generating duplicates in the first place, and the &quot;stopping&quot; conditions, or pruning, should be better to spare as many redundant function calls as possible.</p>\n<p>Perhaps another approach altogether is necessary, but the goal remains the same. I would appreciate any direction as to how to change my code to avoid duplicates in the first place without skipping any possible integer, and making it faster. If duplicates cannot be avoided, then atleast a direction how to reduce the amount of function calls. Any other approach to achieve the same goal is most welcome!</p>\n"
    },
    {
      "tags": [
        "java",
        "arrays",
        "sum"
      ],
      "answers": [
        {
          "comments": [
            {
              "owner": {
                "reputation": 31,
                "user_id": 15331656,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/77d52a8404af0fb73a09b3e19fe7065b?s=128&d=identicon&r=PG&f=1",
                "display_name": "jpenn2472",
                "link": "https://stackoverflow.com/users/15331656/jpenn2472"
              },
              "score": 1,
              "creation_date": 1614881968,
              "post_id": 66480725,
              "comment_id": 117528059,
              "body_markdown": "Awesome answer! Didn&#39;t think about using a set to avoid duplicates, which was the next problem I was going to run into. Thanks!",
              "body": "Awesome answer! Didn&#39;t think about using a set to avoid duplicates, which was the next problem I was going to run into. Thanks!"
            },
            {
              "owner": {
                "reputation": 19821,
                "user_id": 1552534,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1",
                "display_name": "WJS",
                "link": "https://stackoverflow.com/users/1552534/wjs"
              },
              "score": 0,
              "creation_date": 1614883212,
              "post_id": 66480725,
              "comment_id": 117528555,
              "body_markdown": "@jpenn2472 You should accept the answer if helps resolve the issue.",
              "body": "@jpenn2472 You should accept the answer if helps resolve the issue."
            }
          ],
          "owner": {
            "reputation": 12517,
            "user_id": 3461397,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/71b7ecb9151708614e90369748b1bcd0?s=128&d=identicon&r=PG",
            "display_name": "oleg.cherednik",
            "link": "https://stackoverflow.com/users/3461397/oleg-cherednik"
          },
          "comment_count": 2,
          "score": 2,
          "creation_date": 1614881515,
          "answer_id": 66480725,
          "body_markdown": "You should use `Set` to look through the given array only once.\r\n\r\n    public class App {\r\n    \r\n        public static void main(String[] args) throws Exception {\r\n            int[] numbers = { 3, 6, 2, 9 };\r\n            int targNum = 5;\r\n    \r\n            twoSum(numbers, targNum);\r\n        }\r\n    \r\n        public static void twoSum(int[] nums, int target) {\r\n            Set&lt;Integer&gt; unique = new HashSet&lt;&gt;();\r\n    \r\n            for (int a : nums) {\r\n                int b = target - a;\r\n    \r\n                if (unique.contains(b)) {\r\n                    System.out.println(a + &quot; &quot; + b);\r\n                    return;\r\n                }\r\n    \r\n                unique.add(a);\r\n            }\r\n    \r\n            System.err.println(&quot;not found&quot;);\r\n    \r\n        }\r\n    \r\n    }",
          "body": "<p>You should use <code>Set</code> to look through the given array only once.</p>\n<pre><code>public class App {\n\n    public static void main(String[] args) throws Exception {\n        int[] numbers = { 3, 6, 2, 9 };\n        int targNum = 5;\n\n        twoSum(numbers, targNum);\n    }\n\n    public static void twoSum(int[] nums, int target) {\n        Set&lt;Integer&gt; unique = new HashSet&lt;&gt;();\n\n        for (int a : nums) {\n            int b = target - a;\n\n            if (unique.contains(b)) {\n                System.out.println(a + &quot; &quot; + b);\n                return;\n            }\n\n            unique.add(a);\n        }\n\n        System.err.println(&quot;not found&quot;);\n\n    }\n\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "reputation": 134,
            "user_id": 15309136,
            "user_type": "registered",
            "profile_image": "https://www.gravatar.com/avatar/70723b17b6381b7daecad5fda5055359?s=128&d=identicon&r=PG&f=1",
            "display_name": "lazy.eager",
            "link": "https://stackoverflow.com/users/15309136/lazy-eager"
          },
          "comment_count": 0,
          "score": 0,
          "creation_date": 1615127347,
          "answer_id": 66517597,
          "body_markdown": "You can use [`IntStream`][1] instead of `for-loop`:\r\n```java\r\nint[] numbers = {3, 6, 2, 9};\r\nint targetSum = 5;\r\n```\r\n```java\r\n// Map.Entry&lt;Set&lt;Integer&gt;,Integer&gt;\r\nvar entry = IntStream\r\n        // iterating through the array indexes\r\n        .range(0, numbers.length)\r\n        // map each index as a pair of index and value,\r\n        // i.e. set of indexes and sum of values\r\n        // Stream&lt;Map.Entry&lt;Set&lt;Integer&gt;,Integer&gt;&gt;\r\n        .mapToObj(i -&gt; Map.entry(Set.of(i), numbers[i]))\r\n        // reduce stream of map entries to a single entry\r\n        .reduce((e1, e2) -&gt; {\r\n            int sum = e1.getValue() + e2.getValue();\r\n            // if sum of the values of the two entries\r\n            // is less than or equal to the target sum\r\n            if (sum &lt;= targetSum) {\r\n                // summarize two entries\r\n                Set&lt;Integer&gt; key = new HashSet&lt;&gt;();\r\n                key.addAll(e1.getKey());\r\n                key.addAll(e2.getKey());\r\n                return Map.entry(key, sum);\r\n            } else {\r\n                // otherwise, take an entry with a smaller sum\r\n                return e1.getValue() &lt; e2.getValue() ? e1 : e2;\r\n            }\r\n        }).orElse(null);\r\n```\r\n```java\r\n// output\r\nif (entry == null)\r\n    System.out.println(&quot;Not found&quot;);\r\nelse\r\n    entry.getKey().forEach(i -&gt; System.out.println(numbers[i]));\r\n```\r\nOutput:\r\n```\r\n3\r\n2\r\n```\r\n\r\n---\r\n\r\n&lt;sup&gt;See also: [How to sort a character by number of occurrences in a String using a Map?][2]&lt;/sup&gt;\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/IntStream.html\r\n  [2]: https://stackoverflow.com/a/66535925/15309136",
          "body": "<p>You can use <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/IntStream.html\" rel=\"nofollow noreferrer\"><code>IntStream</code></a> instead of <code>for-loop</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>int[] numbers = {3, 6, 2, 9};\nint targetSum = 5;\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>// Map.Entry&lt;Set&lt;Integer&gt;,Integer&gt;\nvar entry = IntStream\n        // iterating through the array indexes\n        .range(0, numbers.length)\n        // map each index as a pair of index and value,\n        // i.e. set of indexes and sum of values\n        // Stream&lt;Map.Entry&lt;Set&lt;Integer&gt;,Integer&gt;&gt;\n        .mapToObj(i -&gt; Map.entry(Set.of(i), numbers[i]))\n        // reduce stream of map entries to a single entry\n        .reduce((e1, e2) -&gt; {\n            int sum = e1.getValue() + e2.getValue();\n            // if sum of the values of the two entries\n            // is less than or equal to the target sum\n            if (sum &lt;= targetSum) {\n                // summarize two entries\n                Set&lt;Integer&gt; key = new HashSet&lt;&gt;();\n                key.addAll(e1.getKey());\n                key.addAll(e2.getKey());\n                return Map.entry(key, sum);\n            } else {\n                // otherwise, take an entry with a smaller sum\n                return e1.getValue() &lt; e2.getValue() ? e1 : e2;\n            }\n        }).orElse(null);\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>// output\nif (entry == null)\n    System.out.println(&quot;Not found&quot;);\nelse\n    entry.getKey().forEach(i -&gt; System.out.println(numbers[i]));\n</code></pre>\n<p>Output:</p>\n<pre><code>3\n2\n</code></pre>\n<hr />\n<p><sup>See also: <a href=\"https://stackoverflow.com/a/66535925/15309136\">How to sort a character by number of occurrences in a String using a Map?</a></sup></p>\n"
        }
      ],
      "owner": {
        "reputation": 31,
        "user_id": 15331656,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/77d52a8404af0fb73a09b3e19fe7065b?s=128&d=identicon&r=PG&f=1",
        "display_name": "jpenn2472",
        "link": "https://stackoverflow.com/users/15331656/jpenn2472"
      },
      "comment_count": 0,
      "view_count": 61,
      "answer_count": 2,
      "score": 3,
      "creation_date": 1614881088,
      "question_id": 66480625,
      "body_markdown": "I am just trying to look through an array and find the elements that sum up to the target number. I&#39;ve gotten this far into the program: \r\n\r\n```java\r\npublic class App {\r\n    public static void main(String[] args) throws Exception {\r\n        int[] numbers = {3, 6, 2, 9};\r\n        int targNum = 5;\r\n\r\n        twoSum(numbers, targNum);\r\n    }\r\n\r\n    public static void twoSum(int[] nums, int target) {\r\n        for (int i = 0; i &lt; nums.length; i++) {\r\n            int sum = 0;\r\n\r\n            if (nums[i] &lt;= target) {\r\n                int[] sumNums = {target - nums[i]};\r\n\r\n                for (int j = 0; j &lt; sumNums.length; j++) {\r\n                    sum += sumNums[j];\r\n                    System.out.println(sum);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nI keep getting console output of:\r\n \r\n```\r\n2\r\n3\r\n```\r\nI ran a simple array sum in another file and it seemed to work perfectly.\r\n",
      "title": "How to sum the elements of the array up to the target number?",
      "body": "<p>I am just trying to look through an array and find the elements that sum up to the target number. I've gotten this far into the program:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class App {\n    public static void main(String[] args) throws Exception {\n        int[] numbers = {3, 6, 2, 9};\n        int targNum = 5;\n\n        twoSum(numbers, targNum);\n    }\n\n    public static void twoSum(int[] nums, int target) {\n        for (int i = 0; i &lt; nums.length; i++) {\n            int sum = 0;\n\n            if (nums[i] &lt;= target) {\n                int[] sumNums = {target - nums[i]};\n\n                for (int j = 0; j &lt; sumNums.length; j++) {\n                    sum += sumNums[j];\n                    System.out.println(sum);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n<p>I keep getting console output of:</p>\n<pre><code>2\n3\n</code></pre>\n<p>I ran a simple array sum in another file and it seemed to work perfectly.</p>\n"
    }
  ],
  "has_more": true,
  "quota_max": 10000,
  "quota_remaining": 9674
}